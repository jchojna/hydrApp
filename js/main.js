!function(n){var e={};function t(c){if(e[c])return e[c].exports;var l=e[c]={i:c,l:!1,exports:{}};return n[c].call(l.exports,l,l.exports,t),l.l=!0,l.exports}t.m=n,t.c=e,t.d=function(n,e,c){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:c})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var c=Object.create(null);if(t.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var l in n)t.d(c,l,function(e){return n[e]}.bind(null,l));return c},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=0)}([function(module,exports,__webpack_require__){"use strict";eval("\r\n\r\n/////////////////////////////////////////////////////////////// SERVICE WORKER \r\n\r\nif ('serviceWorker' in navigator) {\r\n  window.addEventListener('load', function() {\r\n    navigator.serviceWorker.register('serviceworker.js').then(function(registration) {\r\n      // Registration was successful\r\n      //console.log('ServiceWorker registration successful with scope: ', registration.scope);\r\n    }, function(err) {\r\n      // registration failed :(\r\n      console.log('ServiceWorker registration failed: ', err);\r\n    });\r\n  });\r\n}\r\n\r\n///////////////////////////////////////////////////////////// GLOBAL VARIABLES \r\n\r\nconst hydrappArray = [];\r\nconst lastEntryDate = new Date();\r\nconst weekDay = ['sunday','monday','tuesday','wednesday','thursday','friday','saturday'];\r\n\r\nlet indicators = '';\r\nfor (let i = 0; i < 8; i++) {\r\n  indicators += `\r\n  <svg class=\"indicator__svg indicator__svg--emo-${i+1} indicator__svg--js-${i}\">\r\n    <use href=\"assets/svg/icons.svg#emoticon-${i}\"></use>\r\n  </svg>`\r\n}\r\n\r\nconst archiveEmpty = `\r\n<p class=\"week__empty\">No history yet...</p>\r\n`;\r\n\r\nconst addButtonHtml = `\r\n<li class=\"entry entry--add entry--js-add\">\r\n  <button class=\"button entry__button entry__button--add entry__button--js-add\">\r\n    Add new day..\r\n  </button>\r\n</li>\r\n`;\r\n\r\nclass Entry {\r\n  constructor(date) {\r\n    this.key = setDateKey(date);\r\n    this.value = this.key;\r\n    this.date = date;\r\n    this.id = this.date;\r\n    this.day = date;\r\n\r\n    this.weekHtml = `\r\n      <section class=\"week week--js\">\r\n        <header class=\"week__header week__header--js\">\r\n          <button class=\"button week__button week__button--prev week__button--js-prev\">\r\n            <svg class=\"week__svg\" viewBox=\"0 0 512 512\">\r\n              <use href=\"assets/svg/icons.svg#left-arrow\"></use>\r\n            </svg>\r\n          </button>\r\n          <h3 class=\"week__heading week__heading--js\">New week</h3>\r\n          <button class=\"button week__button week__button--next week__button--js-next\">\r\n            <svg class=\"week__svg\" viewBox=\"0 0 512 512\">\r\n              <use href=\"assets/svg/icons.svg#right-arrow\"></use>\r\n            </svg>\r\n          </button>\r\n        </header>\r\n        <ul class=\"week__list week__list--js\"></ul>\r\n      </section>\r\n    `;\r\n\r\n    this.dayHtml = `\r\n      <li class=\"entry entry--js ${this.key}\">\r\n        <header class=\"entry__header entry__header--js\">\r\n          <p class=\"entry__heading entry__heading--day\">${this.day}</p>\r\n          <p class=\"entry__heading entry__heading--date entry__heading--js-date\">${this.date}</p>\r\n        </header>\r\n        <span class=\"entry__value entry__value--js\">${this.value}</span>\r\n        <div class=\"edition edition--js\">\r\n          <button class=\"button edition__button edition__button--visible edition__button--edit edition__button--js-edit\">\r\n            <svg class=\"edition__svg edition__svg--edit\">\r\n              <use href=\"assets/svg/icons.svg#edit-mode\"></use>\r\n            </svg>\r\n          </button>\r\n          <button class=\"button edition__button edition__button--decrease edition__button--js-decrease\">\r\n            <svg class=\"edition__svg edition__svg--decrease\">\r\n              <use href=\"assets/svg/icons.svg#down-arrow\"></use>\r\n            </svg>\r\n          </button>\r\n          <button class=\"button edition__button edition__button--increase edition__button--js-increase\">\r\n            <svg class=\"edition__svg edition__svg--increase\">\r\n              <use href=\"assets/svg/icons.svg#up-arrow\"></use>\r\n            </svg>\r\n          </button>\r\n          <button class=\"button edition__button edition__button--cancel edition__button--js-cancel\">\r\n            <svg class=\"edition__svg edition__svg--cancel\">\r\n              <use href=\"assets/svg/icons.svg#back-arrow\"></use>\r\n            </svg>\r\n          </button>\r\n          <button class=\"button edition__button edition__button--save edition__button--js-save\">\r\n            <svg class=\"edition__svg edition__svg--save\">\r\n              <use href=\"assets/svg/icons.svg#save-icon\"></use>\r\n            </svg>\r\n          </button>\r\n        </div>\r\n        <div class=\"indicator indicator--js-${this.id}\">\r\n          ${indicators}\r\n        </div>\r\n      </li>\r\n    `;\r\n  }\r\n\r\n  get value() {\r\n    return this._value;\r\n  }\r\n  set value(key) {\r\n    this._value = localStorage.getItem(key);\r\n  }\r\n  get date() {\r\n    return this._date;\r\n  }\r\n  set date(date) {\r\n    this._date = getOffsetedDate(date).toISOString().slice(0,10).split('-').reverse().join(' ');\r\n  }\r\n  get id() {\r\n    return this._id;\r\n  }\r\n  set id(date) {\r\n    this._id = date.replace(/\\s/g,'');\r\n  }\r\n  get day() {\r\n    return this._day;\r\n  }\r\n  set day(date) {\r\n    const dayIndex = date.getDay();\r\n    this._day = weekDay[dayIndex];\r\n  }\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////// FUNCTIONS \r\n\r\n// F0 ////////////////////////////////////////////////////// GET OFFSETED DATE \r\n\r\nconst getOffsetedDate = (obj) => {\r\n  const timeZoneOffset = (new Date()).getTimezoneOffset() * 60000;\r\n  return (new Date(obj - timeZoneOffset));\r\n}\r\n// F0 //////////////////////////////////////////////// CREATE HYDRAPP DATE KEY \r\n\r\nconst setDateKey = (obj) => {\r\n\r\n  const timeZoneOffset = (new Date()).getTimezoneOffset() * 60000;\r\n  let dateObj = obj || new Date();\r\n  dateObj = (new Date(dateObj - timeZoneOffset));\r\n\r\n  const prefix = 'hydrApp-';\r\n  const dateStr = dateObj.toISOString().slice(0,10);\r\n  return prefix.concat(dateStr);\r\n}\r\n// F0 ///////////////////////////// CREATE ARRAY OF HYDRAPP LOCAL STORAGE KEYS \r\n\r\nconst getHydrappKeys = () => {\r\n  const regex = /hydrApp-/;\r\n  return Object\r\n  .keys(localStorage)\r\n  .filter(key => regex.test(key))\r\n  .sort()\r\n  .reverse();\r\n}\r\n// F0 ///////////////////////////////// CREATE KEY VALUE PAIR IN LOCAL STORAGE \r\n\r\nconst setNewKeyValue = (key, value) => {\r\n  if ( !localStorage.getItem(key) ) {\r\n    localStorage.setItem(key, value);\r\n  };\r\n}\r\n// F0 ///////////////////////////////////////////////// LOOPED RANGE OF VALUES \r\n\r\nconst range = (max, num, action) => {\r\n  action === 'increase' ? num >= max ? num = 0 : num++ : false;\r\n  action === 'decrease' ? num <= 0 ? num = max : num-- : false;\r\n  return num;\r\n}\r\n// F0 //////////////////////////////////////////////// LIMITED RANGE OF VALUES \r\n\r\nconst limit = (max, num, action) => {\r\n  action === 'increase' ? num >= max ? false : num++ : false;\r\n  action === 'decrease' ? num <= 0 ? false : num-- : false;\r\n  return num;\r\n}\r\n// F0 ////////////////////////// SET CURRENTLY DISPLAYED ARCHIVE WEEK'S HEIGHT \r\n\r\nconst setCurrentWeekHeight = () => {\r\n  \r\n  const currentWeek = document.querySelectorAll('.week--js')[currentWeekIndex];\r\n  const childrenArray = [...currentWeek.children];\r\n  const childrenHeight = childrenArray.reduce((a,b) => a + b.clientHeight, 0);\r\n  const offsetHeight = 40;\r\n  const finalHeight = childrenHeight + offsetHeight;\r\n\r\n  archiveWeeks.style.height = `${finalHeight}px`;\r\n}\r\n// F0 ///////////////////////////////////////////////////////// SET INDICATORS \r\n\r\nconst setIndicators = (id, value) => {\r\n\r\n  value > 7 ? value = 7 : false;\r\n\r\n  const indicators = document.querySelector(`.indicator--js-${id}`).children;\r\n  const indicator = document.querySelector(`.indicator--js-${id} .indicator__svg--js-${value}`);\r\n  \r\n  for (const indicator of indicators) {\r\n    indicator.classList.contains('indicator__svg--visible')\r\n    ? indicator.classList.remove('indicator__svg--visible')\r\n    : false;\r\n  }\r\n  indicator.classList.add('indicator__svg--visible');\r\n}\r\n// F0 //////////////////////////////////////////////// CREATE ADD ENTRY BUTTON \r\n\r\nconst createAddEntryButton = () => {\r\n  const addEntryButton = document.createElement('li');\r\n  addEntryButton.className = 'entry entry__add';\r\n  addEntryButton.innerHTML = `\r\n    <button class=\"button entry__button entry__button--add entry__button--js-add\">\r\n      Add new day..\r\n    </button>\r\n  `;\r\n  addEntryButton.addEventListener('click', enterNewEntryValue);\r\n\r\n  return addEntryButton;\r\n}\r\n// F0 //////////////////////////////////////////// CREATE 'REMOVE ITEM' BUTTON \r\n\r\nconst createRemoveEntryButton = () => {\r\n\r\n  const removeEntryButton = document.createElement('button');\r\n  removeEntryButton.className = 'button entry__remove';\r\n  removeEntryButton.innerHTML = `\r\n    <svg class=\"entry__svg\" viewBox=\"0 0 512 512\">\r\n      <use href=\"assets/svg/icons.svg#remove-icon\"></use>\r\n    </svg>\r\n  `\r\n  removeEntryButton.addEventListener('click', removeLastEntry);\r\n\r\n  return removeEntryButton;\r\n}\r\n// F2 ////////////////////////////////////////////////////// SET LOCAL STORAGE \r\n\r\nconst handleData = () => {\r\n\r\n  const date = new Date();\r\n  let dateKey = setDateKey(date);\r\n  setNewKeyValue(dateKey, 0);\r\n  let hydrappKeys = getHydrappKeys();\r\n  const oldestKey = hydrappKeys[hydrappKeys.length - 1];\r\n  \r\n  // create object for each key\r\n  const createEntryObject = (date) => {\r\n    const newEntry = new Entry(date);\r\n    hydrappArray.push(newEntry);\r\n  }\r\n  // first object of array\r\n  createEntryObject(date);\r\n\r\n  // autocomplete the rest of keys if needed\r\n  while (dateKey !== oldestKey) {\r\n    dateKey = setDateKey(date.setDate(date.getDate() - 1));\r\n    lastEntryDate.setDate(lastEntryDate.getDate() - 1);\r\n    setNewKeyValue(dateKey, 0);\r\n    createEntryObject(date);\r\n  }\r\n  //counter.innerHTML = localStorage.getItem(dateKey);\r\n  updateCounter('displayValue');\r\n}\r\n// F1 ///////////////////////////////////////////////////////// UPDATE COUNTER \r\n\r\nconst updateCounter = (e) => {\r\n  const self = e.target || e;\r\n  const key = setDateKey();\r\n  let value = parseInt(localStorage.getItem(key));\r\n  const firstArchiveEntry = document.querySelector('.entry__value--js');\r\n\r\n  switch (self) {                                                     // ! REFACTOR\r\n    case 'displayValue':\r\n      counter.innerHTML = value;\r\n      break;\r\n    \r\n    case addGlass:                                                    // ! REFACTOR\r\n      value < counterMaxValue ? value++ : value = counterMaxValue;\r\n      localStorage.setItem(key, value);\r\n      hydrappArray[0].value = key;\r\n      counter.innerHTML = value;\r\n      firstArchiveEntry.textContent = hydrappArray[0].value;\r\n      break;\r\n\r\n    case removeGlass:                                                 // ! REFACTOR\r\n      value > 0 ? value-- : value = 0;\r\n      localStorage.setItem(key, value);\r\n      hydrappArray[0].value = key;\r\n      counter.innerHTML = value;\r\n      firstArchiveEntry.textContent = hydrappArray[0].value;\r\n      break;\r\n  }\r\n}\r\n// F2 /////////////////////////////////////////////////////// ADD ARCHIVE NODE \r\n\r\nconst addArchiveNode = (index, option) => {\r\n\r\n  const {value, id, day, dayHtml, weekHtml} = hydrappArray[index];\r\n  \r\n  // add new week\r\n  if (((day === 'sunday' || index === 0)) && option !== 'add') {\r\n\r\n    archiveWeeks.insertAdjacentHTML('beforeend', weekHtml);                // ! TO REFACTOR\r\n    const weekHeader = archiveWeeks.lastElementChild.firstElementChild;\r\n    weekHeader.addEventListener('click', slideWeek);\r\n  }\r\n  // add next day entry\r\n  let lastWeekList = archiveWeeks.lastElementChild.lastElementChild;\r\n  lastWeekList.insertAdjacentHTML('beforeend', dayHtml);\r\n  setIndicators(id, value);\r\n\r\n  // add 'add entry button at the end\r\n  if (index === hydrappArray.length - 1) {\r\n    if (day === 'monday') {\r\n      archiveWeeks.insertAdjacentHTML(\"beforeend\", weekHtml);              // ! TO REFACTOR\r\n      const weekHeader = archiveWeeks.lastElementChild.firstElementChild;\r\n      weekHeader.addEventListener('click', slideWeek);\r\n    };\r\n\r\n    lastWeekList = archiveWeeks.lastElementChild.lastElementChild;\r\n    lastWeekList.appendChild(addEntryButton);\r\n  }\r\n  updateWeekHeading();\r\n\r\n  // add event listeners to all edit buttons\r\n  const editButton = document.querySelectorAll('.edition__button--js-edit')[index];\r\n  editButton.index = index;\r\n  editButton.addEventListener('click', handleItemEdit);\r\n}\r\n// F2 //////////////////////////////////////////////////////////// SET ARCHIVE \r\n\r\nconst setArchiveDOM = () => {\r\n  \r\n  for (let i = 0; i < hydrappArray.length; i++) {\r\n    addArchiveNode(i);\r\n  }\r\n  // set the newest week as visible\r\n  const weeks = document.querySelectorAll('.week--js');\r\n  weeks[currentWeekIndex].classList.add('week--visible');\r\n  // set 'remove entry' button on the last entry\r\n  handleArchiveLastEntry();\r\n\r\n  // generate indicators for new entry mode\r\n  const indicatorsContainer = document.querySelector('.indicator--js-new');\r\n  indicatorsContainer.innerHTML = indicators;\r\n  setIndicators('new', 0);\r\n}\r\n// F2 /////////////////////////////////////////////////////// SET WEEK HEADING \r\n\r\nconst updateWeekHeading = () => {\r\n\r\n  const weekLists = document.querySelectorAll('.week__list--js');\r\n  const weekHeadings = document.querySelectorAll('.week__heading--js');\r\n\r\n  // F0 ///////////////////////////////////////////////////////////// GET DATE \r\n  const getDate = (element) => {\r\n\r\n    if (element) {\r\n      const filtered = element.className.split(' ').filter(a => /hydrApp/.test(a));\r\n      return filtered.toString().slice(10).split('-').reverse().join('.');\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n  // F0 /////////////////////////////////////////////// SET BUTTONS VISIBILITY \r\n  const setButtonsVisiblity = (index, option) => {\r\n    const prevWeekButton = document.querySelectorAll('.week__button--js-prev')[index];\r\n    const nextWeekButton = document.querySelectorAll('.week__button--js-next')[index];\r\n\r\n    switch (index) {\r\n\r\n      case 0:\r\n        prevWeekButton.classList.remove('week__button--visible');\r\n        option === 'oneWeek'\r\n        ? nextWeekButton.classList.remove('week__button--visible')\r\n        : nextWeekButton.classList.add('week__button--visible');\r\n        break;\r\n      \r\n      case weekHeadings.length - 1:\r\n        prevWeekButton.classList.add('week__button--visible');\r\n        nextWeekButton.classList.remove('week__button--visible');\r\n        break;\r\n\r\n      default:\r\n        prevWeekButton.classList.add('week__button--visible');\r\n        nextWeekButton.classList.add('week__button--visible');\r\n        break;\r\n    }\r\n  }\r\n  \r\n  for (let i = 0; i < weekLists.length; i++) {\r\n\r\n    const entries = weekLists[i].querySelectorAll('.entry--js');\r\n    const startDate = getDate(entries[entries.length - 1]);\r\n    const endDate = getDate(entries[0]);\r\n    const heading = weekHeadings[i];\r\n\r\n    heading.textContent = `${startDate\r\n    ? (startDate === endDate ? startDate : `${startDate.slice(0,5)} - ${endDate}`)\r\n    : `New Week`}`;\r\n\r\n    weekLists.length > 1 ? setButtonsVisiblity(i) : setButtonsVisiblity(i, 'oneWeek');\r\n  }\r\n}\r\n// F1 ///////////////////////////////////////////////////// TOGGLE MOBILE MENU \r\n\r\nconst toggleMobileMenu = (e) => {\r\n  const self = e.target || e;\r\n\r\n  if (self === burgerButton) {\r\n\r\n    self.classList.toggle('burger-button--active');\r\n    mobileMenu.classList.toggle('mobile-menu--visible');\r\n  }\r\n}\r\n// F1 /////////////////////////////////////////////////////////// SHOW ARCHIVE \r\n\r\nconst showArchive = () => {\r\n\r\n  entries = document.querySelectorAll('.entry--js');\r\n\r\n  if (archive.classList.contains('archive--visible')) {\r\n    archive.classList.remove('archive--visible')\r\n\r\n  } else {\r\n\r\n    archive.classList.add('archive--visible');\r\n  }\r\n}\r\n// F1 ///////////////////////////////////////////////////////// EXPAND ARCHIVE \r\n\r\nconst toggleArchive = (e) => {                      // ! to DRY !\r\n  const self = e.target;\r\n  const svgIcons = self.lastElementChild;\r\n  const section = self.nextElementSibling;\r\n\r\n  switch (self) {\r\n    case mobileMenuArchiveSection:\r\n      \r\n      svgIcons.classList.toggle('mobile-menu__svg--active');\r\n      if (svgIcons.classList.contains('mobile-menu__svg--active')) {\r\n\r\n        setCurrentWeekHeight();\r\n        window.addEventListener('keydown', enterNewEntryValue);\r\n        window.addEventListener('keydown', removeLastEntry);\r\n        window.addEventListener('keydown', slideWeek);\r\n\r\n      } else {\r\n\r\n        section.style.height = 0;\r\n        window.removeEventListener('keydown', enterNewEntryValue);\r\n        window.removeEventListener('keydown', removeLastEntry);\r\n        window.removeEventListener('keydown', slideWeek);\r\n\r\n      }\r\n      break;\r\n    \r\n    case mobileMenuStatsSection:\r\n      svgIcons.classList.toggle('mobile-menu__svg--active');\r\n      section.classList.toggle('stats__container--active');\r\n      break;\r\n\r\n    case mobileMenuSettingsSection:\r\n      svgIcons.classList.toggle('mobile-menu__svg--active');\r\n      section.classList.toggle('settings__container--active');\r\n      break;\r\n  }\r\n}\r\n// F2 ///////////////////////////////////////////////////////////// SLIDE WEEK \r\n\r\nconst slideWeek = (e) => {\r\n\r\n  const self = e.keyCode || e.target;\r\n  const prevWeekButton = document.querySelectorAll('.week__button--js-prev')[currentWeekIndex];\r\n  const nextWeekButton = document.querySelectorAll('.week__button--js-next')[currentWeekIndex];\r\n  const weeksAmount = archiveWeeks.children.length;\r\n\r\n  const handleSlide = (direction) => {\r\n    // handle previous section\r\n    archiveWeeks.children[currentWeekIndex].className = `week week--js week--slide-out-to-${direction === 'toLeft' ? `right` : `left`}`;\r\n    const previousWeekIndex = currentWeekIndex;\r\n    // change index\r\n    currentWeekIndex = limit(archiveWeeks.children.length - 1, currentWeekIndex, direction === 'toLeft' ? `decrease` : `increase`);\r\n    // handle next section\r\n    if (currentWeekIndex !== previousWeekIndex) {\r\n      archiveWeeks.children[currentWeekIndex].classList = `week week--js week--visible week--slide-in-from-${direction === 'toLeft' ? `left` : `right`}`;\r\n    } else {\r\n      archiveWeeks.children[currentWeekIndex].classList = 'week week--js week--visible';\r\n    }\r\n  }\r\n\r\n  if (weeksAmount > 1) {\r\n    switch (self) {\r\n      case 37:\r\n      case prevWeekButton:\r\n        handleSlide('toLeft');\r\n        break;\r\n      case 39:\r\n      case nextWeekButton:\r\n        handleSlide('toRight');\r\n        break;\r\n    }\r\n    setCurrentWeekHeight();\r\n  }\r\n}\r\n// F1 ////////////////////////////////////////// ARCHIVE MODAL << SHOW ARCHIVE \r\n\r\nconst enterNewEntryValue = (e) => {\r\n\r\n  const self = e.keyCode || e.target || e;                // ! e only for tests\r\n  const addEntryButton = document.querySelector('.entry__button--js-add');\r\n\r\n  if (self === 107 || self === addEntryButton) {\r\n\r\n    let value = 0;\r\n    newEntryMode.classList.add('new-entry--visible');\r\n    newEntryValue.textContent = value;\r\n  \r\n    const modeOff = () => {\r\n      newEntryMode.classList.remove('new-entry--visible');\r\n      newEntryMode.removeEventListener('click', handleValue);\r\n      window.removeEventListener('keydown', handleValue);\r\n      window.addEventListener('keydown', enterNewEntryValue);\r\n      window.addEventListener('keydown', slideWeek);\r\n    }\r\n  \r\n    const handleValue = (e) => {\r\n  \r\n      const self = e.keyCode || e.target;\r\n  \r\n      switch (self) {\r\n  \r\n        case 37:\r\n        case newEntryDecrease:\r\n          value !== 0 ? value-- : false;\r\n          newEntryValue.textContent = value;\r\n          setIndicators('new', value);\r\n          break;\r\n\r\n        case 39:\r\n        case newEntryIncrease:\r\n          value !== counterMaxValue ? value++ : false;\r\n          newEntryValue.textContent = value;\r\n          setIndicators('new', value);\r\n          break;\r\n  \r\n        case 27:\r\n        case newEntryCancel:\r\n          modeOff();\r\n          break;\r\n  \r\n        case 13:\r\n        case newEntrySave:\r\n          e.preventDefault();\r\n          addNewEntry(e, value);\r\n          modeOff();\r\n          break;\r\n      }\r\n    }\r\n    newEntryMode.addEventListener('click', handleValue);\r\n    window.addEventListener('keydown', handleValue);\r\n    window.removeEventListener('keydown', enterNewEntryValue);\r\n    window.removeEventListener('keydown', slideWeek);\r\n  }\r\n}\r\n// F1 /////////////////////////////////////////// ADD NEW ITEM << SHOW ARCHIVE \r\n\r\nconst addNewEntry = (e, value) => {\r\n  \r\n  const self = e.keyCode || e.target;\r\n\r\n  if (self === 13 || self === newEntrySave) {\r\n\r\n    e.preventDefault();\r\n\r\n    let lastEntryIndex = hydrappArray.length - 1;\r\n    const lastEntry = document.querySelectorAll('.entry--js')[lastEntryIndex];\r\n    lastEntry.classList.remove('entry--last');\r\n\r\n    lastEntryDate.setDate(lastEntryDate.getDate() - 1);\r\n    const newEntryKey = setDateKey(lastEntryDate);\r\n    \r\n    // handle local storage and array of objects\r\n    setNewKeyValue(newEntryKey, value);\r\n    const newEntry = new Entry(lastEntryDate);\r\n    newEntry.value = newEntryKey;\r\n    hydrappArray.push(newEntry);\r\n\r\n    // create new entry node\r\n    lastEntryIndex = hydrappArray.length - 1;\r\n    addArchiveNode(lastEntryIndex, 'add');\r\n\r\n    // jump to the last week\r\n    const weeks = archiveWeeks.children;\r\n    const currentWeek = weeks[currentWeekIndex];\r\n    const lastWeekIndex = weeks.length - 1;\r\n    const lastWeek = weeks[lastWeekIndex];\r\n    if (currentWeekIndex !== lastWeekIndex) {\r\n      currentWeekIndex = archiveWeeks.children.length - 1;\r\n      currentWeek.className = 'week week--js week--slide-out-to-left';\r\n      lastWeek.className = 'week week--js week--visible week--slide-in-from-right';\r\n    }\r\n    handleArchiveLastEntry();\r\n    setCurrentWeekHeight();\r\n  }\r\n}\r\n// F1 /////////////////////////////////////////////// ADJUST LAST ITEM OF LIST \r\n\r\nconst handleArchiveLastEntry = () => {\r\n\r\n  const entries = document.querySelectorAll('.entry--js');\r\n  const lastEntry = entries[entries.length - 1];\r\n  const lastEntryValueNode = lastEntry.querySelector('.entry__value--js');\r\n\r\n  if (entries.length > 1) {\r\n    lastEntry.insertBefore(removeEntryButton, lastEntryValueNode);\r\n    lastEntry.classList.add('entry--last');\r\n  }\r\n}\r\n// F1 /////////////////////////////////////// REMOVE LAST ITEM << SHOW ARCHIVE \r\n\r\nconst removeLastEntry = (e) => {\r\n\r\n  const self = e.keyCode || e. target;\r\n  const lastEntryIndex = hydrappArray.length - 1;\r\n  const {day, key} = hydrappArray[lastEntryIndex];\r\n  const lastEntryNode = document.querySelectorAll('.entry--js')[lastEntryIndex];\r\n\r\n  if (self === 109 || self === removeEntryButton) {\r\n\r\n    if (hydrappArray.length > 1) {\r\n\r\n      hydrappArray.pop();\r\n      localStorage.removeItem(key);\r\n      lastEntryDate.setDate(lastEntryDate.getDate() + 1);\r\n      lastEntryNode.parentNode.removeChild(lastEntryNode);\r\n\r\n      // removing last week section after deleting last day of that week\r\n      if (day === 'monday') {\r\n        const weekToRemove = archiveWeeks.lastElementChild;\r\n        const ifVisible = weekToRemove.classList.contains('week--visible');\r\n        archiveWeeks.removeChild(archiveWeeks.lastElementChild);\r\n        const lastWeek = archiveWeeks.lastElementChild;\r\n        const lastWeekList = lastWeek.lastElementChild;\r\n        if (ifVisible) {\r\n          lastWeek.className = 'week week--js week--visible week--slide-in-from-left';currentWeekIndex--;\r\n        }\r\n        lastWeekList.appendChild(addEntryButton);\r\n      }\r\n\r\n      // add remove button on current last item\r\n      handleArchiveLastEntry();\r\n      updateWeekHeading();\r\n      setCurrentWeekHeight();\r\n    }\r\n  }\r\n}\r\n// F2 /////////////////////////////////////////////////////// HANDLE ITEM EDIT \r\n\r\nconst handleItemEdit = (e) => {\r\n  const itemIndex = e.target.index;\r\n\r\n  const entry = document.querySelectorAll('.entry--js')[itemIndex];\r\n  const entryHeader = document.querySelectorAll('.entry__header--js')[itemIndex];\r\n  const entryValue = document.querySelectorAll('.entry__value--js')[itemIndex];\r\n  const editSection = document.querySelectorAll('.edition--js')[itemIndex];\r\n  const decreaseButton = document.querySelectorAll('.edition__button--js-decrease')[itemIndex];\r\n  const increaseButton = document.querySelectorAll('.edition__button--js-increase')[itemIndex];\r\n  const cancelButton = document.querySelectorAll('.edition__button--js-cancel')[itemIndex];\r\n  const saveButton = document.querySelectorAll('.edition__button--js-save')[itemIndex];\r\n\r\n  // F0 ////////////////////////////// TOGGLE ITEM DISPLAY << HANDLE ITEM EDIT \r\n\r\n  const toggleItemDisplay = () => {\r\n\r\n    for (const editButton of editSection.children) {\r\n      editButton.classList.toggle('edition__button--visible');\r\n    }\r\n    editSection.classList.toggle('edition--visible');\r\n    entry.classList.toggle('entry--edit-mode');\r\n    entryHeader.classList.toggle('entry__header--edit-mode');\r\n\r\n    itemIndex === hydrappArray.length - 1\r\n    ? removeEntryButton.classList.toggle('entry__remove--hidden')\r\n    : false;\r\n  }\r\n  // F1 /////////////////////////////////// EXIT EDIT MODE << HANDLE ITEM EDIT \r\n\r\n  const exitEditMode = () => {\r\n    const {value, id} = hydrappArray[itemIndex];\r\n    \r\n    toggleItemDisplay();\r\n    entryValue.textContent = value;\r\n    setIndicators(id, value);\r\n\r\n    archive.removeEventListener('click', handleEdition);\r\n    archive.removeEventListener('keydown', handleEdition);\r\n    window.addEventListener('keydown', slideWeek);\r\n  }\r\n  // F1 /////////////////////////////////// HANDLE EDITION << HANDLE ITEM EDIT \r\n\r\n  const handleEdition = (e) => {\r\n    const self = e.keyCode || e.target;\r\n    let dayValue = parseInt(entryValue.textContent);\r\n    const glassCounter = document.querySelector('.glass__counter--js');\r\n\r\n    const {key, id} = hydrappArray[itemIndex];\r\n\r\n    switch (self) {\r\n\r\n      case 40:\r\n      case decreaseButton:\r\n        e.preventDefault();\r\n        dayValue > 0 ? dayValue-- : false;\r\n        entryValue.textContent = dayValue;\r\n        setIndicators(id, dayValue);\r\n      break;\r\n      \r\n      case 38:\r\n      case increaseButton:\r\n        e.preventDefault();\r\n        dayValue < counterMaxValue ? dayValue++ : false;\r\n        entryValue.textContent = dayValue;\r\n        setIndicators(id, dayValue);\r\n      break;\r\n\r\n      case 27:\r\n      case cancelButton:\r\n        e.preventDefault();\r\n        exitEditMode();\r\n      break;\r\n\r\n      case 13:\r\n      case saveButton:\r\n        e.preventDefault();\r\n        localStorage.setItem(key, dayValue);\r\n        // setter function\r\n        hydrappArray[itemIndex].value = key;\r\n        glassCounter.textContent = hydrappArray[0].value;\r\n        exitEditMode();\r\n      break;\r\n    }\r\n  }\r\n  ///////////////////////////////////////// FUNCTION CALLS << HANDLE ITEM EDIT \r\n\r\n  toggleItemDisplay();\r\n  archive.addEventListener('click', handleEdition);\r\n  archive.addEventListener('keydown', handleEdition);\r\n  window.removeEventListener('keydown', slideWeek);\r\n}\r\n// F2 //////////////////////////////////////////////// END OF HANDLE ITEM EDIT \r\n\r\n/*\r\n##     ##    ###    ########  ####    ###    ########  ##       ########  ######\r\n##     ##   ## ##   ##     ##  ##    ## ##   ##     ## ##       ##       ##    ##\r\n##     ##  ##   ##  ##     ##  ##   ##   ##  ##     ## ##       ##       ##\r\n##     ## ##     ## ########   ##  ##     ## ########  ##       ######    ######\r\n ##   ##  ######### ##   ##    ##  ######### ##     ## ##       ##             ##\r\n  ## ##   ##     ## ##    ##   ##  ##     ## ##     ## ##       ##       ##    ##\r\n   ###    ##     ## ##     ## #### ##     ## ########  ######## ########  ######\r\n*/\r\n\r\n//////////////////////////////////////////////////////////////////// VARIABLES \r\n// APP\r\nconst appContainer = document.querySelector('.app__container--js');\r\nconst addGlass = document.querySelector('.app__button--js-add');\r\nconst removeGlass = document.querySelector('.app__button--js-remove');\r\nconst counter = document.querySelector('.glass__counter--js');\r\nconst counterMaxValue = 99;\r\n// NAVIGATION\r\nconst burgerButton = document.querySelector('.burger-button--js');\r\nconst mobileMenu = document.querySelector('.mobile-menu--js');\r\nconst mobileMenuArchiveSection = document.querySelector('.mobile-menu__section--js-archive');\r\nconst mobileMenuStatsSection = document.querySelector('.mobile-menu__section--js-stats');\r\nconst mobileMenuSettingsSection = document.querySelector('.mobile-menu__section--js-settings');\r\n// ARCHIVE\r\nconst archive = document.querySelector('.archive--js');\r\nconst archiveWeeks = document.querySelector('.archive__weeks--js');\r\nconst archiveButton = document.querySelector('.navigation__button--js-archive');\r\nconst prevWeekButton = document.querySelector('.archive__button--js-prev');\r\nconst nextWeekButton = document.querySelector('.archive__button--js-next');\r\nconst addEntryButton = createAddEntryButton();\r\nconst removeEntryButton = createRemoveEntryButton();\r\nlet currentWeekIndex = 0;\r\n// NEW ENTRY\r\nconst newEntryMode = document.querySelector('.new-entry--js');\r\nconst newEntryValue = document.querySelector('.new-entry__value--js');\r\nconst newEntryDecrease = document.querySelector('.new-entry__button--js-decrease');\r\nconst newEntryIncrease = document.querySelector('.new-entry__button--js-increase');\r\nconst newEntryCancel = document.querySelector('.new-entry__button--js-cancel');\r\nconst newEntrySave = document.querySelector('.new-entry__button--js-save');\r\n// STATS\r\nconst statsButton = document.querySelector('.navigation__button--js-stats');\r\n\r\n/////////////////////////////////////////////////////////////// FUNCTION CALLS \r\n\r\nhandleData();\r\nsetArchiveDOM();\r\nupdateWeekHeading();\r\n\r\n//toggleMobileMenu(burgerButton);                           // ! FOR TESTS ONLY\r\n//enterNewEntryValue(107);                                    // ! FOR TESTS ONLY\r\n\r\n//////////////////////////////////////////////////////////////////// VARIABLES \r\n\r\nlet editButtons = document.querySelectorAll('.edition__button--js-edit');\r\nlet entries = document.querySelectorAll('.entry--js');\r\nconst addNewDayButton = document.querySelector('.entry__button--js-add');\r\n\r\n////////////////////////////////////////////////////////////// EVENT LISTENERS \r\n\r\nappContainer.addEventListener('click', updateCounter);\r\nburgerButton.addEventListener('click', toggleMobileMenu);\r\nmobileMenu.addEventListener('click', toggleArchive);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvanMvbWFpbi5qcz85MjkxIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0EsbURBQW1ELElBQUksc0JBQXNCLEVBQUU7QUFDL0UsK0NBQStDLEVBQUU7QUFDakQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsbUNBQW1DLFNBQVM7QUFDNUM7QUFDQSwwREFBMEQsU0FBUztBQUNuRSxtRkFBbUYsVUFBVTtBQUM3RjtBQUNBLHNEQUFzRCxXQUFXO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxRQUFRO0FBQ3RELFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUNBQWlDLFlBQVk7QUFDN0M7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSw4REFBOEQsR0FBRztBQUNqRSw2REFBNkQsR0FBRyx1QkFBdUIsTUFBTTs7QUFFN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsU0FBUyxrQ0FBa0M7O0FBRTNDO0FBQ0E7O0FBRUEsMkRBQTJEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RDtBQUM3RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLGlCQUFpQix5QkFBeUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQkFBaUIsc0JBQXNCOztBQUV2QztBQUNBO0FBQ0E7QUFDQTs7QUFFQSw2QkFBNkI7QUFDN0IsOENBQThDLHFCQUFxQixLQUFLLFFBQVE7QUFDaEYsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsNEZBQTRGLDBDQUEwQztBQUN0STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkdBQTZHLDBDQUEwQztBQUN2SixLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSwwQ0FBMEM7QUFDMUM7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxTQUFTLFNBQVM7QUFDbEI7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNGQUFzRjtBQUN0RjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxXQUFXLFVBQVU7O0FBRXJCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFdBQVcsUUFBUTs7QUFFbkI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsaUNBQWlDO0FBQ2pDLDBCQUEwQjs7QUFFMUI7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSIsImZpbGUiOiIwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gU0VSVklDRSBXT1JLRVIgXHJcblxyXG5pZiAoJ3NlcnZpY2VXb3JrZXInIGluIG5hdmlnYXRvcikge1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24oKSB7XHJcbiAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3Rlcignc2VydmljZXdvcmtlci5qcycpLnRoZW4oZnVuY3Rpb24ocmVnaXN0cmF0aW9uKSB7XHJcbiAgICAgIC8vIFJlZ2lzdHJhdGlvbiB3YXMgc3VjY2Vzc2Z1bFxyXG4gICAgICAvL2NvbnNvbGUubG9nKCdTZXJ2aWNlV29ya2VyIHJlZ2lzdHJhdGlvbiBzdWNjZXNzZnVsIHdpdGggc2NvcGU6ICcsIHJlZ2lzdHJhdGlvbi5zY29wZSk7XHJcbiAgICB9LCBmdW5jdGlvbihlcnIpIHtcclxuICAgICAgLy8gcmVnaXN0cmF0aW9uIGZhaWxlZCA6KFxyXG4gICAgICBjb25zb2xlLmxvZygnU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gZmFpbGVkOiAnLCBlcnIpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gR0xPQkFMIFZBUklBQkxFUyBcclxuXHJcbmNvbnN0IGh5ZHJhcHBBcnJheSA9IFtdO1xyXG5jb25zdCBsYXN0RW50cnlEYXRlID0gbmV3IERhdGUoKTtcclxuY29uc3Qgd2Vla0RheSA9IFsnc3VuZGF5JywnbW9uZGF5JywndHVlc2RheScsJ3dlZG5lc2RheScsJ3RodXJzZGF5JywnZnJpZGF5Jywnc2F0dXJkYXknXTtcclxuXHJcbmxldCBpbmRpY2F0b3JzID0gJyc7XHJcbmZvciAobGV0IGkgPSAwOyBpIDwgODsgaSsrKSB7XHJcbiAgaW5kaWNhdG9ycyArPSBgXHJcbiAgPHN2ZyBjbGFzcz1cImluZGljYXRvcl9fc3ZnIGluZGljYXRvcl9fc3ZnLS1lbW8tJHtpKzF9IGluZGljYXRvcl9fc3ZnLS1qcy0ke2l9XCI+XHJcbiAgICA8dXNlIGhyZWY9XCJhc3NldHMvc3ZnL2ljb25zLnN2ZyNlbW90aWNvbi0ke2l9XCI+PC91c2U+XHJcbiAgPC9zdmc+YFxyXG59XHJcblxyXG5jb25zdCBhcmNoaXZlRW1wdHkgPSBgXHJcbjxwIGNsYXNzPVwid2Vla19fZW1wdHlcIj5ObyBoaXN0b3J5IHlldC4uLjwvcD5cclxuYDtcclxuXHJcbmNvbnN0IGFkZEJ1dHRvbkh0bWwgPSBgXHJcbjxsaSBjbGFzcz1cImVudHJ5IGVudHJ5LS1hZGQgZW50cnktLWpzLWFkZFwiPlxyXG4gIDxidXR0b24gY2xhc3M9XCJidXR0b24gZW50cnlfX2J1dHRvbiBlbnRyeV9fYnV0dG9uLS1hZGQgZW50cnlfX2J1dHRvbi0tanMtYWRkXCI+XHJcbiAgICBBZGQgbmV3IGRheS4uXHJcbiAgPC9idXR0b24+XHJcbjwvbGk+XHJcbmA7XHJcblxyXG5jbGFzcyBFbnRyeSB7XHJcbiAgY29uc3RydWN0b3IoZGF0ZSkge1xyXG4gICAgdGhpcy5rZXkgPSBzZXREYXRlS2V5KGRhdGUpO1xyXG4gICAgdGhpcy52YWx1ZSA9IHRoaXMua2V5O1xyXG4gICAgdGhpcy5kYXRlID0gZGF0ZTtcclxuICAgIHRoaXMuaWQgPSB0aGlzLmRhdGU7XHJcbiAgICB0aGlzLmRheSA9IGRhdGU7XHJcblxyXG4gICAgdGhpcy53ZWVrSHRtbCA9IGBcclxuICAgICAgPHNlY3Rpb24gY2xhc3M9XCJ3ZWVrIHdlZWstLWpzXCI+XHJcbiAgICAgICAgPGhlYWRlciBjbGFzcz1cIndlZWtfX2hlYWRlciB3ZWVrX19oZWFkZXItLWpzXCI+XHJcbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnV0dG9uIHdlZWtfX2J1dHRvbiB3ZWVrX19idXR0b24tLXByZXYgd2Vla19fYnV0dG9uLS1qcy1wcmV2XCI+XHJcbiAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJ3ZWVrX19zdmdcIiB2aWV3Qm94PVwiMCAwIDUxMiA1MTJcIj5cclxuICAgICAgICAgICAgICA8dXNlIGhyZWY9XCJhc3NldHMvc3ZnL2ljb25zLnN2ZyNsZWZ0LWFycm93XCI+PC91c2U+XHJcbiAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICA8aDMgY2xhc3M9XCJ3ZWVrX19oZWFkaW5nIHdlZWtfX2hlYWRpbmctLWpzXCI+TmV3IHdlZWs8L2gzPlxyXG4gICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ1dHRvbiB3ZWVrX19idXR0b24gd2Vla19fYnV0dG9uLS1uZXh0IHdlZWtfX2J1dHRvbi0tanMtbmV4dFwiPlxyXG4gICAgICAgICAgICA8c3ZnIGNsYXNzPVwid2Vla19fc3ZnXCIgdmlld0JveD1cIjAgMCA1MTIgNTEyXCI+XHJcbiAgICAgICAgICAgICAgPHVzZSBocmVmPVwiYXNzZXRzL3N2Zy9pY29ucy5zdmcjcmlnaHQtYXJyb3dcIj48L3VzZT5cclxuICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICA8L2hlYWRlcj5cclxuICAgICAgICA8dWwgY2xhc3M9XCJ3ZWVrX19saXN0IHdlZWtfX2xpc3QtLWpzXCI+PC91bD5cclxuICAgICAgPC9zZWN0aW9uPlxyXG4gICAgYDtcclxuXHJcbiAgICB0aGlzLmRheUh0bWwgPSBgXHJcbiAgICAgIDxsaSBjbGFzcz1cImVudHJ5IGVudHJ5LS1qcyAke3RoaXMua2V5fVwiPlxyXG4gICAgICAgIDxoZWFkZXIgY2xhc3M9XCJlbnRyeV9faGVhZGVyIGVudHJ5X19oZWFkZXItLWpzXCI+XHJcbiAgICAgICAgICA8cCBjbGFzcz1cImVudHJ5X19oZWFkaW5nIGVudHJ5X19oZWFkaW5nLS1kYXlcIj4ke3RoaXMuZGF5fTwvcD5cclxuICAgICAgICAgIDxwIGNsYXNzPVwiZW50cnlfX2hlYWRpbmcgZW50cnlfX2hlYWRpbmctLWRhdGUgZW50cnlfX2hlYWRpbmctLWpzLWRhdGVcIj4ke3RoaXMuZGF0ZX08L3A+XHJcbiAgICAgICAgPC9oZWFkZXI+XHJcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJlbnRyeV9fdmFsdWUgZW50cnlfX3ZhbHVlLS1qc1wiPiR7dGhpcy52YWx1ZX08L3NwYW4+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImVkaXRpb24gZWRpdGlvbi0tanNcIj5cclxuICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidXR0b24gZWRpdGlvbl9fYnV0dG9uIGVkaXRpb25fX2J1dHRvbi0tdmlzaWJsZSBlZGl0aW9uX19idXR0b24tLWVkaXQgZWRpdGlvbl9fYnV0dG9uLS1qcy1lZGl0XCI+XHJcbiAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJlZGl0aW9uX19zdmcgZWRpdGlvbl9fc3ZnLS1lZGl0XCI+XHJcbiAgICAgICAgICAgICAgPHVzZSBocmVmPVwiYXNzZXRzL3N2Zy9pY29ucy5zdmcjZWRpdC1tb2RlXCI+PC91c2U+XHJcbiAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnV0dG9uIGVkaXRpb25fX2J1dHRvbiBlZGl0aW9uX19idXR0b24tLWRlY3JlYXNlIGVkaXRpb25fX2J1dHRvbi0tanMtZGVjcmVhc2VcIj5cclxuICAgICAgICAgICAgPHN2ZyBjbGFzcz1cImVkaXRpb25fX3N2ZyBlZGl0aW9uX19zdmctLWRlY3JlYXNlXCI+XHJcbiAgICAgICAgICAgICAgPHVzZSBocmVmPVwiYXNzZXRzL3N2Zy9pY29ucy5zdmcjZG93bi1hcnJvd1wiPjwvdXNlPlxyXG4gICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ1dHRvbiBlZGl0aW9uX19idXR0b24gZWRpdGlvbl9fYnV0dG9uLS1pbmNyZWFzZSBlZGl0aW9uX19idXR0b24tLWpzLWluY3JlYXNlXCI+XHJcbiAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJlZGl0aW9uX19zdmcgZWRpdGlvbl9fc3ZnLS1pbmNyZWFzZVwiPlxyXG4gICAgICAgICAgICAgIDx1c2UgaHJlZj1cImFzc2V0cy9zdmcvaWNvbnMuc3ZnI3VwLWFycm93XCI+PC91c2U+XHJcbiAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnV0dG9uIGVkaXRpb25fX2J1dHRvbiBlZGl0aW9uX19idXR0b24tLWNhbmNlbCBlZGl0aW9uX19idXR0b24tLWpzLWNhbmNlbFwiPlxyXG4gICAgICAgICAgICA8c3ZnIGNsYXNzPVwiZWRpdGlvbl9fc3ZnIGVkaXRpb25fX3N2Zy0tY2FuY2VsXCI+XHJcbiAgICAgICAgICAgICAgPHVzZSBocmVmPVwiYXNzZXRzL3N2Zy9pY29ucy5zdmcjYmFjay1hcnJvd1wiPjwvdXNlPlxyXG4gICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ1dHRvbiBlZGl0aW9uX19idXR0b24gZWRpdGlvbl9fYnV0dG9uLS1zYXZlIGVkaXRpb25fX2J1dHRvbi0tanMtc2F2ZVwiPlxyXG4gICAgICAgICAgICA8c3ZnIGNsYXNzPVwiZWRpdGlvbl9fc3ZnIGVkaXRpb25fX3N2Zy0tc2F2ZVwiPlxyXG4gICAgICAgICAgICAgIDx1c2UgaHJlZj1cImFzc2V0cy9zdmcvaWNvbnMuc3ZnI3NhdmUtaWNvblwiPjwvdXNlPlxyXG4gICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJpbmRpY2F0b3IgaW5kaWNhdG9yLS1qcy0ke3RoaXMuaWR9XCI+XHJcbiAgICAgICAgICAke2luZGljYXRvcnN9XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvbGk+XHJcbiAgICBgO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHZhbHVlKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xyXG4gIH1cclxuICBzZXQgdmFsdWUoa2V5KSB7XHJcbiAgICB0aGlzLl92YWx1ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgfVxyXG4gIGdldCBkYXRlKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2RhdGU7XHJcbiAgfVxyXG4gIHNldCBkYXRlKGRhdGUpIHtcclxuICAgIHRoaXMuX2RhdGUgPSBnZXRPZmZzZXRlZERhdGUoZGF0ZSkudG9JU09TdHJpbmcoKS5zbGljZSgwLDEwKS5zcGxpdCgnLScpLnJldmVyc2UoKS5qb2luKCcgJyk7XHJcbiAgfVxyXG4gIGdldCBpZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcbiAgc2V0IGlkKGRhdGUpIHtcclxuICAgIHRoaXMuX2lkID0gZGF0ZS5yZXBsYWNlKC9cXHMvZywnJyk7XHJcbiAgfVxyXG4gIGdldCBkYXkoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGF5O1xyXG4gIH1cclxuICBzZXQgZGF5KGRhdGUpIHtcclxuICAgIGNvbnN0IGRheUluZGV4ID0gZGF0ZS5nZXREYXkoKTtcclxuICAgIHRoaXMuX2RheSA9IHdlZWtEYXlbZGF5SW5kZXhdO1xyXG4gIH1cclxufVxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRlVOQ1RJT05TIFxyXG5cclxuLy8gRjAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEdFVCBPRkZTRVRFRCBEQVRFIFxyXG5cclxuY29uc3QgZ2V0T2Zmc2V0ZWREYXRlID0gKG9iaikgPT4ge1xyXG4gIGNvbnN0IHRpbWVab25lT2Zmc2V0ID0gKG5ldyBEYXRlKCkpLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMDtcclxuICByZXR1cm4gKG5ldyBEYXRlKG9iaiAtIHRpbWVab25lT2Zmc2V0KSk7XHJcbn1cclxuLy8gRjAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIENSRUFURSBIWURSQVBQIERBVEUgS0VZIFxyXG5cclxuY29uc3Qgc2V0RGF0ZUtleSA9IChvYmopID0+IHtcclxuXHJcbiAgY29uc3QgdGltZVpvbmVPZmZzZXQgPSAobmV3IERhdGUoKSkuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwO1xyXG4gIGxldCBkYXRlT2JqID0gb2JqIHx8IG5ldyBEYXRlKCk7XHJcbiAgZGF0ZU9iaiA9IChuZXcgRGF0ZShkYXRlT2JqIC0gdGltZVpvbmVPZmZzZXQpKTtcclxuXHJcbiAgY29uc3QgcHJlZml4ID0gJ2h5ZHJBcHAtJztcclxuICBjb25zdCBkYXRlU3RyID0gZGF0ZU9iai50b0lTT1N0cmluZygpLnNsaWNlKDAsMTApO1xyXG4gIHJldHVybiBwcmVmaXguY29uY2F0KGRhdGVTdHIpO1xyXG59XHJcbi8vIEYwIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIENSRUFURSBBUlJBWSBPRiBIWURSQVBQIExPQ0FMIFNUT1JBR0UgS0VZUyBcclxuXHJcbmNvbnN0IGdldEh5ZHJhcHBLZXlzID0gKCkgPT4ge1xyXG4gIGNvbnN0IHJlZ2V4ID0gL2h5ZHJBcHAtLztcclxuICByZXR1cm4gT2JqZWN0XHJcbiAgLmtleXMobG9jYWxTdG9yYWdlKVxyXG4gIC5maWx0ZXIoa2V5ID0+IHJlZ2V4LnRlc3Qoa2V5KSlcclxuICAuc29ydCgpXHJcbiAgLnJldmVyc2UoKTtcclxufVxyXG4vLyBGMCAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gQ1JFQVRFIEtFWSBWQUxVRSBQQUlSIElOIExPQ0FMIFNUT1JBR0UgXHJcblxyXG5jb25zdCBzZXROZXdLZXlWYWx1ZSA9IChrZXksIHZhbHVlKSA9PiB7XHJcbiAgaWYgKCAhbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSApIHtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgdmFsdWUpO1xyXG4gIH07XHJcbn1cclxuLy8gRjAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBMT09QRUQgUkFOR0UgT0YgVkFMVUVTIFxyXG5cclxuY29uc3QgcmFuZ2UgPSAobWF4LCBudW0sIGFjdGlvbikgPT4ge1xyXG4gIGFjdGlvbiA9PT0gJ2luY3JlYXNlJyA/IG51bSA+PSBtYXggPyBudW0gPSAwIDogbnVtKysgOiBmYWxzZTtcclxuICBhY3Rpb24gPT09ICdkZWNyZWFzZScgPyBudW0gPD0gMCA/IG51bSA9IG1heCA6IG51bS0tIDogZmFsc2U7XHJcbiAgcmV0dXJuIG51bTtcclxufVxyXG4vLyBGMCAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gTElNSVRFRCBSQU5HRSBPRiBWQUxVRVMgXHJcblxyXG5jb25zdCBsaW1pdCA9IChtYXgsIG51bSwgYWN0aW9uKSA9PiB7XHJcbiAgYWN0aW9uID09PSAnaW5jcmVhc2UnID8gbnVtID49IG1heCA/IGZhbHNlIDogbnVtKysgOiBmYWxzZTtcclxuICBhY3Rpb24gPT09ICdkZWNyZWFzZScgPyBudW0gPD0gMCA/IGZhbHNlIDogbnVtLS0gOiBmYWxzZTtcclxuICByZXR1cm4gbnVtO1xyXG59XHJcbi8vIEYwIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNFVCBDVVJSRU5UTFkgRElTUExBWUVEIEFSQ0hJVkUgV0VFSydTIEhFSUdIVCBcclxuXHJcbmNvbnN0IHNldEN1cnJlbnRXZWVrSGVpZ2h0ID0gKCkgPT4ge1xyXG4gIFxyXG4gIGNvbnN0IGN1cnJlbnRXZWVrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndlZWstLWpzJylbY3VycmVudFdlZWtJbmRleF07XHJcbiAgY29uc3QgY2hpbGRyZW5BcnJheSA9IFsuLi5jdXJyZW50V2Vlay5jaGlsZHJlbl07XHJcbiAgY29uc3QgY2hpbGRyZW5IZWlnaHQgPSBjaGlsZHJlbkFycmF5LnJlZHVjZSgoYSxiKSA9PiBhICsgYi5jbGllbnRIZWlnaHQsIDApO1xyXG4gIGNvbnN0IG9mZnNldEhlaWdodCA9IDQwO1xyXG4gIGNvbnN0IGZpbmFsSGVpZ2h0ID0gY2hpbGRyZW5IZWlnaHQgKyBvZmZzZXRIZWlnaHQ7XHJcblxyXG4gIGFyY2hpdmVXZWVrcy5zdHlsZS5oZWlnaHQgPSBgJHtmaW5hbEhlaWdodH1weGA7XHJcbn1cclxuLy8gRjAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNFVCBJTkRJQ0FUT1JTIFxyXG5cclxuY29uc3Qgc2V0SW5kaWNhdG9ycyA9IChpZCwgdmFsdWUpID0+IHtcclxuXHJcbiAgdmFsdWUgPiA3ID8gdmFsdWUgPSA3IDogZmFsc2U7XHJcblxyXG4gIGNvbnN0IGluZGljYXRvcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuaW5kaWNhdG9yLS1qcy0ke2lkfWApLmNoaWxkcmVuO1xyXG4gIGNvbnN0IGluZGljYXRvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5pbmRpY2F0b3ItLWpzLSR7aWR9IC5pbmRpY2F0b3JfX3N2Zy0tanMtJHt2YWx1ZX1gKTtcclxuICBcclxuICBmb3IgKGNvbnN0IGluZGljYXRvciBvZiBpbmRpY2F0b3JzKSB7XHJcbiAgICBpbmRpY2F0b3IuY2xhc3NMaXN0LmNvbnRhaW5zKCdpbmRpY2F0b3JfX3N2Zy0tdmlzaWJsZScpXHJcbiAgICA/IGluZGljYXRvci5jbGFzc0xpc3QucmVtb3ZlKCdpbmRpY2F0b3JfX3N2Zy0tdmlzaWJsZScpXHJcbiAgICA6IGZhbHNlO1xyXG4gIH1cclxuICBpbmRpY2F0b3IuY2xhc3NMaXN0LmFkZCgnaW5kaWNhdG9yX19zdmctLXZpc2libGUnKTtcclxufVxyXG4vLyBGMCAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gQ1JFQVRFIEFERCBFTlRSWSBCVVRUT04gXHJcblxyXG5jb25zdCBjcmVhdGVBZGRFbnRyeUJ1dHRvbiA9ICgpID0+IHtcclxuICBjb25zdCBhZGRFbnRyeUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgYWRkRW50cnlCdXR0b24uY2xhc3NOYW1lID0gJ2VudHJ5IGVudHJ5X19hZGQnO1xyXG4gIGFkZEVudHJ5QnV0dG9uLmlubmVySFRNTCA9IGBcclxuICAgIDxidXR0b24gY2xhc3M9XCJidXR0b24gZW50cnlfX2J1dHRvbiBlbnRyeV9fYnV0dG9uLS1hZGQgZW50cnlfX2J1dHRvbi0tanMtYWRkXCI+XHJcbiAgICAgIEFkZCBuZXcgZGF5Li5cclxuICAgIDwvYnV0dG9uPlxyXG4gIGA7XHJcbiAgYWRkRW50cnlCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlbnRlck5ld0VudHJ5VmFsdWUpO1xyXG5cclxuICByZXR1cm4gYWRkRW50cnlCdXR0b247XHJcbn1cclxuLy8gRjAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gQ1JFQVRFICdSRU1PVkUgSVRFTScgQlVUVE9OIFxyXG5cclxuY29uc3QgY3JlYXRlUmVtb3ZlRW50cnlCdXR0b24gPSAoKSA9PiB7XHJcblxyXG4gIGNvbnN0IHJlbW92ZUVudHJ5QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgcmVtb3ZlRW50cnlCdXR0b24uY2xhc3NOYW1lID0gJ2J1dHRvbiBlbnRyeV9fcmVtb3ZlJztcclxuICByZW1vdmVFbnRyeUJ1dHRvbi5pbm5lckhUTUwgPSBgXHJcbiAgICA8c3ZnIGNsYXNzPVwiZW50cnlfX3N2Z1wiIHZpZXdCb3g9XCIwIDAgNTEyIDUxMlwiPlxyXG4gICAgICA8dXNlIGhyZWY9XCJhc3NldHMvc3ZnL2ljb25zLnN2ZyNyZW1vdmUtaWNvblwiPjwvdXNlPlxyXG4gICAgPC9zdmc+XHJcbiAgYFxyXG4gIHJlbW92ZUVudHJ5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVtb3ZlTGFzdEVudHJ5KTtcclxuXHJcbiAgcmV0dXJuIHJlbW92ZUVudHJ5QnV0dG9uO1xyXG59XHJcbi8vIEYyIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTRVQgTE9DQUwgU1RPUkFHRSBcclxuXHJcbmNvbnN0IGhhbmRsZURhdGEgPSAoKSA9PiB7XHJcblxyXG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gIGxldCBkYXRlS2V5ID0gc2V0RGF0ZUtleShkYXRlKTtcclxuICBzZXROZXdLZXlWYWx1ZShkYXRlS2V5LCAwKTtcclxuICBsZXQgaHlkcmFwcEtleXMgPSBnZXRIeWRyYXBwS2V5cygpO1xyXG4gIGNvbnN0IG9sZGVzdEtleSA9IGh5ZHJhcHBLZXlzW2h5ZHJhcHBLZXlzLmxlbmd0aCAtIDFdO1xyXG4gIFxyXG4gIC8vIGNyZWF0ZSBvYmplY3QgZm9yIGVhY2gga2V5XHJcbiAgY29uc3QgY3JlYXRlRW50cnlPYmplY3QgPSAoZGF0ZSkgPT4ge1xyXG4gICAgY29uc3QgbmV3RW50cnkgPSBuZXcgRW50cnkoZGF0ZSk7XHJcbiAgICBoeWRyYXBwQXJyYXkucHVzaChuZXdFbnRyeSk7XHJcbiAgfVxyXG4gIC8vIGZpcnN0IG9iamVjdCBvZiBhcnJheVxyXG4gIGNyZWF0ZUVudHJ5T2JqZWN0KGRhdGUpO1xyXG5cclxuICAvLyBhdXRvY29tcGxldGUgdGhlIHJlc3Qgb2Yga2V5cyBpZiBuZWVkZWRcclxuICB3aGlsZSAoZGF0ZUtleSAhPT0gb2xkZXN0S2V5KSB7XHJcbiAgICBkYXRlS2V5ID0gc2V0RGF0ZUtleShkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSAxKSk7XHJcbiAgICBsYXN0RW50cnlEYXRlLnNldERhdGUobGFzdEVudHJ5RGF0ZS5nZXREYXRlKCkgLSAxKTtcclxuICAgIHNldE5ld0tleVZhbHVlKGRhdGVLZXksIDApO1xyXG4gICAgY3JlYXRlRW50cnlPYmplY3QoZGF0ZSk7XHJcbiAgfVxyXG4gIC8vY291bnRlci5pbm5lckhUTUwgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShkYXRlS2V5KTtcclxuICB1cGRhdGVDb3VudGVyKCdkaXNwbGF5VmFsdWUnKTtcclxufVxyXG4vLyBGMSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gVVBEQVRFIENPVU5URVIgXHJcblxyXG5jb25zdCB1cGRhdGVDb3VudGVyID0gKGUpID0+IHtcclxuICBjb25zdCBzZWxmID0gZS50YXJnZXQgfHwgZTtcclxuICBjb25zdCBrZXkgPSBzZXREYXRlS2V5KCk7XHJcbiAgbGV0IHZhbHVlID0gcGFyc2VJbnQobG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSk7XHJcbiAgY29uc3QgZmlyc3RBcmNoaXZlRW50cnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZW50cnlfX3ZhbHVlLS1qcycpO1xyXG5cclxuICBzd2l0Y2ggKHNlbGYpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICEgUkVGQUNUT1JcclxuICAgIGNhc2UgJ2Rpc3BsYXlWYWx1ZSc6XHJcbiAgICAgIGNvdW50ZXIuaW5uZXJIVE1MID0gdmFsdWU7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgXHJcbiAgICBjYXNlIGFkZEdsYXNzOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAhIFJFRkFDVE9SXHJcbiAgICAgIHZhbHVlIDwgY291bnRlck1heFZhbHVlID8gdmFsdWUrKyA6IHZhbHVlID0gY291bnRlck1heFZhbHVlO1xyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcclxuICAgICAgaHlkcmFwcEFycmF5WzBdLnZhbHVlID0ga2V5O1xyXG4gICAgICBjb3VudGVyLmlubmVySFRNTCA9IHZhbHVlO1xyXG4gICAgICBmaXJzdEFyY2hpdmVFbnRyeS50ZXh0Q29udGVudCA9IGh5ZHJhcHBBcnJheVswXS52YWx1ZTtcclxuICAgICAgYnJlYWs7XHJcblxyXG4gICAgY2FzZSByZW1vdmVHbGFzczogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gISBSRUZBQ1RPUlxyXG4gICAgICB2YWx1ZSA+IDAgPyB2YWx1ZS0tIDogdmFsdWUgPSAwO1xyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcclxuICAgICAgaHlkcmFwcEFycmF5WzBdLnZhbHVlID0ga2V5O1xyXG4gICAgICBjb3VudGVyLmlubmVySFRNTCA9IHZhbHVlO1xyXG4gICAgICBmaXJzdEFyY2hpdmVFbnRyeS50ZXh0Q29udGVudCA9IGh5ZHJhcHBBcnJheVswXS52YWx1ZTtcclxuICAgICAgYnJlYWs7XHJcbiAgfVxyXG59XHJcbi8vIEYyIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gQUREIEFSQ0hJVkUgTk9ERSBcclxuXHJcbmNvbnN0IGFkZEFyY2hpdmVOb2RlID0gKGluZGV4LCBvcHRpb24pID0+IHtcclxuXHJcbiAgY29uc3Qge3ZhbHVlLCBpZCwgZGF5LCBkYXlIdG1sLCB3ZWVrSHRtbH0gPSBoeWRyYXBwQXJyYXlbaW5kZXhdO1xyXG4gIFxyXG4gIC8vIGFkZCBuZXcgd2Vla1xyXG4gIGlmICgoKGRheSA9PT0gJ3N1bmRheScgfHwgaW5kZXggPT09IDApKSAmJiBvcHRpb24gIT09ICdhZGQnKSB7XHJcblxyXG4gICAgYXJjaGl2ZVdlZWtzLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgd2Vla0h0bWwpOyAgICAgICAgICAgICAgICAvLyAhIFRPIFJFRkFDVE9SXHJcbiAgICBjb25zdCB3ZWVrSGVhZGVyID0gYXJjaGl2ZVdlZWtzLmxhc3RFbGVtZW50Q2hpbGQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICB3ZWVrSGVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2xpZGVXZWVrKTtcclxuICB9XHJcbiAgLy8gYWRkIG5leHQgZGF5IGVudHJ5XHJcbiAgbGV0IGxhc3RXZWVrTGlzdCA9IGFyY2hpdmVXZWVrcy5sYXN0RWxlbWVudENoaWxkLmxhc3RFbGVtZW50Q2hpbGQ7XHJcbiAgbGFzdFdlZWtMaXN0Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgZGF5SHRtbCk7XHJcbiAgc2V0SW5kaWNhdG9ycyhpZCwgdmFsdWUpO1xyXG5cclxuICAvLyBhZGQgJ2FkZCBlbnRyeSBidXR0b24gYXQgdGhlIGVuZFxyXG4gIGlmIChpbmRleCA9PT0gaHlkcmFwcEFycmF5Lmxlbmd0aCAtIDEpIHtcclxuICAgIGlmIChkYXkgPT09ICdtb25kYXknKSB7XHJcbiAgICAgIGFyY2hpdmVXZWVrcy5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgd2Vla0h0bWwpOyAgICAgICAgICAgICAgLy8gISBUTyBSRUZBQ1RPUlxyXG4gICAgICBjb25zdCB3ZWVrSGVhZGVyID0gYXJjaGl2ZVdlZWtzLmxhc3RFbGVtZW50Q2hpbGQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICAgIHdlZWtIZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzbGlkZVdlZWspO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXN0V2Vla0xpc3QgPSBhcmNoaXZlV2Vla3MubGFzdEVsZW1lbnRDaGlsZC5sYXN0RWxlbWVudENoaWxkO1xyXG4gICAgbGFzdFdlZWtMaXN0LmFwcGVuZENoaWxkKGFkZEVudHJ5QnV0dG9uKTtcclxuICB9XHJcbiAgdXBkYXRlV2Vla0hlYWRpbmcoKTtcclxuXHJcbiAgLy8gYWRkIGV2ZW50IGxpc3RlbmVycyB0byBhbGwgZWRpdCBidXR0b25zXHJcbiAgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lZGl0aW9uX19idXR0b24tLWpzLWVkaXQnKVtpbmRleF07XHJcbiAgZWRpdEJ1dHRvbi5pbmRleCA9IGluZGV4O1xyXG4gIGVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVJdGVtRWRpdCk7XHJcbn1cclxuLy8gRjIgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNFVCBBUkNISVZFIFxyXG5cclxuY29uc3Qgc2V0QXJjaGl2ZURPTSA9ICgpID0+IHtcclxuICBcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGh5ZHJhcHBBcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgYWRkQXJjaGl2ZU5vZGUoaSk7XHJcbiAgfVxyXG4gIC8vIHNldCB0aGUgbmV3ZXN0IHdlZWsgYXMgdmlzaWJsZVxyXG4gIGNvbnN0IHdlZWtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndlZWstLWpzJyk7XHJcbiAgd2Vla3NbY3VycmVudFdlZWtJbmRleF0uY2xhc3NMaXN0LmFkZCgnd2Vlay0tdmlzaWJsZScpO1xyXG4gIC8vIHNldCAncmVtb3ZlIGVudHJ5JyBidXR0b24gb24gdGhlIGxhc3QgZW50cnlcclxuICBoYW5kbGVBcmNoaXZlTGFzdEVudHJ5KCk7XHJcblxyXG4gIC8vIGdlbmVyYXRlIGluZGljYXRvcnMgZm9yIG5ldyBlbnRyeSBtb2RlXHJcbiAgY29uc3QgaW5kaWNhdG9yc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbmRpY2F0b3ItLWpzLW5ldycpO1xyXG4gIGluZGljYXRvcnNDb250YWluZXIuaW5uZXJIVE1MID0gaW5kaWNhdG9ycztcclxuICBzZXRJbmRpY2F0b3JzKCduZXcnLCAwKTtcclxufVxyXG4vLyBGMiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNFVCBXRUVLIEhFQURJTkcgXHJcblxyXG5jb25zdCB1cGRhdGVXZWVrSGVhZGluZyA9ICgpID0+IHtcclxuXHJcbiAgY29uc3Qgd2Vla0xpc3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndlZWtfX2xpc3QtLWpzJyk7XHJcbiAgY29uc3Qgd2Vla0hlYWRpbmdzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndlZWtfX2hlYWRpbmctLWpzJyk7XHJcblxyXG4gIC8vIEYwIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gR0VUIERBVEUgXHJcbiAgY29uc3QgZ2V0RGF0ZSA9IChlbGVtZW50KSA9PiB7XHJcblxyXG4gICAgaWYgKGVsZW1lbnQpIHtcclxuICAgICAgY29uc3QgZmlsdGVyZWQgPSBlbGVtZW50LmNsYXNzTmFtZS5zcGxpdCgnICcpLmZpbHRlcihhID0+IC9oeWRyQXBwLy50ZXN0KGEpKTtcclxuICAgICAgcmV0dXJuIGZpbHRlcmVkLnRvU3RyaW5nKCkuc2xpY2UoMTApLnNwbGl0KCctJykucmV2ZXJzZSgpLmpvaW4oJy4nKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbiAgLy8gRjAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gU0VUIEJVVFRPTlMgVklTSUJJTElUWSBcclxuICBjb25zdCBzZXRCdXR0b25zVmlzaWJsaXR5ID0gKGluZGV4LCBvcHRpb24pID0+IHtcclxuICAgIGNvbnN0IHByZXZXZWVrQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndlZWtfX2J1dHRvbi0tanMtcHJldicpW2luZGV4XTtcclxuICAgIGNvbnN0IG5leHRXZWVrQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndlZWtfX2J1dHRvbi0tanMtbmV4dCcpW2luZGV4XTtcclxuXHJcbiAgICBzd2l0Y2ggKGluZGV4KSB7XHJcblxyXG4gICAgICBjYXNlIDA6XHJcbiAgICAgICAgcHJldldlZWtCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnd2Vla19fYnV0dG9uLS12aXNpYmxlJyk7XHJcbiAgICAgICAgb3B0aW9uID09PSAnb25lV2VlaydcclxuICAgICAgICA/IG5leHRXZWVrQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ3dlZWtfX2J1dHRvbi0tdmlzaWJsZScpXHJcbiAgICAgICAgOiBuZXh0V2Vla0J1dHRvbi5jbGFzc0xpc3QuYWRkKCd3ZWVrX19idXR0b24tLXZpc2libGUnKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgXHJcbiAgICAgIGNhc2Ugd2Vla0hlYWRpbmdzLmxlbmd0aCAtIDE6XHJcbiAgICAgICAgcHJldldlZWtCdXR0b24uY2xhc3NMaXN0LmFkZCgnd2Vla19fYnV0dG9uLS12aXNpYmxlJyk7XHJcbiAgICAgICAgbmV4dFdlZWtCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnd2Vla19fYnV0dG9uLS12aXNpYmxlJyk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHByZXZXZWVrQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3dlZWtfX2J1dHRvbi0tdmlzaWJsZScpO1xyXG4gICAgICAgIG5leHRXZWVrQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3dlZWtfX2J1dHRvbi0tdmlzaWJsZScpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IHdlZWtMaXN0cy5sZW5ndGg7IGkrKykge1xyXG5cclxuICAgIGNvbnN0IGVudHJpZXMgPSB3ZWVrTGlzdHNbaV0ucXVlcnlTZWxlY3RvckFsbCgnLmVudHJ5LS1qcycpO1xyXG4gICAgY29uc3Qgc3RhcnREYXRlID0gZ2V0RGF0ZShlbnRyaWVzW2VudHJpZXMubGVuZ3RoIC0gMV0pO1xyXG4gICAgY29uc3QgZW5kRGF0ZSA9IGdldERhdGUoZW50cmllc1swXSk7XHJcbiAgICBjb25zdCBoZWFkaW5nID0gd2Vla0hlYWRpbmdzW2ldO1xyXG5cclxuICAgIGhlYWRpbmcudGV4dENvbnRlbnQgPSBgJHtzdGFydERhdGVcclxuICAgID8gKHN0YXJ0RGF0ZSA9PT0gZW5kRGF0ZSA/IHN0YXJ0RGF0ZSA6IGAke3N0YXJ0RGF0ZS5zbGljZSgwLDUpfSAtICR7ZW5kRGF0ZX1gKVxyXG4gICAgOiBgTmV3IFdlZWtgfWA7XHJcblxyXG4gICAgd2Vla0xpc3RzLmxlbmd0aCA+IDEgPyBzZXRCdXR0b25zVmlzaWJsaXR5KGkpIDogc2V0QnV0dG9uc1Zpc2libGl0eShpLCAnb25lV2VlaycpO1xyXG4gIH1cclxufVxyXG4vLyBGMSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBUT0dHTEUgTU9CSUxFIE1FTlUgXHJcblxyXG5jb25zdCB0b2dnbGVNb2JpbGVNZW51ID0gKGUpID0+IHtcclxuICBjb25zdCBzZWxmID0gZS50YXJnZXQgfHwgZTtcclxuXHJcbiAgaWYgKHNlbGYgPT09IGJ1cmdlckJ1dHRvbikge1xyXG5cclxuICAgIHNlbGYuY2xhc3NMaXN0LnRvZ2dsZSgnYnVyZ2VyLWJ1dHRvbi0tYWN0aXZlJyk7XHJcbiAgICBtb2JpbGVNZW51LmNsYXNzTGlzdC50b2dnbGUoJ21vYmlsZS1tZW51LS12aXNpYmxlJyk7XHJcbiAgfVxyXG59XHJcbi8vIEYxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNIT1cgQVJDSElWRSBcclxuXHJcbmNvbnN0IHNob3dBcmNoaXZlID0gKCkgPT4ge1xyXG5cclxuICBlbnRyaWVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVudHJ5LS1qcycpO1xyXG5cclxuICBpZiAoYXJjaGl2ZS5jbGFzc0xpc3QuY29udGFpbnMoJ2FyY2hpdmUtLXZpc2libGUnKSkge1xyXG4gICAgYXJjaGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhcmNoaXZlLS12aXNpYmxlJylcclxuXHJcbiAgfSBlbHNlIHtcclxuXHJcbiAgICBhcmNoaXZlLmNsYXNzTGlzdC5hZGQoJ2FyY2hpdmUtLXZpc2libGUnKTtcclxuICB9XHJcbn1cclxuLy8gRjEgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEVYUEFORCBBUkNISVZFIFxyXG5cclxuY29uc3QgdG9nZ2xlQXJjaGl2ZSA9IChlKSA9PiB7ICAgICAgICAgICAgICAgICAgICAgIC8vICEgdG8gRFJZICFcclxuICBjb25zdCBzZWxmID0gZS50YXJnZXQ7XHJcbiAgY29uc3Qgc3ZnSWNvbnMgPSBzZWxmLmxhc3RFbGVtZW50Q2hpbGQ7XHJcbiAgY29uc3Qgc2VjdGlvbiA9IHNlbGYubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG5cclxuICBzd2l0Y2ggKHNlbGYpIHtcclxuICAgIGNhc2UgbW9iaWxlTWVudUFyY2hpdmVTZWN0aW9uOlxyXG4gICAgICBcclxuICAgICAgc3ZnSWNvbnMuY2xhc3NMaXN0LnRvZ2dsZSgnbW9iaWxlLW1lbnVfX3N2Zy0tYWN0aXZlJyk7XHJcbiAgICAgIGlmIChzdmdJY29ucy5jbGFzc0xpc3QuY29udGFpbnMoJ21vYmlsZS1tZW51X19zdmctLWFjdGl2ZScpKSB7XHJcblxyXG4gICAgICAgIHNldEN1cnJlbnRXZWVrSGVpZ2h0KCk7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlbnRlck5ld0VudHJ5VmFsdWUpO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgcmVtb3ZlTGFzdEVudHJ5KTtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHNsaWRlV2Vlayk7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICBzZWN0aW9uLnN0eWxlLmhlaWdodCA9IDA7XHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlbnRlck5ld0VudHJ5VmFsdWUpO1xyXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgcmVtb3ZlTGFzdEVudHJ5KTtcclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHNsaWRlV2Vlayk7XHJcblxyXG4gICAgICB9XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgXHJcbiAgICBjYXNlIG1vYmlsZU1lbnVTdGF0c1NlY3Rpb246XHJcbiAgICAgIHN2Z0ljb25zLmNsYXNzTGlzdC50b2dnbGUoJ21vYmlsZS1tZW51X19zdmctLWFjdGl2ZScpO1xyXG4gICAgICBzZWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ3N0YXRzX19jb250YWluZXItLWFjdGl2ZScpO1xyXG4gICAgICBicmVhaztcclxuXHJcbiAgICBjYXNlIG1vYmlsZU1lbnVTZXR0aW5nc1NlY3Rpb246XHJcbiAgICAgIHN2Z0ljb25zLmNsYXNzTGlzdC50b2dnbGUoJ21vYmlsZS1tZW51X19zdmctLWFjdGl2ZScpO1xyXG4gICAgICBzZWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ3NldHRpbmdzX19jb250YWluZXItLWFjdGl2ZScpO1xyXG4gICAgICBicmVhaztcclxuICB9XHJcbn1cclxuLy8gRjIgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTTElERSBXRUVLIFxyXG5cclxuY29uc3Qgc2xpZGVXZWVrID0gKGUpID0+IHtcclxuXHJcbiAgY29uc3Qgc2VsZiA9IGUua2V5Q29kZSB8fCBlLnRhcmdldDtcclxuICBjb25zdCBwcmV2V2Vla0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy53ZWVrX19idXR0b24tLWpzLXByZXYnKVtjdXJyZW50V2Vla0luZGV4XTtcclxuICBjb25zdCBuZXh0V2Vla0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy53ZWVrX19idXR0b24tLWpzLW5leHQnKVtjdXJyZW50V2Vla0luZGV4XTtcclxuICBjb25zdCB3ZWVrc0Ftb3VudCA9IGFyY2hpdmVXZWVrcy5jaGlsZHJlbi5sZW5ndGg7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVNsaWRlID0gKGRpcmVjdGlvbikgPT4ge1xyXG4gICAgLy8gaGFuZGxlIHByZXZpb3VzIHNlY3Rpb25cclxuICAgIGFyY2hpdmVXZWVrcy5jaGlsZHJlbltjdXJyZW50V2Vla0luZGV4XS5jbGFzc05hbWUgPSBgd2VlayB3ZWVrLS1qcyB3ZWVrLS1zbGlkZS1vdXQtdG8tJHtkaXJlY3Rpb24gPT09ICd0b0xlZnQnID8gYHJpZ2h0YCA6IGBsZWZ0YH1gO1xyXG4gICAgY29uc3QgcHJldmlvdXNXZWVrSW5kZXggPSBjdXJyZW50V2Vla0luZGV4O1xyXG4gICAgLy8gY2hhbmdlIGluZGV4XHJcbiAgICBjdXJyZW50V2Vla0luZGV4ID0gbGltaXQoYXJjaGl2ZVdlZWtzLmNoaWxkcmVuLmxlbmd0aCAtIDEsIGN1cnJlbnRXZWVrSW5kZXgsIGRpcmVjdGlvbiA9PT0gJ3RvTGVmdCcgPyBgZGVjcmVhc2VgIDogYGluY3JlYXNlYCk7XHJcbiAgICAvLyBoYW5kbGUgbmV4dCBzZWN0aW9uXHJcbiAgICBpZiAoY3VycmVudFdlZWtJbmRleCAhPT0gcHJldmlvdXNXZWVrSW5kZXgpIHtcclxuICAgICAgYXJjaGl2ZVdlZWtzLmNoaWxkcmVuW2N1cnJlbnRXZWVrSW5kZXhdLmNsYXNzTGlzdCA9IGB3ZWVrIHdlZWstLWpzIHdlZWstLXZpc2libGUgd2Vlay0tc2xpZGUtaW4tZnJvbS0ke2RpcmVjdGlvbiA9PT0gJ3RvTGVmdCcgPyBgbGVmdGAgOiBgcmlnaHRgfWA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhcmNoaXZlV2Vla3MuY2hpbGRyZW5bY3VycmVudFdlZWtJbmRleF0uY2xhc3NMaXN0ID0gJ3dlZWsgd2Vlay0tanMgd2Vlay0tdmlzaWJsZSc7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBpZiAod2Vla3NBbW91bnQgPiAxKSB7XHJcbiAgICBzd2l0Y2ggKHNlbGYpIHtcclxuICAgICAgY2FzZSAzNzpcclxuICAgICAgY2FzZSBwcmV2V2Vla0J1dHRvbjpcclxuICAgICAgICBoYW5kbGVTbGlkZSgndG9MZWZ0Jyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgMzk6XHJcbiAgICAgIGNhc2UgbmV4dFdlZWtCdXR0b246XHJcbiAgICAgICAgaGFuZGxlU2xpZGUoJ3RvUmlnaHQnKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICAgIHNldEN1cnJlbnRXZWVrSGVpZ2h0KCk7XHJcbiAgfVxyXG59XHJcbi8vIEYxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBBUkNISVZFIE1PREFMIDw8IFNIT1cgQVJDSElWRSBcclxuXHJcbmNvbnN0IGVudGVyTmV3RW50cnlWYWx1ZSA9IChlKSA9PiB7XHJcblxyXG4gIGNvbnN0IHNlbGYgPSBlLmtleUNvZGUgfHwgZS50YXJnZXQgfHwgZTsgICAgICAgICAgICAgICAgLy8gISBlIG9ubHkgZm9yIHRlc3RzXHJcbiAgY29uc3QgYWRkRW50cnlCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZW50cnlfX2J1dHRvbi0tanMtYWRkJyk7XHJcblxyXG4gIGlmIChzZWxmID09PSAxMDcgfHwgc2VsZiA9PT0gYWRkRW50cnlCdXR0b24pIHtcclxuXHJcbiAgICBsZXQgdmFsdWUgPSAwO1xyXG4gICAgbmV3RW50cnlNb2RlLmNsYXNzTGlzdC5hZGQoJ25ldy1lbnRyeS0tdmlzaWJsZScpO1xyXG4gICAgbmV3RW50cnlWYWx1ZS50ZXh0Q29udGVudCA9IHZhbHVlO1xyXG4gIFxyXG4gICAgY29uc3QgbW9kZU9mZiA9ICgpID0+IHtcclxuICAgICAgbmV3RW50cnlNb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ25ldy1lbnRyeS0tdmlzaWJsZScpO1xyXG4gICAgICBuZXdFbnRyeU1vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVWYWx1ZSk7XHJcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlVmFsdWUpO1xyXG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGVudGVyTmV3RW50cnlWYWx1ZSk7XHJcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgc2xpZGVXZWVrKTtcclxuICAgIH1cclxuICBcclxuICAgIGNvbnN0IGhhbmRsZVZhbHVlID0gKGUpID0+IHtcclxuICBcclxuICAgICAgY29uc3Qgc2VsZiA9IGUua2V5Q29kZSB8fCBlLnRhcmdldDtcclxuICBcclxuICAgICAgc3dpdGNoIChzZWxmKSB7XHJcbiAgXHJcbiAgICAgICAgY2FzZSAzNzpcclxuICAgICAgICBjYXNlIG5ld0VudHJ5RGVjcmVhc2U6XHJcbiAgICAgICAgICB2YWx1ZSAhPT0gMCA/IHZhbHVlLS0gOiBmYWxzZTtcclxuICAgICAgICAgIG5ld0VudHJ5VmFsdWUudGV4dENvbnRlbnQgPSB2YWx1ZTtcclxuICAgICAgICAgIHNldEluZGljYXRvcnMoJ25ldycsIHZhbHVlKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlIDM5OlxyXG4gICAgICAgIGNhc2UgbmV3RW50cnlJbmNyZWFzZTpcclxuICAgICAgICAgIHZhbHVlICE9PSBjb3VudGVyTWF4VmFsdWUgPyB2YWx1ZSsrIDogZmFsc2U7XHJcbiAgICAgICAgICBuZXdFbnRyeVZhbHVlLnRleHRDb250ZW50ID0gdmFsdWU7XHJcbiAgICAgICAgICBzZXRJbmRpY2F0b3JzKCduZXcnLCB2YWx1ZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICBcclxuICAgICAgICBjYXNlIDI3OlxyXG4gICAgICAgIGNhc2UgbmV3RW50cnlDYW5jZWw6XHJcbiAgICAgICAgICBtb2RlT2ZmKCk7XHJcbiAgICAgICAgICBicmVhaztcclxuICBcclxuICAgICAgICBjYXNlIDEzOlxyXG4gICAgICAgIGNhc2UgbmV3RW50cnlTYXZlOlxyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgYWRkTmV3RW50cnkoZSwgdmFsdWUpO1xyXG4gICAgICAgICAgbW9kZU9mZigpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIG5ld0VudHJ5TW9kZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVZhbHVlKTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlVmFsdWUpO1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlbnRlck5ld0VudHJ5VmFsdWUpO1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBzbGlkZVdlZWspO1xyXG4gIH1cclxufVxyXG4vLyBGMSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEFERCBORVcgSVRFTSA8PCBTSE9XIEFSQ0hJVkUgXHJcblxyXG5jb25zdCBhZGROZXdFbnRyeSA9IChlLCB2YWx1ZSkgPT4ge1xyXG4gIFxyXG4gIGNvbnN0IHNlbGYgPSBlLmtleUNvZGUgfHwgZS50YXJnZXQ7XHJcblxyXG4gIGlmIChzZWxmID09PSAxMyB8fCBzZWxmID09PSBuZXdFbnRyeVNhdmUpIHtcclxuXHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgbGV0IGxhc3RFbnRyeUluZGV4ID0gaHlkcmFwcEFycmF5Lmxlbmd0aCAtIDE7XHJcbiAgICBjb25zdCBsYXN0RW50cnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZW50cnktLWpzJylbbGFzdEVudHJ5SW5kZXhdO1xyXG4gICAgbGFzdEVudHJ5LmNsYXNzTGlzdC5yZW1vdmUoJ2VudHJ5LS1sYXN0Jyk7XHJcblxyXG4gICAgbGFzdEVudHJ5RGF0ZS5zZXREYXRlKGxhc3RFbnRyeURhdGUuZ2V0RGF0ZSgpIC0gMSk7XHJcbiAgICBjb25zdCBuZXdFbnRyeUtleSA9IHNldERhdGVLZXkobGFzdEVudHJ5RGF0ZSk7XHJcbiAgICBcclxuICAgIC8vIGhhbmRsZSBsb2NhbCBzdG9yYWdlIGFuZCBhcnJheSBvZiBvYmplY3RzXHJcbiAgICBzZXROZXdLZXlWYWx1ZShuZXdFbnRyeUtleSwgdmFsdWUpO1xyXG4gICAgY29uc3QgbmV3RW50cnkgPSBuZXcgRW50cnkobGFzdEVudHJ5RGF0ZSk7XHJcbiAgICBuZXdFbnRyeS52YWx1ZSA9IG5ld0VudHJ5S2V5O1xyXG4gICAgaHlkcmFwcEFycmF5LnB1c2gobmV3RW50cnkpO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBuZXcgZW50cnkgbm9kZVxyXG4gICAgbGFzdEVudHJ5SW5kZXggPSBoeWRyYXBwQXJyYXkubGVuZ3RoIC0gMTtcclxuICAgIGFkZEFyY2hpdmVOb2RlKGxhc3RFbnRyeUluZGV4LCAnYWRkJyk7XHJcblxyXG4gICAgLy8ganVtcCB0byB0aGUgbGFzdCB3ZWVrXHJcbiAgICBjb25zdCB3ZWVrcyA9IGFyY2hpdmVXZWVrcy5jaGlsZHJlbjtcclxuICAgIGNvbnN0IGN1cnJlbnRXZWVrID0gd2Vla3NbY3VycmVudFdlZWtJbmRleF07XHJcbiAgICBjb25zdCBsYXN0V2Vla0luZGV4ID0gd2Vla3MubGVuZ3RoIC0gMTtcclxuICAgIGNvbnN0IGxhc3RXZWVrID0gd2Vla3NbbGFzdFdlZWtJbmRleF07XHJcbiAgICBpZiAoY3VycmVudFdlZWtJbmRleCAhPT0gbGFzdFdlZWtJbmRleCkge1xyXG4gICAgICBjdXJyZW50V2Vla0luZGV4ID0gYXJjaGl2ZVdlZWtzLmNoaWxkcmVuLmxlbmd0aCAtIDE7XHJcbiAgICAgIGN1cnJlbnRXZWVrLmNsYXNzTmFtZSA9ICd3ZWVrIHdlZWstLWpzIHdlZWstLXNsaWRlLW91dC10by1sZWZ0JztcclxuICAgICAgbGFzdFdlZWsuY2xhc3NOYW1lID0gJ3dlZWsgd2Vlay0tanMgd2Vlay0tdmlzaWJsZSB3ZWVrLS1zbGlkZS1pbi1mcm9tLXJpZ2h0JztcclxuICAgIH1cclxuICAgIGhhbmRsZUFyY2hpdmVMYXN0RW50cnkoKTtcclxuICAgIHNldEN1cnJlbnRXZWVrSGVpZ2h0KCk7XHJcbiAgfVxyXG59XHJcbi8vIEYxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEFESlVTVCBMQVNUIElURU0gT0YgTElTVCBcclxuXHJcbmNvbnN0IGhhbmRsZUFyY2hpdmVMYXN0RW50cnkgPSAoKSA9PiB7XHJcblxyXG4gIGNvbnN0IGVudHJpZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZW50cnktLWpzJyk7XHJcbiAgY29uc3QgbGFzdEVudHJ5ID0gZW50cmllc1tlbnRyaWVzLmxlbmd0aCAtIDFdO1xyXG4gIGNvbnN0IGxhc3RFbnRyeVZhbHVlTm9kZSA9IGxhc3RFbnRyeS5xdWVyeVNlbGVjdG9yKCcuZW50cnlfX3ZhbHVlLS1qcycpO1xyXG5cclxuICBpZiAoZW50cmllcy5sZW5ndGggPiAxKSB7XHJcbiAgICBsYXN0RW50cnkuaW5zZXJ0QmVmb3JlKHJlbW92ZUVudHJ5QnV0dG9uLCBsYXN0RW50cnlWYWx1ZU5vZGUpO1xyXG4gICAgbGFzdEVudHJ5LmNsYXNzTGlzdC5hZGQoJ2VudHJ5LS1sYXN0Jyk7XHJcbiAgfVxyXG59XHJcbi8vIEYxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBSRU1PVkUgTEFTVCBJVEVNIDw8IFNIT1cgQVJDSElWRSBcclxuXHJcbmNvbnN0IHJlbW92ZUxhc3RFbnRyeSA9IChlKSA9PiB7XHJcblxyXG4gIGNvbnN0IHNlbGYgPSBlLmtleUNvZGUgfHwgZS4gdGFyZ2V0O1xyXG4gIGNvbnN0IGxhc3RFbnRyeUluZGV4ID0gaHlkcmFwcEFycmF5Lmxlbmd0aCAtIDE7XHJcbiAgY29uc3Qge2RheSwga2V5fSA9IGh5ZHJhcHBBcnJheVtsYXN0RW50cnlJbmRleF07XHJcbiAgY29uc3QgbGFzdEVudHJ5Tm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbnRyeS0tanMnKVtsYXN0RW50cnlJbmRleF07XHJcblxyXG4gIGlmIChzZWxmID09PSAxMDkgfHwgc2VsZiA9PT0gcmVtb3ZlRW50cnlCdXR0b24pIHtcclxuXHJcbiAgICBpZiAoaHlkcmFwcEFycmF5Lmxlbmd0aCA+IDEpIHtcclxuXHJcbiAgICAgIGh5ZHJhcHBBcnJheS5wb3AoKTtcclxuICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcclxuICAgICAgbGFzdEVudHJ5RGF0ZS5zZXREYXRlKGxhc3RFbnRyeURhdGUuZ2V0RGF0ZSgpICsgMSk7XHJcbiAgICAgIGxhc3RFbnRyeU5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsYXN0RW50cnlOb2RlKTtcclxuXHJcbiAgICAgIC8vIHJlbW92aW5nIGxhc3Qgd2VlayBzZWN0aW9uIGFmdGVyIGRlbGV0aW5nIGxhc3QgZGF5IG9mIHRoYXQgd2Vla1xyXG4gICAgICBpZiAoZGF5ID09PSAnbW9uZGF5Jykge1xyXG4gICAgICAgIGNvbnN0IHdlZWtUb1JlbW92ZSA9IGFyY2hpdmVXZWVrcy5sYXN0RWxlbWVudENoaWxkO1xyXG4gICAgICAgIGNvbnN0IGlmVmlzaWJsZSA9IHdlZWtUb1JlbW92ZS5jbGFzc0xpc3QuY29udGFpbnMoJ3dlZWstLXZpc2libGUnKTtcclxuICAgICAgICBhcmNoaXZlV2Vla3MucmVtb3ZlQ2hpbGQoYXJjaGl2ZVdlZWtzLmxhc3RFbGVtZW50Q2hpbGQpO1xyXG4gICAgICAgIGNvbnN0IGxhc3RXZWVrID0gYXJjaGl2ZVdlZWtzLmxhc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICAgICAgY29uc3QgbGFzdFdlZWtMaXN0ID0gbGFzdFdlZWsubGFzdEVsZW1lbnRDaGlsZDtcclxuICAgICAgICBpZiAoaWZWaXNpYmxlKSB7XHJcbiAgICAgICAgICBsYXN0V2Vlay5jbGFzc05hbWUgPSAnd2VlayB3ZWVrLS1qcyB3ZWVrLS12aXNpYmxlIHdlZWstLXNsaWRlLWluLWZyb20tbGVmdCc7Y3VycmVudFdlZWtJbmRleC0tO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsYXN0V2Vla0xpc3QuYXBwZW5kQ2hpbGQoYWRkRW50cnlCdXR0b24pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBhZGQgcmVtb3ZlIGJ1dHRvbiBvbiBjdXJyZW50IGxhc3QgaXRlbVxyXG4gICAgICBoYW5kbGVBcmNoaXZlTGFzdEVudHJ5KCk7XHJcbiAgICAgIHVwZGF0ZVdlZWtIZWFkaW5nKCk7XHJcbiAgICAgIHNldEN1cnJlbnRXZWVrSGVpZ2h0KCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbi8vIEYyIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gSEFORExFIElURU0gRURJVCBcclxuXHJcbmNvbnN0IGhhbmRsZUl0ZW1FZGl0ID0gKGUpID0+IHtcclxuICBjb25zdCBpdGVtSW5kZXggPSBlLnRhcmdldC5pbmRleDtcclxuXHJcbiAgY29uc3QgZW50cnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZW50cnktLWpzJylbaXRlbUluZGV4XTtcclxuICBjb25zdCBlbnRyeUhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbnRyeV9faGVhZGVyLS1qcycpW2l0ZW1JbmRleF07XHJcbiAgY29uc3QgZW50cnlWYWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lbnRyeV9fdmFsdWUtLWpzJylbaXRlbUluZGV4XTtcclxuICBjb25zdCBlZGl0U2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lZGl0aW9uLS1qcycpW2l0ZW1JbmRleF07XHJcbiAgY29uc3QgZGVjcmVhc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZWRpdGlvbl9fYnV0dG9uLS1qcy1kZWNyZWFzZScpW2l0ZW1JbmRleF07XHJcbiAgY29uc3QgaW5jcmVhc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZWRpdGlvbl9fYnV0dG9uLS1qcy1pbmNyZWFzZScpW2l0ZW1JbmRleF07XHJcbiAgY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVkaXRpb25fX2J1dHRvbi0tanMtY2FuY2VsJylbaXRlbUluZGV4XTtcclxuICBjb25zdCBzYXZlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVkaXRpb25fX2J1dHRvbi0tanMtc2F2ZScpW2l0ZW1JbmRleF07XHJcblxyXG4gIC8vIEYwIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBUT0dHTEUgSVRFTSBESVNQTEFZIDw8IEhBTkRMRSBJVEVNIEVESVQgXHJcblxyXG4gIGNvbnN0IHRvZ2dsZUl0ZW1EaXNwbGF5ID0gKCkgPT4ge1xyXG5cclxuICAgIGZvciAoY29uc3QgZWRpdEJ1dHRvbiBvZiBlZGl0U2VjdGlvbi5jaGlsZHJlbikge1xyXG4gICAgICBlZGl0QnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2VkaXRpb25fX2J1dHRvbi0tdmlzaWJsZScpO1xyXG4gICAgfVxyXG4gICAgZWRpdFNlY3Rpb24uY2xhc3NMaXN0LnRvZ2dsZSgnZWRpdGlvbi0tdmlzaWJsZScpO1xyXG4gICAgZW50cnkuY2xhc3NMaXN0LnRvZ2dsZSgnZW50cnktLWVkaXQtbW9kZScpO1xyXG4gICAgZW50cnlIZWFkZXIuY2xhc3NMaXN0LnRvZ2dsZSgnZW50cnlfX2hlYWRlci0tZWRpdC1tb2RlJyk7XHJcblxyXG4gICAgaXRlbUluZGV4ID09PSBoeWRyYXBwQXJyYXkubGVuZ3RoIC0gMVxyXG4gICAgPyByZW1vdmVFbnRyeUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdlbnRyeV9fcmVtb3ZlLS1oaWRkZW4nKVxyXG4gICAgOiBmYWxzZTtcclxuICB9XHJcbiAgLy8gRjEgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRVhJVCBFRElUIE1PREUgPDwgSEFORExFIElURU0gRURJVCBcclxuXHJcbiAgY29uc3QgZXhpdEVkaXRNb2RlID0gKCkgPT4ge1xyXG4gICAgY29uc3Qge3ZhbHVlLCBpZH0gPSBoeWRyYXBwQXJyYXlbaXRlbUluZGV4XTtcclxuICAgIFxyXG4gICAgdG9nZ2xlSXRlbURpc3BsYXkoKTtcclxuICAgIGVudHJ5VmFsdWUudGV4dENvbnRlbnQgPSB2YWx1ZTtcclxuICAgIHNldEluZGljYXRvcnMoaWQsIHZhbHVlKTtcclxuXHJcbiAgICBhcmNoaXZlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlRWRpdGlvbik7XHJcbiAgICBhcmNoaXZlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVFZGl0aW9uKTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgc2xpZGVXZWVrKTtcclxuICB9XHJcbiAgLy8gRjEgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gSEFORExFIEVESVRJT04gPDwgSEFORExFIElURU0gRURJVCBcclxuXHJcbiAgY29uc3QgaGFuZGxlRWRpdGlvbiA9IChlKSA9PiB7XHJcbiAgICBjb25zdCBzZWxmID0gZS5rZXlDb2RlIHx8IGUudGFyZ2V0O1xyXG4gICAgbGV0IGRheVZhbHVlID0gcGFyc2VJbnQoZW50cnlWYWx1ZS50ZXh0Q29udGVudCk7XHJcbiAgICBjb25zdCBnbGFzc0NvdW50ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2xhc3NfX2NvdW50ZXItLWpzJyk7XHJcblxyXG4gICAgY29uc3Qge2tleSwgaWR9ID0gaHlkcmFwcEFycmF5W2l0ZW1JbmRleF07XHJcblxyXG4gICAgc3dpdGNoIChzZWxmKSB7XHJcblxyXG4gICAgICBjYXNlIDQwOlxyXG4gICAgICBjYXNlIGRlY3JlYXNlQnV0dG9uOlxyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBkYXlWYWx1ZSA+IDAgPyBkYXlWYWx1ZS0tIDogZmFsc2U7XHJcbiAgICAgICAgZW50cnlWYWx1ZS50ZXh0Q29udGVudCA9IGRheVZhbHVlO1xyXG4gICAgICAgIHNldEluZGljYXRvcnMoaWQsIGRheVZhbHVlKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIFxyXG4gICAgICBjYXNlIDM4OlxyXG4gICAgICBjYXNlIGluY3JlYXNlQnV0dG9uOlxyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBkYXlWYWx1ZSA8IGNvdW50ZXJNYXhWYWx1ZSA/IGRheVZhbHVlKysgOiBmYWxzZTtcclxuICAgICAgICBlbnRyeVZhbHVlLnRleHRDb250ZW50ID0gZGF5VmFsdWU7XHJcbiAgICAgICAgc2V0SW5kaWNhdG9ycyhpZCwgZGF5VmFsdWUpO1xyXG4gICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgMjc6XHJcbiAgICAgIGNhc2UgY2FuY2VsQnV0dG9uOlxyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBleGl0RWRpdE1vZGUoKTtcclxuICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIDEzOlxyXG4gICAgICBjYXNlIHNhdmVCdXR0b246XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgZGF5VmFsdWUpO1xyXG4gICAgICAgIC8vIHNldHRlciBmdW5jdGlvblxyXG4gICAgICAgIGh5ZHJhcHBBcnJheVtpdGVtSW5kZXhdLnZhbHVlID0ga2V5O1xyXG4gICAgICAgIGdsYXNzQ291bnRlci50ZXh0Q29udGVudCA9IGh5ZHJhcHBBcnJheVswXS52YWx1ZTtcclxuICAgICAgICBleGl0RWRpdE1vZGUoKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEZVTkNUSU9OIENBTExTIDw8IEhBTkRMRSBJVEVNIEVESVQgXHJcblxyXG4gIHRvZ2dsZUl0ZW1EaXNwbGF5KCk7XHJcbiAgYXJjaGl2ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUVkaXRpb24pO1xyXG4gIGFyY2hpdmUuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUVkaXRpb24pO1xyXG4gIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgc2xpZGVXZWVrKTtcclxufVxyXG4vLyBGMiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIE9GIEhBTkRMRSBJVEVNIEVESVQgXHJcblxyXG4vKlxyXG4jIyAgICAgIyMgICAgIyMjICAgICMjIyMjIyMjICAjIyMjICAgICMjIyAgICAjIyMjIyMjIyAgIyMgICAgICAgIyMjIyMjIyMgICMjIyMjI1xyXG4jIyAgICAgIyMgICAjIyAjIyAgICMjICAgICAjIyAgIyMgICAgIyMgIyMgICAjIyAgICAgIyMgIyMgICAgICAgIyMgICAgICAgIyMgICAgIyNcclxuIyMgICAgICMjICAjIyAgICMjICAjIyAgICAgIyMgICMjICAgIyMgICAjIyAgIyMgICAgICMjICMjICAgICAgICMjICAgICAgICMjXHJcbiMjICAgICAjIyAjIyAgICAgIyMgIyMjIyMjIyMgICAjIyAgIyMgICAgICMjICMjIyMjIyMjICAjIyAgICAgICAjIyMjIyMgICAgIyMjIyMjXHJcbiAjIyAgICMjICAjIyMjIyMjIyMgIyMgICAjIyAgICAjIyAgIyMjIyMjIyMjICMjICAgICAjIyAjIyAgICAgICAjIyAgICAgICAgICAgICAjI1xyXG4gICMjICMjICAgIyMgICAgICMjICMjICAgICMjICAgIyMgICMjICAgICAjIyAjIyAgICAgIyMgIyMgICAgICAgIyMgICAgICAgIyMgICAgIyNcclxuICAgIyMjICAgICMjICAgICAjIyAjIyAgICAgIyMgIyMjIyAjIyAgICAgIyMgIyMjIyMjIyMgICMjIyMjIyMjICMjIyMjIyMjICAjIyMjIyNcclxuKi9cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFZBUklBQkxFUyBcclxuLy8gQVBQXHJcbmNvbnN0IGFwcENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHBfX2NvbnRhaW5lci0tanMnKTtcclxuY29uc3QgYWRkR2xhc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwX19idXR0b24tLWpzLWFkZCcpO1xyXG5jb25zdCByZW1vdmVHbGFzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHBfX2J1dHRvbi0tanMtcmVtb3ZlJyk7XHJcbmNvbnN0IGNvdW50ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2xhc3NfX2NvdW50ZXItLWpzJyk7XHJcbmNvbnN0IGNvdW50ZXJNYXhWYWx1ZSA9IDk5O1xyXG4vLyBOQVZJR0FUSU9OXHJcbmNvbnN0IGJ1cmdlckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXJnZXItYnV0dG9uLS1qcycpO1xyXG5jb25zdCBtb2JpbGVNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vYmlsZS1tZW51LS1qcycpO1xyXG5jb25zdCBtb2JpbGVNZW51QXJjaGl2ZVNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9iaWxlLW1lbnVfX3NlY3Rpb24tLWpzLWFyY2hpdmUnKTtcclxuY29uc3QgbW9iaWxlTWVudVN0YXRzU2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2JpbGUtbWVudV9fc2VjdGlvbi0tanMtc3RhdHMnKTtcclxuY29uc3QgbW9iaWxlTWVudVNldHRpbmdzU2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2JpbGUtbWVudV9fc2VjdGlvbi0tanMtc2V0dGluZ3MnKTtcclxuLy8gQVJDSElWRVxyXG5jb25zdCBhcmNoaXZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFyY2hpdmUtLWpzJyk7XHJcbmNvbnN0IGFyY2hpdmVXZWVrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcmNoaXZlX193ZWVrcy0tanMnKTtcclxuY29uc3QgYXJjaGl2ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZpZ2F0aW9uX19idXR0b24tLWpzLWFyY2hpdmUnKTtcclxuY29uc3QgcHJldldlZWtCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJjaGl2ZV9fYnV0dG9uLS1qcy1wcmV2Jyk7XHJcbmNvbnN0IG5leHRXZWVrQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFyY2hpdmVfX2J1dHRvbi0tanMtbmV4dCcpO1xyXG5jb25zdCBhZGRFbnRyeUJ1dHRvbiA9IGNyZWF0ZUFkZEVudHJ5QnV0dG9uKCk7XHJcbmNvbnN0IHJlbW92ZUVudHJ5QnV0dG9uID0gY3JlYXRlUmVtb3ZlRW50cnlCdXR0b24oKTtcclxubGV0IGN1cnJlbnRXZWVrSW5kZXggPSAwO1xyXG4vLyBORVcgRU5UUllcclxuY29uc3QgbmV3RW50cnlNb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy1lbnRyeS0tanMnKTtcclxuY29uc3QgbmV3RW50cnlWYWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctZW50cnlfX3ZhbHVlLS1qcycpO1xyXG5jb25zdCBuZXdFbnRyeURlY3JlYXNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy1lbnRyeV9fYnV0dG9uLS1qcy1kZWNyZWFzZScpO1xyXG5jb25zdCBuZXdFbnRyeUluY3JlYXNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy1lbnRyeV9fYnV0dG9uLS1qcy1pbmNyZWFzZScpO1xyXG5jb25zdCBuZXdFbnRyeUNhbmNlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctZW50cnlfX2J1dHRvbi0tanMtY2FuY2VsJyk7XHJcbmNvbnN0IG5ld0VudHJ5U2F2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctZW50cnlfX2J1dHRvbi0tanMtc2F2ZScpO1xyXG4vLyBTVEFUU1xyXG5jb25zdCBzdGF0c0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZpZ2F0aW9uX19idXR0b24tLWpzLXN0YXRzJyk7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRlVOQ1RJT04gQ0FMTFMgXHJcblxyXG5oYW5kbGVEYXRhKCk7XHJcbnNldEFyY2hpdmVET00oKTtcclxudXBkYXRlV2Vla0hlYWRpbmcoKTtcclxuXHJcbi8vdG9nZ2xlTW9iaWxlTWVudShidXJnZXJCdXR0b24pOyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICEgRk9SIFRFU1RTIE9OTFlcclxuLy9lbnRlck5ld0VudHJ5VmFsdWUoMTA3KTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAhIEZPUiBURVNUUyBPTkxZXHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBWQVJJQUJMRVMgXHJcblxyXG5sZXQgZWRpdEJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZWRpdGlvbl9fYnV0dG9uLS1qcy1lZGl0Jyk7XHJcbmxldCBlbnRyaWVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVudHJ5LS1qcycpO1xyXG5jb25zdCBhZGROZXdEYXlCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZW50cnlfX2J1dHRvbi0tanMtYWRkJyk7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFVkVOVCBMSVNURU5FUlMgXHJcblxyXG5hcHBDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB1cGRhdGVDb3VudGVyKTtcclxuYnVyZ2VyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlTW9iaWxlTWVudSk7XHJcbm1vYmlsZU1lbnUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVBcmNoaXZlKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n")}]);