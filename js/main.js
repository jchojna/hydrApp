!function(t){var c={};function e(l){if(c[l])return c[l].exports;var n=c[l]={i:l,l:!1,exports:{}};return t[l].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=c,e.d=function(t,c,l){e.o(t,c)||Object.defineProperty(t,c,{enumerable:!0,get:l})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,c){if(1&c&&(t=e(t)),8&c)return t;if(4&c&&"object"==typeof t&&t&&t.__esModule)return t;var l=Object.create(null);if(e.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:t}),2&c&&"string"!=typeof t)for(var n in t)e.d(l,n,function(c){return t[c]}.bind(null,n));return l},e.n=function(t){var c=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(c,"a",c),c},e.o=function(t,c){return Object.prototype.hasOwnProperty.call(t,c)},e.p="",e(e.s=0)}([function(module,exports,__webpack_require__){"use strict";eval("\r\n\r\n/////////////////////////////////////////////////////////////// SERVICE WORKER \r\n\r\nif ('serviceWorker' in navigator) {\r\n  window.addEventListener('load', function() {\r\n    navigator.serviceWorker.register('serviceworker.js').then(function(registration) {\r\n      // Registration was successful\r\n      //console.log('ServiceWorker registration successful with scope: ', registration.scope);\r\n    }, function(err) {\r\n      // registration failed :(\r\n      console.log('ServiceWorker registration failed: ', err);\r\n    });\r\n  });\r\n}\r\n\r\n///////////////////////////////////////////////////////////// GLOBAL VARIABLES \r\n\r\nconst hydrappArray = [];\r\nconst lastEntryDate = new Date();\r\n\r\nlet indicators = '';\r\nfor (let i = 0; i < 8; i++) {\r\n  indicators += `\r\n  <svg class=\"indicator__svg indicator__svg--emo-${i+1} indicator__svg--js-${i}\">\r\n    <use href=\"assets/svg/icons.svg#emoticon-${i}\"></use>\r\n  </svg>`\r\n}\r\n\r\nclass Entry {\r\n  constructor(key, height) {                                                // ! IF HEIGHT NEEDED ?\r\n    this.key = key;\r\n    this.getValue = key;\r\n    this.getTitle = key;\r\n    this.getID = key;\r\n    this.itemHeight = height;\r\n\r\n    this.html = `\r\n      <li class=\"archive__item archive__item--js ${this.key}\">\r\n        <p class=\"archive__date\">${this.getTitle}</p>\r\n        <p class=\"archive__value archive__value--js\">\r\n          ${this.getValue}\r\n        </p>\r\n        <div class=\"edition edition--js\">\r\n          <button class=\"button edition__button edition__button--visible edition__button--edit edition__button--js-edit\">\r\n            <svg class=\"edition__svg edition__svg--edit\">\r\n              <use href=\"assets/svg/icons.svg#edit-mode\"></use>\r\n            </svg>\r\n          </button>\r\n          <button class=\"button edition__button edition__button--decrease edition__button--js-decrease\">\r\n            <svg class=\"edition__svg edition__svg--decrease\">\r\n              <use href=\"assets/svg/icons.svg#left-arrow\"></use>\r\n            </svg>\r\n          </button>\r\n          <button class=\"button edition__button edition__button--increase edition__button--js-increase\">\r\n            <svg class=\"edition__svg edition__svg--increase\">\r\n              <use href=\"assets/svg/icons.svg#right-arrow\"></use>\r\n            </svg>\r\n          </button>\r\n          <button class=\"button edition__button edition__button--cancel edition__button--js-cancel\">\r\n            <svg class=\"edition__svg edition__svg--cancel\">\r\n              <use href=\"assets/svg/icons.svg#back-arrow\"></use>\r\n            </svg>\r\n          </button>\r\n          <button class=\"button edition__button edition__button--save edition__button--js-save\">\r\n            <svg class=\"edition__svg edition__svg--save\">\r\n              <use href=\"assets/svg/icons.svg#save-icon\"></use>\r\n            </svg>\r\n          </button>\r\n        </div>\r\n        <div class=\"indicator indicator--js-${this.getID}\">\r\n          ${indicators}\r\n        </div>\r\n      </li>\r\n    `\r\n  }\r\n\r\n  get getValue() {\r\n    return this.value;\r\n  }\r\n  set getValue(key) {\r\n    this.value = localStorage.getItem(key);\r\n  }\r\n  get getTitle() {\r\n    return this.title;\r\n  }\r\n  set getTitle(date) {\r\n    this.title = date.replace('hydrApp-','').split('-').reverse().join(' ');\r\n  }\r\n  get getID() {\r\n    return this.ID;\r\n  }\r\n  set getID(date) {\r\n    this.ID = date.replace('hydrApp-','').split('-').reverse().join('');\r\n  }\r\n  get totalHeight() {\r\n    return this._totalHeight;\r\n  }\r\n  set totalHeight(amount) {\r\n    this._totalHeight = amount * this.itemHeight;\r\n  }\r\n}\r\n\r\n//////////////////////////////////////////////////////////////////// FUNCTIONS \r\n\r\n// F1 //////////////////////////////////////////////// CREATE HYDRAPP DATE KEY \r\n\r\nconst setDateKey = (obj) => {\r\n  const prefix = 'hydrApp-';\r\n  const date = obj.toISOString().slice(0,10);\r\n  return prefix.concat(date);\r\n}\r\n// F1 ///////////////////////////////// CREATE KEY VALUE PAIR IN LOCAL STORAGE \r\n\r\nconst setNewKeyValue = (key, value) => {\r\n  if ( !localStorage.getItem(key) ) {\r\n    localStorage.setItem(key, value);\r\n  };\r\n}\r\n// F1 ///////////////////////////// CREATE ARRAY OF HYDRAPP LOCAL STORAGE KEYS \r\n\r\nconst getHydrappKeys = () => {\r\n  const regex = /hydrApp-/;\r\n  return Object\r\n  .keys(localStorage)\r\n  .filter(key => regex.test(key))\r\n  .sort()\r\n  .reverse();\r\n}\r\n// F1 ////////////////////////////////////////////////////// GET OFFSETED DATE \r\n\r\nconst getOffsetedDate = () => {\r\n  const timeZoneOffset = (new Date()).getTimezoneOffset() * 60000;\r\n  return (new Date(Date.now() - timeZoneOffset));\r\n}\r\n// F1 /////////////////////////////////////////////////// GET OFFSETED DATE OF \r\n\r\nconst getOffsetedDateOf = (date) => {\r\n  const timeZoneOffset = (new Date()).getTimezoneOffset() * 60000;\r\n  return new Date(date - timeZoneOffset);\r\n}\r\n// F1 //////////////////////////////////////////////////////////// SET COUNTER \r\n\r\nconst setLocalStorage = () => {\r\n  const offsetedDate = getOffsetedDate();                           // ! OFFSETED OR NORMAL ???\r\n  let dateKey = setDateKey(offsetedDate);\r\n  const hydrappKeys = getHydrappKeys();\r\n  const oldestKey = hydrappKeys[hydrappKeys.length - 1];\r\n\r\n  setNewKeyValue(dateKey, 0);\r\n  \r\n  if ( hydrappKeys.length > 2 ) { // autocomplete missing keys in localstorage\r\n    let limit = 0; // for tests to avoid loop error                            // ! TO REFACTOR\r\n\r\n    while (setDateKey(offsetedDate) !== oldestKey && limit < 99) {\r\n      offsetedDate.setDate(offsetedDate.getDate() - 1);\r\n      const prevDateKey = setDateKey(offsetedDate);\r\n      setNewKeyValue(prevDateKey, 0);\r\n      limit++;\r\n    }\r\n  }\r\n  counter.innerHTML = localStorage.getItem(dateKey);\r\n}\r\n// F1 ///////////////////////////////////////////////////////// UPDATE COUNTER \r\n\r\nconst updateCounter = (e) => {\r\n  const self = e.target;\r\n  const offsetedDate = getOffsetedDate();\r\n  const key = setDateKey(offsetedDate);\r\n  const value = parseInt(localStorage.getItem(key));\r\n  let newValue;\r\n\r\n  if (self === addGlass || self === removeGlass) {\r\n    switch (self) {\r\n      case addGlass:\r\n        value < counterMaxValue ? newValue = value + 1 : newValue = counterMaxValue;\r\n        break;\r\n      case removeGlass:\r\n        value > 0 ? newValue = value - 1 : newValue = 0;\r\n        break;\r\n    }\r\n    localStorage.setItem(key, newValue);\r\n    counter.innerHTML = newValue;\r\n  }\r\n}\r\n// F1 //////////////////////////////////////////////////////////// SET ARCHIVE \r\n\r\nconst setArchive = () => {\r\n  const hydrappKeys = getHydrappKeys();\r\n  const emptyArchive = `\r\n  <li class=\"archive__item archive__item--empty\">No history yet...</li>\r\n  `;\r\n  archiveList.innerHTML += emptyArchive;\r\n\r\n  if (hydrappKeys.length) {\r\n\r\n    for (let i = 0; i < hydrappKeys.length; i++) {\r\n\r\n      const newEntry = new Entry(hydrappKeys[i], 0);\r\n      newEntry.totalHeight = i;\r\n      archiveList.innerHTML += newEntry.html;\r\n      lastEntryDate.setDate(lastEntryDate.getDate() - 1);\r\n      setIndicators(newEntry.ID, newEntry.value);\r\n      hydrappArray.push(newEntry);\r\n    }\r\n  }\r\n  console.log('hydrappArray', hydrappArray);\r\n}\r\n// F1 ///////////////////////////////////////////////////////// SET INDICATORS \r\n\r\nconst setIndicators = (id, value) => {\r\n\r\n  value > 7 ? value = 7 : false;\r\n\r\n  const indicators = document.querySelector(`.indicator--js-${id}`).children;\r\n  const indicator = document.querySelector(`.indicator--js-${id} .indicator__svg--js-${value}`);\r\n  \r\n  for (const indicator of indicators) {\r\n    indicator.classList.contains('indicator__svg--visible')\r\n    ? indicator.classList.remove('indicator__svg--visible')\r\n    : false;\r\n  }\r\n  indicator.classList.add('indicator__svg--visible');\r\n}\r\n// F1 /////////////////////////////////////////////////////////// SHOW ARCHIVE \r\nconst showArchive = () => {\r\n\r\n  // F2 ///////////////////////////////////////////////////// HANDLE ITEM EDIT \r\n\r\n  const handleItemEdit = (e) => {\r\n    const itemIndex = e.target.index;\r\n    const archiveItem = document.querySelectorAll('.archive__item--js')[itemIndex];\r\n    const editSection = document.querySelectorAll('.edition--js')[itemIndex];\r\n    const decreaseButton = document.querySelectorAll('.edition__button--js-decrease')[itemIndex];\r\n    const increaseButton = document.querySelectorAll('.edition__button--js-increase')[itemIndex];\r\n    const cancelButton = document.querySelectorAll('.edition__button--js-cancel')[itemIndex];\r\n    const saveButton = document.querySelectorAll('.edition__button--js-save')[itemIndex];\r\n    const archiveValue = document.querySelectorAll('.archive__value--js')[itemIndex];\r\n\r\n    // F3 //////////////////////////// TOGGLE ITEM DISPLAY << HANDLE ITEM EDIT \r\n\r\n    const toggleItemDisplay = () => {\r\n      archive.classList.toggle('archive--on-top');\r\n      archiveItem.classList.toggle('archive__item--on-top');\r\n      pageOverlay.classList.toggle('archive__overlay--visible');\r\n      removeItemButton.classList.remove('remove-button--visible');\r\n      \r\n      for (const editButton of editSection.children) {\r\n        editButton.classList.toggle('edition__button--visible');\r\n      }\r\n      editSection.classList.toggle('edition--visible');\r\n    }\r\n    // F3 ///////////////////////////////// EXIT EDIT MODE << HANDLE ITEM EDIT \r\n\r\n    const exitEditMode = () => {\r\n      toggleItemDisplay();\r\n      archiveValue.textContent = hydrappArray[itemIndex].value;\r\n      setIndicators(hydrappArray[itemIndex].ID, hydrappArray[itemIndex].value);\r\n      removeItemButton.classList.add('remove-button--visible');\r\n\r\n      archive.removeEventListener('click', handleEdition);\r\n      archive.removeEventListener('keydown', handleEdition);\r\n    }\r\n    // F3 ///////////////////////////////// HANDLE EDITION << HANDLE ITEM EDIT \r\n\r\n    const handleEdition = (e) => {\r\n      const self = e.keyCode || e.target;\r\n      let value = parseInt(archiveValue.textContent);\r\n\r\n      switch (self) {\r\n\r\n        case 37:\r\n        case decreaseButton:\r\n          e.preventDefault();\r\n          value > 0 ? value-- : false;\r\n          archiveValue.textContent = value;\r\n          setIndicators(hydrappArray[itemIndex].ID, value);\r\n        break;\r\n        \r\n        case 39:\r\n        case increaseButton:\r\n          e.preventDefault();\r\n          value < counterMaxValue ? value++ : false;\r\n          archiveValue.textContent = value;\r\n          setIndicators(hydrappArray[itemIndex].ID, value);\r\n        break;\r\n\r\n        case 27:\r\n        case pageOverlay:\r\n        case cancelButton:\r\n          e.preventDefault();\r\n          exitEditMode();\r\n        break;\r\n\r\n        case 13:\r\n        case saveButton:\r\n          e.preventDefault();\r\n          hydrappArray[itemIndex].value = value;\r\n          localStorage.setItem(hydrappArray[itemIndex].key, value);\r\n          exitEditMode();\r\n        break;\r\n      }\r\n    }\r\n    /////////////////////////////////////// FUNCTION CALLS << HANDLE ITEM EDIT \r\n\r\n    toggleItemDisplay();\r\n    archive.addEventListener('click', handleEdition);\r\n    archive.addEventListener('keydown', handleEdition);\r\n\r\n  } // F2 //////////////////////////////////////////// END OF HANDLE ITEM EDIT \r\n  \r\n  // F2 //////////////////////////////////////////// CREATE REMOVE ITEM BUTTON \r\n  \r\n  const createRemoveItemButton = () => {\r\n  \r\n    const removeItemButton = document.createElement('button');\r\n    removeItemButton.className = 'button remove-button remove-button--visible remove-button--js';\r\n    removeItemButton.innerHTML = `\r\n    <svg class=\"remove-button__svg\">\r\n      <use href=\"assets/svg/icons.svg#remove-icon\"></use>\r\n    </svg>\r\n    `\r\n\r\n    removeItemButton.addEventListener('click', removeLastItem);\r\n\r\n    return removeItemButton;\r\n  }\r\n  // F2 ///////////////////////////////////////////// ADJUST LAST ITEM OF LIST \r\n  \r\n  const handleArchiveLastItem = () => {\r\n  \r\n    const lastItem = archiveList.lastElementChild;\r\n    const lastItemValueNode = lastItem.querySelector('.archive__value--js');\r\n\r\n    if (!removeItemButton) {\r\n      removeItemButton = createRemoveItemButton();\r\n    }    \r\n\r\n    const previousItem = archiveList.lastElementChild.previousElementSibling;\r\n    const previousRemoveButton = previousItem.querySelector('.remove-button--js');\r\n    const lastRemoveButton = lastItem.querySelector('.remove-button--js');\r\n\r\n    if (previousRemoveButton) {\r\n      previousItem.classList.remove('archive__item--removable');\r\n      previousItem.removeChild(previousRemoveButton);\r\n    }\r\n\r\n    if (!lastRemoveButton) {\r\n\r\n      lastItem.classList.add('archive__item--removable');\r\n      lastItem.insertBefore(removeItemButton, lastItemValueNode);\r\n    }\r\n  }\r\n  \r\n  // F2 //////////////////////////////////////////// LOAD MORE << SHOW ARCHIVE \r\n\r\n  const loadMoreItems = () => {\r\n    const archiveItems = document.querySelectorAll('.archive__item--js');\r\n    const archiveListHeight = archiveList.clientHeight;\r\n    let viewportHeight = 0;\r\n\r\n    if (hydrappArray.length === 1) {\r\n      archiveList.firstElementChild.classList.add('archive__item--visible');\r\n\r\n    } else if (hydrappArray.length > 1) {\r\n\r\n      for (let i = 1; i < archiveItems.length; i++) {\r\n\r\n        const item = archiveItems[i];\r\n\r\n        if (!item.classList.contains('archive__item--visible')) {\r\n\r\n          item.classList.add('archive__item--visible');\r\n          viewportHeight += item.offsetHeight;\r\n\r\n          hydrappArray[i].itemHeight = item.offsetHeight;\r\n          hydrappArray[i].totalHeight = i;\r\n          archiveList.scrollTop = hydrappArray[i].totalHeight;\r\n          \r\n          if (viewportHeight > archiveListHeight - item.offsetHeight) {\r\n            \r\n            archiveList.style.height = viewportHeight + 'px';\r\n            loadMoreButton.classList.add('archive__button--visible');\r\n            break;\r\n          }\r\n        } else {\r\n          loadMoreButton.classList.remove('archive__button--visible');\r\n        }\r\n      }\r\n      handleArchiveLastItem();\r\n    }\r\n  }\r\n\r\n  // F2 ///////////////////////////////////////// ADD NEW ITEM << SHOW ARCHIVE \r\n\r\n  const addNewItem = () => {\r\n\r\n    const newEntryKey = setDateKey(getOffsetedDateOf(lastEntryDate));\r\n    setNewKeyValue(newEntryKey, 0);\r\n    const archiveListHeight = archiveList.clientHeight;\r\n    let viewportHeight = 0;\r\n\r\n    const newEntry = new Entry(newEntryKey);\r\n    hydrappArray.push(newEntry);\r\n    lastEntryDate.setDate(lastEntryDate.getDate() - 1);\r\n    const currentIndex = hydrappArray.length - 1;\r\n    archiveList.insertAdjacentHTML('beforeend', hydrappArray[currentIndex].html);\r\n    setIndicators(hydrappArray[currentIndex].ID, hydrappArray[currentIndex].value);\r\n    \r\n    handleArchiveLastItem();\r\n    \r\n    for (let i = 2; i < archiveList.children.length; i++) {\r\n      const item = archiveList.children[i];\r\n      if (!item.classList.contains('archive__item--visible')) {\r\n        item.classList.add('archive__item--visible');\r\n      }\r\n      if (viewportHeight <= archiveListHeight - item.offsetHeight) {\r\n        viewportHeight += item.offsetHeight;\r\n      }\r\n    }\r\n    \r\n    if (loadMoreButton.classList.contains('archive__button--visible')) {\r\n      loadMoreButton.classList.remove('archive__button--visible');\r\n    }\r\n\r\n    if (currentIndex === 1) {\r\n      archiveList.firstElementChild.classList.remove('archive__item--visible');\r\n    } \r\n\r\n    hydrappArray[currentIndex].itemHeight = archiveList.lastElementChild.offsetHeight;\r\n    hydrappArray[currentIndex].totalHeight = currentIndex;\r\n\r\n    if (hydrappArray[currentIndex].totalHeight > archiveList.clientHeight - hydrappArray[currentIndex].itemHeight) {\r\n      archiveList.style.height = viewportHeight;\r\n    }\r\n\r\n    archiveList.scrollTop = hydrappArray[currentIndex].totalHeight;\r\n\r\n    editButtons = document.querySelectorAll('.edition__button--js-edit');\r\n    const newEditButton = editButtons[currentIndex];\r\n    newEditButton.index = currentIndex;\r\n    newEditButton.addEventListener('click', handleItemEdit);    \r\n  }\r\n  // F2 ///////////////////////////////////// REMOVE LAST ITEM << SHOW ARCHIVE \r\n\r\n  const removeLastItem = () => {\r\n\r\n    const archiveListHeight = archiveList.clientHeight;\r\n\r\n    if (hydrappArray.length > 1) {\r\n      \r\n      const lastItemKey = hydrappArray[hydrappArray.length - 1].key;\r\n      hydrappArray.pop();\r\n      localStorage.removeItem(lastItemKey);\r\n      lastEntryDate.setDate(lastEntryDate.getDate() + 1);\r\n      archiveList.removeChild(archiveList.lastElementChild);\r\n      const itemsTotalHeight = hydrappArray[hydrappArray.length - 1].totalHeight;\r\n\r\n      if (itemsTotalHeight <= archiveListHeight && itemsTotalHeight > 0) {\r\n        loadMoreButton.classList.remove('archive__button--visible');\r\n      }\r\n\r\n      if (hydrappArray.length === 1) {\r\n        archiveList.firstElementChild.classList.add('archive__item--visible');\r\n      }\r\n\r\n      handleArchiveLastItem();\r\n    }\r\n  }\r\n  // F2 //////////////////////////////////////// CLOSE ARCHIVE << SHOW ARCHIVE \r\n\r\n  const closeArchive = () => {\r\n    archive.classList.remove('archive--visible');\r\n    loadMoreButton.classList.remove('archive__button--hidden');\r\n\r\n    const archiveItems = document.querySelectorAll('.archive__item--js');\r\n    for (const archiveItem of archiveItems) {\r\n      archiveItem.classList.remove('archive__item--visible');\r\n    }\r\n\r\n    addNewButton.removeEventListener('click', addNewItem);\r\n    loadMoreButton.removeEventListener('click', loadMoreItems);\r\n    archiveButton.removeEventListener('click', closeArchive);\r\n\r\n    for (const editButton of editButtons) {\r\n      editButton.removeEventListener('click', handleItemEdit);\r\n    }\r\n\r\n    archiveButton.addEventListener('click', showArchive);\r\n  }\r\n  ////////////////////////////////////////////////// VARIABLES << SHOW ARCHIVE \r\n\r\n  let editButtons = document.querySelectorAll('.edition__button--js-edit');\r\n  let removeItemButton = document.querySelector('.remove-button--js');\r\n\r\n  ///////////////////////////////////////////// FUNCTION CALLS << SHOW ARCHIVE \r\n\r\n  archive.classList.add('archive--visible');\r\n  loadMoreItems();\r\n\r\n  //////////////////////////////////////////// EVENT LISTENERS << SHOW ARCHIVE \r\n\r\n  archiveButton.removeEventListener('click', showArchive);\r\n  archiveButton.addEventListener('click', closeArchive);\r\n  loadMoreButton.addEventListener('click', loadMoreItems);\r\n  addNewButton.addEventListener('click', addNewItem);\r\n\r\n  for (let i = 0; i < editButtons.length; i++) {\r\n    const editButton = editButtons[i];\r\n    editButton.index = i;\r\n    editButton.addEventListener('click', handleItemEdit);\r\n  }\r\n}\r\n// F1 //////////////////////////////////////////////////// END OF SHOW ARCHIVE \r\n\r\n//////////////////////////////////////////////////////////////////// VARIABLES \r\n\r\nconst appContainer = document.querySelector('.app__container--js');\r\nconst addGlass = document.querySelector('.app__button--js-add');\r\nconst removeGlass = document.querySelector('.app__button--js-remove');\r\nconst counter = document.querySelector('.glass__counter--js');\r\nconst counterMaxValue = 99;\r\n\r\nconst archive = document.querySelector('.archive--js');\r\nconst pageOverlay = document.querySelector('.archive__overlay--js');\r\nconst archiveList = document.querySelector('.archive__list--js');\r\nconst archiveButton = document.querySelector('.navigation__button--js-archive');\r\nconst loadMoreButton = document.querySelector('.archive__button--js-load-more');\r\nconst addNewButton = document.querySelector('.archive__button--add-new');\r\n\r\nconst statsButton = document.querySelector('.navigation__button--js-stats');\r\n\r\n/////////////////////////////////////////////////////////////// FUNCTION CALLS \r\n\r\nsetLocalStorage();\r\nsetArchive();\r\n\r\n////////////////////////////////////////////////////////////// EVENT LISTENERS \r\n\r\nappContainer.addEventListener('click', updateCounter);\r\narchiveButton.addEventListener('click', showArchive);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvanMvbWFpbi5qcz85MjkxIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBLG1EQUFtRCxJQUFJLHNCQUFzQixFQUFFO0FBQy9FLCtDQUErQyxFQUFFO0FBQ2pEO0FBQ0E7O0FBRUE7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1EQUFtRCxTQUFTO0FBQzVELG1DQUFtQyxjQUFjO0FBQ2pEO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLFdBQVc7QUFDekQsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7O0FBRUE7O0FBRUEs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Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gU0VSVklDRSBXT1JLRVIgXHJcblxyXG5pZiAoJ3NlcnZpY2VXb3JrZXInIGluIG5hdmlnYXRvcikge1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24oKSB7XHJcbiAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3Rlcignc2VydmljZXdvcmtlci5qcycpLnRoZW4oZnVuY3Rpb24ocmVnaXN0cmF0aW9uKSB7XHJcbiAgICAgIC8vIFJlZ2lzdHJhdGlvbiB3YXMgc3VjY2Vzc2Z1bFxyXG4gICAgICAvL2NvbnNvbGUubG9nKCdTZXJ2aWNlV29ya2VyIHJlZ2lzdHJhdGlvbiBzdWNjZXNzZnVsIHdpdGggc2NvcGU6ICcsIHJlZ2lzdHJhdGlvbi5zY29wZSk7XHJcbiAgICB9LCBmdW5jdGlvbihlcnIpIHtcclxuICAgICAgLy8gcmVnaXN0cmF0aW9uIGZhaWxlZCA6KFxyXG4gICAgICBjb25zb2xlLmxvZygnU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gZmFpbGVkOiAnLCBlcnIpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gR0xPQkFMIFZBUklBQkxFUyBcclxuXHJcbmNvbnN0IGh5ZHJhcHBBcnJheSA9IFtdO1xyXG5jb25zdCBsYXN0RW50cnlEYXRlID0gbmV3IERhdGUoKTtcclxuXHJcbmxldCBpbmRpY2F0b3JzID0gJyc7XHJcbmZvciAobGV0IGkgPSAwOyBpIDwgODsgaSsrKSB7XHJcbiAgaW5kaWNhdG9ycyArPSBgXHJcbiAgPHN2ZyBjbGFzcz1cImluZGljYXRvcl9fc3ZnIGluZGljYXRvcl9fc3ZnLS1lbW8tJHtpKzF9IGluZGljYXRvcl9fc3ZnLS1qcy0ke2l9XCI+XHJcbiAgICA8dXNlIGhyZWY9XCJhc3NldHMvc3ZnL2ljb25zLnN2ZyNlbW90aWNvbi0ke2l9XCI+PC91c2U+XHJcbiAgPC9zdmc+YFxyXG59XHJcblxyXG5jbGFzcyBFbnRyeSB7XHJcbiAgY29uc3RydWN0b3Ioa2V5LCBoZWlnaHQpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAhIElGIEhFSUdIVCBORUVERUQgP1xyXG4gICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICB0aGlzLmdldFZhbHVlID0ga2V5O1xyXG4gICAgdGhpcy5nZXRUaXRsZSA9IGtleTtcclxuICAgIHRoaXMuZ2V0SUQgPSBrZXk7XHJcbiAgICB0aGlzLml0ZW1IZWlnaHQgPSBoZWlnaHQ7XHJcblxyXG4gICAgdGhpcy5odG1sID0gYFxyXG4gICAgICA8bGkgY2xhc3M9XCJhcmNoaXZlX19pdGVtIGFyY2hpdmVfX2l0ZW0tLWpzICR7dGhpcy5rZXl9XCI+XHJcbiAgICAgICAgPHAgY2xhc3M9XCJhcmNoaXZlX19kYXRlXCI+JHt0aGlzLmdldFRpdGxlfTwvcD5cclxuICAgICAgICA8cCBjbGFzcz1cImFyY2hpdmVfX3ZhbHVlIGFyY2hpdmVfX3ZhbHVlLS1qc1wiPlxyXG4gICAgICAgICAgJHt0aGlzLmdldFZhbHVlfVxyXG4gICAgICAgIDwvcD5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwiZWRpdGlvbiBlZGl0aW9uLS1qc1wiPlxyXG4gICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ1dHRvbiBlZGl0aW9uX19idXR0b24gZWRpdGlvbl9fYnV0dG9uLS12aXNpYmxlIGVkaXRpb25fX2J1dHRvbi0tZWRpdCBlZGl0aW9uX19idXR0b24tLWpzLWVkaXRcIj5cclxuICAgICAgICAgICAgPHN2ZyBjbGFzcz1cImVkaXRpb25fX3N2ZyBlZGl0aW9uX19zdmctLWVkaXRcIj5cclxuICAgICAgICAgICAgICA8dXNlIGhyZWY9XCJhc3NldHMvc3ZnL2ljb25zLnN2ZyNlZGl0LW1vZGVcIj48L3VzZT5cclxuICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidXR0b24gZWRpdGlvbl9fYnV0dG9uIGVkaXRpb25fX2J1dHRvbi0tZGVjcmVhc2UgZWRpdGlvbl9fYnV0dG9uLS1qcy1kZWNyZWFzZVwiPlxyXG4gICAgICAgICAgICA8c3ZnIGNsYXNzPVwiZWRpdGlvbl9fc3ZnIGVkaXRpb25fX3N2Zy0tZGVjcmVhc2VcIj5cclxuICAgICAgICAgICAgICA8dXNlIGhyZWY9XCJhc3NldHMvc3ZnL2ljb25zLnN2ZyNsZWZ0LWFycm93XCI+PC91c2U+XHJcbiAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnV0dG9uIGVkaXRpb25fX2J1dHRvbiBlZGl0aW9uX19idXR0b24tLWluY3JlYXNlIGVkaXRpb25fX2J1dHRvbi0tanMtaW5jcmVhc2VcIj5cclxuICAgICAgICAgICAgPHN2ZyBjbGFzcz1cImVkaXRpb25fX3N2ZyBlZGl0aW9uX19zdmctLWluY3JlYXNlXCI+XHJcbiAgICAgICAgICAgICAgPHVzZSBocmVmPVwiYXNzZXRzL3N2Zy9pY29ucy5zdmcjcmlnaHQtYXJyb3dcIj48L3VzZT5cclxuICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidXR0b24gZWRpdGlvbl9fYnV0dG9uIGVkaXRpb25fX2J1dHRvbi0tY2FuY2VsIGVkaXRpb25fX2J1dHRvbi0tanMtY2FuY2VsXCI+XHJcbiAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJlZGl0aW9uX19zdmcgZWRpdGlvbl9fc3ZnLS1jYW5jZWxcIj5cclxuICAgICAgICAgICAgICA8dXNlIGhyZWY9XCJhc3NldHMvc3ZnL2ljb25zLnN2ZyNiYWNrLWFycm93XCI+PC91c2U+XHJcbiAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiYnV0dG9uIGVkaXRpb25fX2J1dHRvbiBlZGl0aW9uX19idXR0b24tLXNhdmUgZWRpdGlvbl9fYnV0dG9uLS1qcy1zYXZlXCI+XHJcbiAgICAgICAgICAgIDxzdmcgY2xhc3M9XCJlZGl0aW9uX19zdmcgZWRpdGlvbl9fc3ZnLS1zYXZlXCI+XHJcbiAgICAgICAgICAgICAgPHVzZSBocmVmPVwiYXNzZXRzL3N2Zy9pY29ucy5zdmcjc2F2ZS1pY29uXCI+PC91c2U+XHJcbiAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImluZGljYXRvciBpbmRpY2F0b3ItLWpzLSR7dGhpcy5nZXRJRH1cIj5cclxuICAgICAgICAgICR7aW5kaWNhdG9yc31cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9saT5cclxuICAgIGBcclxuICB9XHJcblxyXG4gIGdldCBnZXRWYWx1ZSgpIHtcclxuICAgIHJldHVybiB0aGlzLnZhbHVlO1xyXG4gIH1cclxuICBzZXQgZ2V0VmFsdWUoa2V5KSB7XHJcbiAgICB0aGlzLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICB9XHJcbiAgZ2V0IGdldFRpdGxlKCkge1xyXG4gICAgcmV0dXJuIHRoaXMudGl0bGU7XHJcbiAgfVxyXG4gIHNldCBnZXRUaXRsZShkYXRlKSB7XHJcbiAgICB0aGlzLnRpdGxlID0gZGF0ZS5yZXBsYWNlKCdoeWRyQXBwLScsJycpLnNwbGl0KCctJykucmV2ZXJzZSgpLmpvaW4oJyAnKTtcclxuICB9XHJcbiAgZ2V0IGdldElEKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuSUQ7XHJcbiAgfVxyXG4gIHNldCBnZXRJRChkYXRlKSB7XHJcbiAgICB0aGlzLklEID0gZGF0ZS5yZXBsYWNlKCdoeWRyQXBwLScsJycpLnNwbGl0KCctJykucmV2ZXJzZSgpLmpvaW4oJycpO1xyXG4gIH1cclxuICBnZXQgdG90YWxIZWlnaHQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fdG90YWxIZWlnaHQ7XHJcbiAgfVxyXG4gIHNldCB0b3RhbEhlaWdodChhbW91bnQpIHtcclxuICAgIHRoaXMuX3RvdGFsSGVpZ2h0ID0gYW1vdW50ICogdGhpcy5pdGVtSGVpZ2h0O1xyXG4gIH1cclxufVxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRlVOQ1RJT05TIFxyXG5cclxuLy8gRjEgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIENSRUFURSBIWURSQVBQIERBVEUgS0VZIFxyXG5cclxuY29uc3Qgc2V0RGF0ZUtleSA9IChvYmopID0+IHtcclxuICBjb25zdCBwcmVmaXggPSAnaHlkckFwcC0nO1xyXG4gIGNvbnN0IGRhdGUgPSBvYmoudG9JU09TdHJpbmcoKS5zbGljZSgwLDEwKTtcclxuICByZXR1cm4gcHJlZml4LmNvbmNhdChkYXRlKTtcclxufVxyXG4vLyBGMSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gQ1JFQVRFIEtFWSBWQUxVRSBQQUlSIElOIExPQ0FMIFNUT1JBR0UgXHJcblxyXG5jb25zdCBzZXROZXdLZXlWYWx1ZSA9IChrZXksIHZhbHVlKSA9PiB7XHJcbiAgaWYgKCAhbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSApIHtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgdmFsdWUpO1xyXG4gIH07XHJcbn1cclxuLy8gRjEgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gQ1JFQVRFIEFSUkFZIE9GIEhZRFJBUFAgTE9DQUwgU1RPUkFHRSBLRVlTIFxyXG5cclxuY29uc3QgZ2V0SHlkcmFwcEtleXMgPSAoKSA9PiB7XHJcbiAgY29uc3QgcmVnZXggPSAvaHlkckFwcC0vO1xyXG4gIHJldHVybiBPYmplY3RcclxuICAua2V5cyhsb2NhbFN0b3JhZ2UpXHJcbiAgLmZpbHRlcihrZXkgPT4gcmVnZXgudGVzdChrZXkpKVxyXG4gIC5zb3J0KClcclxuICAucmV2ZXJzZSgpO1xyXG59XHJcbi8vIEYxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBHRVQgT0ZGU0VURUQgREFURSBcclxuXHJcbmNvbnN0IGdldE9mZnNldGVkRGF0ZSA9ICgpID0+IHtcclxuICBjb25zdCB0aW1lWm9uZU9mZnNldCA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDA7XHJcbiAgcmV0dXJuIChuZXcgRGF0ZShEYXRlLm5vdygpIC0gdGltZVpvbmVPZmZzZXQpKTtcclxufVxyXG4vLyBGMSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gR0VUIE9GRlNFVEVEIERBVEUgT0YgXHJcblxyXG5jb25zdCBnZXRPZmZzZXRlZERhdGVPZiA9IChkYXRlKSA9PiB7XHJcbiAgY29uc3QgdGltZVpvbmVPZmZzZXQgPSAobmV3IERhdGUoKSkuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwO1xyXG4gIHJldHVybiBuZXcgRGF0ZShkYXRlIC0gdGltZVpvbmVPZmZzZXQpO1xyXG59XHJcbi8vIEYxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTRVQgQ09VTlRFUiBcclxuXHJcbmNvbnN0IHNldExvY2FsU3RvcmFnZSA9ICgpID0+IHtcclxuICBjb25zdCBvZmZzZXRlZERhdGUgPSBnZXRPZmZzZXRlZERhdGUoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAhIE9GRlNFVEVEIE9SIE5PUk1BTCA/Pz9cclxuICBsZXQgZGF0ZUtleSA9IHNldERhdGVLZXkob2Zmc2V0ZWREYXRlKTtcclxuICBjb25zdCBoeWRyYXBwS2V5cyA9IGdldEh5ZHJhcHBLZXlzKCk7XHJcbiAgY29uc3Qgb2xkZXN0S2V5ID0gaHlkcmFwcEtleXNbaHlkcmFwcEtleXMubGVuZ3RoIC0gMV07XHJcblxyXG4gIHNldE5ld0tleVZhbHVlKGRhdGVLZXksIDApO1xyXG4gIFxyXG4gIGlmICggaHlkcmFwcEtleXMubGVuZ3RoID4gMiApIHsgLy8gYXV0b2NvbXBsZXRlIG1pc3Npbmcga2V5cyBpbiBsb2NhbHN0b3JhZ2VcclxuICAgIGxldCBsaW1pdCA9IDA7IC8vIGZvciB0ZXN0cyB0byBhdm9pZCBsb29wIGVycm9yICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICEgVE8gUkVGQUNUT1JcclxuXHJcbiAgICB3aGlsZSAoc2V0RGF0ZUtleShvZmZzZXRlZERhdGUpICE9PSBvbGRlc3RLZXkgJiYgbGltaXQgPCA5OSkge1xyXG4gICAgICBvZmZzZXRlZERhdGUuc2V0RGF0ZShvZmZzZXRlZERhdGUuZ2V0RGF0ZSgpIC0gMSk7XHJcbiAgICAgIGNvbnN0IHByZXZEYXRlS2V5ID0gc2V0RGF0ZUtleShvZmZzZXRlZERhdGUpO1xyXG4gICAgICBzZXROZXdLZXlWYWx1ZShwcmV2RGF0ZUtleSwgMCk7XHJcbiAgICAgIGxpbWl0Kys7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNvdW50ZXIuaW5uZXJIVE1MID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oZGF0ZUtleSk7XHJcbn1cclxuLy8gRjEgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFVQREFURSBDT1VOVEVSIFxyXG5cclxuY29uc3QgdXBkYXRlQ291bnRlciA9IChlKSA9PiB7XHJcbiAgY29uc3Qgc2VsZiA9IGUudGFyZ2V0O1xyXG4gIGNvbnN0IG9mZnNldGVkRGF0ZSA9IGdldE9mZnNldGVkRGF0ZSgpO1xyXG4gIGNvbnN0IGtleSA9IHNldERhdGVLZXkob2Zmc2V0ZWREYXRlKTtcclxuICBjb25zdCB2YWx1ZSA9IHBhcnNlSW50KGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpO1xyXG4gIGxldCBuZXdWYWx1ZTtcclxuXHJcbiAgaWYgKHNlbGYgPT09IGFkZEdsYXNzIHx8IHNlbGYgPT09IHJlbW92ZUdsYXNzKSB7XHJcbiAgICBzd2l0Y2ggKHNlbGYpIHtcclxuICAgICAgY2FzZSBhZGRHbGFzczpcclxuICAgICAgICB2YWx1ZSA8IGNvdW50ZXJNYXhWYWx1ZSA/IG5ld1ZhbHVlID0gdmFsdWUgKyAxIDogbmV3VmFsdWUgPSBjb3VudGVyTWF4VmFsdWU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgcmVtb3ZlR2xhc3M6XHJcbiAgICAgICAgdmFsdWUgPiAwID8gbmV3VmFsdWUgPSB2YWx1ZSAtIDEgOiBuZXdWYWx1ZSA9IDA7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIG5ld1ZhbHVlKTtcclxuICAgIGNvdW50ZXIuaW5uZXJIVE1MID0gbmV3VmFsdWU7XHJcbiAgfVxyXG59XHJcbi8vIEYxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTRVQgQVJDSElWRSBcclxuXHJcbmNvbnN0IHNldEFyY2hpdmUgPSAoKSA9PiB7XHJcbiAgY29uc3QgaHlkcmFwcEtleXMgPSBnZXRIeWRyYXBwS2V5cygpO1xyXG4gIGNvbnN0IGVtcHR5QXJjaGl2ZSA9IGBcclxuICA8bGkgY2xhc3M9XCJhcmNoaXZlX19pdGVtIGFyY2hpdmVfX2l0ZW0tLWVtcHR5XCI+Tm8gaGlzdG9yeSB5ZXQuLi48L2xpPlxyXG4gIGA7XHJcbiAgYXJjaGl2ZUxpc3QuaW5uZXJIVE1MICs9IGVtcHR5QXJjaGl2ZTtcclxuXHJcbiAgaWYgKGh5ZHJhcHBLZXlzLmxlbmd0aCkge1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaHlkcmFwcEtleXMubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgICAgIGNvbnN0IG5ld0VudHJ5ID0gbmV3IEVudHJ5KGh5ZHJhcHBLZXlzW2ldLCAwKTtcclxuICAgICAgbmV3RW50cnkudG90YWxIZWlnaHQgPSBpO1xyXG4gICAgICBhcmNoaXZlTGlzdC5pbm5lckhUTUwgKz0gbmV3RW50cnkuaHRtbDtcclxuICAgICAgbGFzdEVudHJ5RGF0ZS5zZXREYXRlKGxhc3RFbnRyeURhdGUuZ2V0RGF0ZSgpIC0gMSk7XHJcbiAgICAgIHNldEluZGljYXRvcnMobmV3RW50cnkuSUQsIG5ld0VudHJ5LnZhbHVlKTtcclxuICAgICAgaHlkcmFwcEFycmF5LnB1c2gobmV3RW50cnkpO1xyXG4gICAgfVxyXG4gIH1cclxuICBjb25zb2xlLmxvZygnaHlkcmFwcEFycmF5JywgaHlkcmFwcEFycmF5KTtcclxufVxyXG4vLyBGMSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gU0VUIElORElDQVRPUlMgXHJcblxyXG5jb25zdCBzZXRJbmRpY2F0b3JzID0gKGlkLCB2YWx1ZSkgPT4ge1xyXG5cclxuICB2YWx1ZSA+IDcgPyB2YWx1ZSA9IDcgOiBmYWxzZTtcclxuXHJcbiAgY29uc3QgaW5kaWNhdG9ycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5pbmRpY2F0b3ItLWpzLSR7aWR9YCkuY2hpbGRyZW47XHJcbiAgY29uc3QgaW5kaWNhdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmluZGljYXRvci0tanMtJHtpZH0gLmluZGljYXRvcl9fc3ZnLS1qcy0ke3ZhbHVlfWApO1xyXG4gIFxyXG4gIGZvciAoY29uc3QgaW5kaWNhdG9yIG9mIGluZGljYXRvcnMpIHtcclxuICAgIGluZGljYXRvci5jbGFzc0xpc3QuY29udGFpbnMoJ2luZGljYXRvcl9fc3ZnLS12aXNpYmxlJylcclxuICAgID8gaW5kaWNhdG9yLmNsYXNzTGlzdC5yZW1vdmUoJ2luZGljYXRvcl9fc3ZnLS12aXNpYmxlJylcclxuICAgIDogZmFsc2U7XHJcbiAgfVxyXG4gIGluZGljYXRvci5jbGFzc0xpc3QuYWRkKCdpbmRpY2F0b3JfX3N2Zy0tdmlzaWJsZScpO1xyXG59XHJcbi8vIEYxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFNIT1cgQVJDSElWRSBcclxuY29uc3Qgc2hvd0FyY2hpdmUgPSAoKSA9PiB7XHJcblxyXG4gIC8vIEYyIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEhBTkRMRSBJVEVNIEVESVQgXHJcblxyXG4gIGNvbnN0IGhhbmRsZUl0ZW1FZGl0ID0gKGUpID0+IHtcclxuICAgIGNvbnN0IGl0ZW1JbmRleCA9IGUudGFyZ2V0LmluZGV4O1xyXG4gICAgY29uc3QgYXJjaGl2ZUl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYXJjaGl2ZV9faXRlbS0tanMnKVtpdGVtSW5kZXhdO1xyXG4gICAgY29uc3QgZWRpdFNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZWRpdGlvbi0tanMnKVtpdGVtSW5kZXhdO1xyXG4gICAgY29uc3QgZGVjcmVhc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZWRpdGlvbl9fYnV0dG9uLS1qcy1kZWNyZWFzZScpW2l0ZW1JbmRleF07XHJcbiAgICBjb25zdCBpbmNyZWFzZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lZGl0aW9uX19idXR0b24tLWpzLWluY3JlYXNlJylbaXRlbUluZGV4XTtcclxuICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lZGl0aW9uX19idXR0b24tLWpzLWNhbmNlbCcpW2l0ZW1JbmRleF07XHJcbiAgICBjb25zdCBzYXZlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVkaXRpb25fX2J1dHRvbi0tanMtc2F2ZScpW2l0ZW1JbmRleF07XHJcbiAgICBjb25zdCBhcmNoaXZlVmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYXJjaGl2ZV9fdmFsdWUtLWpzJylbaXRlbUluZGV4XTtcclxuXHJcbiAgICAvLyBGMyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFRPR0dMRSBJVEVNIERJU1BMQVkgPDwgSEFORExFIElURU0gRURJVCBcclxuXHJcbiAgICBjb25zdCB0b2dnbGVJdGVtRGlzcGxheSA9ICgpID0+IHtcclxuICAgICAgYXJjaGl2ZS5jbGFzc0xpc3QudG9nZ2xlKCdhcmNoaXZlLS1vbi10b3AnKTtcclxuICAgICAgYXJjaGl2ZUl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnYXJjaGl2ZV9faXRlbS0tb24tdG9wJyk7XHJcbiAgICAgIHBhZ2VPdmVybGF5LmNsYXNzTGlzdC50b2dnbGUoJ2FyY2hpdmVfX292ZXJsYXktLXZpc2libGUnKTtcclxuICAgICAgcmVtb3ZlSXRlbUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdyZW1vdmUtYnV0dG9uLS12aXNpYmxlJyk7XHJcbiAgICAgIFxyXG4gICAgICBmb3IgKGNvbnN0IGVkaXRCdXR0b24gb2YgZWRpdFNlY3Rpb24uY2hpbGRyZW4pIHtcclxuICAgICAgICBlZGl0QnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2VkaXRpb25fX2J1dHRvbi0tdmlzaWJsZScpO1xyXG4gICAgICB9XHJcbiAgICAgIGVkaXRTZWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ2VkaXRpb24tLXZpc2libGUnKTtcclxuICAgIH1cclxuICAgIC8vIEYzIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFWElUIEVESVQgTU9ERSA8PCBIQU5ETEUgSVRFTSBFRElUIFxyXG5cclxuICAgIGNvbnN0IGV4aXRFZGl0TW9kZSA9ICgpID0+IHtcclxuICAgICAgdG9nZ2xlSXRlbURpc3BsYXkoKTtcclxuICAgICAgYXJjaGl2ZVZhbHVlLnRleHRDb250ZW50ID0gaHlkcmFwcEFycmF5W2l0ZW1JbmRleF0udmFsdWU7XHJcbiAgICAgIHNldEluZGljYXRvcnMoaHlkcmFwcEFycmF5W2l0ZW1JbmRleF0uSUQsIGh5ZHJhcHBBcnJheVtpdGVtSW5kZXhdLnZhbHVlKTtcclxuICAgICAgcmVtb3ZlSXRlbUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdyZW1vdmUtYnV0dG9uLS12aXNpYmxlJyk7XHJcblxyXG4gICAgICBhcmNoaXZlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlRWRpdGlvbik7XHJcbiAgICAgIGFyY2hpdmUucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUVkaXRpb24pO1xyXG4gICAgfVxyXG4gICAgLy8gRjMgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEhBTkRMRSBFRElUSU9OIDw8IEhBTkRMRSBJVEVNIEVESVQgXHJcblxyXG4gICAgY29uc3QgaGFuZGxlRWRpdGlvbiA9IChlKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNlbGYgPSBlLmtleUNvZGUgfHwgZS50YXJnZXQ7XHJcbiAgICAgIGxldCB2YWx1ZSA9IHBhcnNlSW50KGFyY2hpdmVWYWx1ZS50ZXh0Q29udGVudCk7XHJcblxyXG4gICAgICBzd2l0Y2ggKHNlbGYpIHtcclxuXHJcbiAgICAgICAgY2FzZSAzNzpcclxuICAgICAgICBjYXNlIGRlY3JlYXNlQnV0dG9uOlxyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgdmFsdWUgPiAwID8gdmFsdWUtLSA6IGZhbHNlO1xyXG4gICAgICAgICAgYXJjaGl2ZVZhbHVlLnRleHRDb250ZW50ID0gdmFsdWU7XHJcbiAgICAgICAgICBzZXRJbmRpY2F0b3JzKGh5ZHJhcHBBcnJheVtpdGVtSW5kZXhdLklELCB2YWx1ZSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY2FzZSAzOTpcclxuICAgICAgICBjYXNlIGluY3JlYXNlQnV0dG9uOlxyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgdmFsdWUgPCBjb3VudGVyTWF4VmFsdWUgPyB2YWx1ZSsrIDogZmFsc2U7XHJcbiAgICAgICAgICBhcmNoaXZlVmFsdWUudGV4dENvbnRlbnQgPSB2YWx1ZTtcclxuICAgICAgICAgIHNldEluZGljYXRvcnMoaHlkcmFwcEFycmF5W2l0ZW1JbmRleF0uSUQsIHZhbHVlKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgY2FzZSAyNzpcclxuICAgICAgICBjYXNlIHBhZ2VPdmVybGF5OlxyXG4gICAgICAgIGNhc2UgY2FuY2VsQnV0dG9uOlxyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgZXhpdEVkaXRNb2RlKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgMTM6XHJcbiAgICAgICAgY2FzZSBzYXZlQnV0dG9uOlxyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgaHlkcmFwcEFycmF5W2l0ZW1JbmRleF0udmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGh5ZHJhcHBBcnJheVtpdGVtSW5kZXhdLmtleSwgdmFsdWUpO1xyXG4gICAgICAgICAgZXhpdEVkaXRNb2RlKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBGVU5DVElPTiBDQUxMUyA8PCBIQU5ETEUgSVRFTSBFRElUIFxyXG5cclxuICAgIHRvZ2dsZUl0ZW1EaXNwbGF5KCk7XHJcbiAgICBhcmNoaXZlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlRWRpdGlvbik7XHJcbiAgICBhcmNoaXZlLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVFZGl0aW9uKTtcclxuXHJcbiAgfSAvLyBGMiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBFTkQgT0YgSEFORExFIElURU0gRURJVCBcclxuICBcclxuICAvLyBGMiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBDUkVBVEUgUkVNT1ZFIElURU0gQlVUVE9OIFxyXG4gIFxyXG4gIGNvbnN0IGNyZWF0ZVJlbW92ZUl0ZW1CdXR0b24gPSAoKSA9PiB7XHJcbiAgXHJcbiAgICBjb25zdCByZW1vdmVJdGVtQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICByZW1vdmVJdGVtQnV0dG9uLmNsYXNzTmFtZSA9ICdidXR0b24gcmVtb3ZlLWJ1dHRvbiByZW1vdmUtYnV0dG9uLS12aXNpYmxlIHJlbW92ZS1idXR0b24tLWpzJztcclxuICAgIHJlbW92ZUl0ZW1CdXR0b24uaW5uZXJIVE1MID0gYFxyXG4gICAgPHN2ZyBjbGFzcz1cInJlbW92ZS1idXR0b25fX3N2Z1wiPlxyXG4gICAgICA8dXNlIGhyZWY9XCJhc3NldHMvc3ZnL2ljb25zLnN2ZyNyZW1vdmUtaWNvblwiPjwvdXNlPlxyXG4gICAgPC9zdmc+XHJcbiAgICBgXHJcblxyXG4gICAgcmVtb3ZlSXRlbUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJlbW92ZUxhc3RJdGVtKTtcclxuXHJcbiAgICByZXR1cm4gcmVtb3ZlSXRlbUJ1dHRvbjtcclxuICB9XHJcbiAgLy8gRjIgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEFESlVTVCBMQVNUIElURU0gT0YgTElTVCBcclxuICBcclxuICBjb25zdCBoYW5kbGVBcmNoaXZlTGFzdEl0ZW0gPSAoKSA9PiB7XHJcbiAgXHJcbiAgICBjb25zdCBsYXN0SXRlbSA9IGFyY2hpdmVMaXN0Lmxhc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICBjb25zdCBsYXN0SXRlbVZhbHVlTm9kZSA9IGxhc3RJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5hcmNoaXZlX192YWx1ZS0tanMnKTtcclxuXHJcbiAgICBpZiAoIXJlbW92ZUl0ZW1CdXR0b24pIHtcclxuICAgICAgcmVtb3ZlSXRlbUJ1dHRvbiA9IGNyZWF0ZVJlbW92ZUl0ZW1CdXR0b24oKTtcclxuICAgIH0gICAgXHJcblxyXG4gICAgY29uc3QgcHJldmlvdXNJdGVtID0gYXJjaGl2ZUxpc3QubGFzdEVsZW1lbnRDaGlsZC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xyXG4gICAgY29uc3QgcHJldmlvdXNSZW1vdmVCdXR0b24gPSBwcmV2aW91c0l0ZW0ucXVlcnlTZWxlY3RvcignLnJlbW92ZS1idXR0b24tLWpzJyk7XHJcbiAgICBjb25zdCBsYXN0UmVtb3ZlQnV0dG9uID0gbGFzdEl0ZW0ucXVlcnlTZWxlY3RvcignLnJlbW92ZS1idXR0b24tLWpzJyk7XHJcblxyXG4gICAgaWYgKHByZXZpb3VzUmVtb3ZlQnV0dG9uKSB7XHJcbiAgICAgIHByZXZpb3VzSXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdhcmNoaXZlX19pdGVtLS1yZW1vdmFibGUnKTtcclxuICAgICAgcHJldmlvdXNJdGVtLnJlbW92ZUNoaWxkKHByZXZpb3VzUmVtb3ZlQnV0dG9uKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWxhc3RSZW1vdmVCdXR0b24pIHtcclxuXHJcbiAgICAgIGxhc3RJdGVtLmNsYXNzTGlzdC5hZGQoJ2FyY2hpdmVfX2l0ZW0tLXJlbW92YWJsZScpO1xyXG4gICAgICBsYXN0SXRlbS5pbnNlcnRCZWZvcmUocmVtb3ZlSXRlbUJ1dHRvbiwgbGFzdEl0ZW1WYWx1ZU5vZGUpO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBGMiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBMT0FEIE1PUkUgPDwgU0hPVyBBUkNISVZFIFxyXG5cclxuICBjb25zdCBsb2FkTW9yZUl0ZW1zID0gKCkgPT4ge1xyXG4gICAgY29uc3QgYXJjaGl2ZUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFyY2hpdmVfX2l0ZW0tLWpzJyk7XHJcbiAgICBjb25zdCBhcmNoaXZlTGlzdEhlaWdodCA9IGFyY2hpdmVMaXN0LmNsaWVudEhlaWdodDtcclxuICAgIGxldCB2aWV3cG9ydEhlaWdodCA9IDA7XHJcblxyXG4gICAgaWYgKGh5ZHJhcHBBcnJheS5sZW5ndGggPT09IDEpIHtcclxuICAgICAgYXJjaGl2ZUxpc3QuZmlyc3RFbGVtZW50Q2hpbGQuY2xhc3NMaXN0LmFkZCgnYXJjaGl2ZV9faXRlbS0tdmlzaWJsZScpO1xyXG5cclxuICAgIH0gZWxzZSBpZiAoaHlkcmFwcEFycmF5Lmxlbmd0aCA+IDEpIHtcclxuXHJcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXJjaGl2ZUl0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgIGNvbnN0IGl0ZW0gPSBhcmNoaXZlSXRlbXNbaV07XHJcblxyXG4gICAgICAgIGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2FyY2hpdmVfX2l0ZW0tLXZpc2libGUnKSkge1xyXG5cclxuICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnYXJjaGl2ZV9faXRlbS0tdmlzaWJsZScpO1xyXG4gICAgICAgICAgdmlld3BvcnRIZWlnaHQgKz0gaXRlbS5vZmZzZXRIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgaHlkcmFwcEFycmF5W2ldLml0ZW1IZWlnaHQgPSBpdGVtLm9mZnNldEhlaWdodDtcclxuICAgICAgICAgIGh5ZHJhcHBBcnJheVtpXS50b3RhbEhlaWdodCA9IGk7XHJcbiAgICAgICAgICBhcmNoaXZlTGlzdC5zY3JvbGxUb3AgPSBoeWRyYXBwQXJyYXlbaV0udG90YWxIZWlnaHQ7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmICh2aWV3cG9ydEhlaWdodCA+IGFyY2hpdmVMaXN0SGVpZ2h0IC0gaXRlbS5vZmZzZXRIZWlnaHQpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGFyY2hpdmVMaXN0LnN0eWxlLmhlaWdodCA9IHZpZXdwb3J0SGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICAgICAgbG9hZE1vcmVCdXR0b24uY2xhc3NMaXN0LmFkZCgnYXJjaGl2ZV9fYnV0dG9uLS12aXNpYmxlJyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2FkTW9yZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdhcmNoaXZlX19idXR0b24tLXZpc2libGUnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaGFuZGxlQXJjaGl2ZUxhc3RJdGVtKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBGMiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBBREQgTkVXIElURU0gPDwgU0hPVyBBUkNISVZFIFxyXG5cclxuICBjb25zdCBhZGROZXdJdGVtID0gKCkgPT4ge1xyXG5cclxuICAgIGNvbnN0IG5ld0VudHJ5S2V5ID0gc2V0RGF0ZUtleShnZXRPZmZzZXRlZERhdGVPZihsYXN0RW50cnlEYXRlKSk7XHJcbiAgICBzZXROZXdLZXlWYWx1ZShuZXdFbnRyeUtleSwgMCk7XHJcbiAgICBjb25zdCBhcmNoaXZlTGlzdEhlaWdodCA9IGFyY2hpdmVMaXN0LmNsaWVudEhlaWdodDtcclxuICAgIGxldCB2aWV3cG9ydEhlaWdodCA9IDA7XHJcblxyXG4gICAgY29uc3QgbmV3RW50cnkgPSBuZXcgRW50cnkobmV3RW50cnlLZXkpO1xyXG4gICAgaHlkcmFwcEFycmF5LnB1c2gobmV3RW50cnkpO1xyXG4gICAgbGFzdEVudHJ5RGF0ZS5zZXREYXRlKGxhc3RFbnRyeURhdGUuZ2V0RGF0ZSgpIC0gMSk7XHJcbiAgICBjb25zdCBjdXJyZW50SW5kZXggPSBoeWRyYXBwQXJyYXkubGVuZ3RoIC0gMTtcclxuICAgIGFyY2hpdmVMaXN0Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgaHlkcmFwcEFycmF5W2N1cnJlbnRJbmRleF0uaHRtbCk7XHJcbiAgICBzZXRJbmRpY2F0b3JzKGh5ZHJhcHBBcnJheVtjdXJyZW50SW5kZXhdLklELCBoeWRyYXBwQXJyYXlbY3VycmVudEluZGV4XS52YWx1ZSk7XHJcbiAgICBcclxuICAgIGhhbmRsZUFyY2hpdmVMYXN0SXRlbSgpO1xyXG4gICAgXHJcbiAgICBmb3IgKGxldCBpID0gMjsgaSA8IGFyY2hpdmVMaXN0LmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGl0ZW0gPSBhcmNoaXZlTGlzdC5jaGlsZHJlbltpXTtcclxuICAgICAgaWYgKCFpdGVtLmNsYXNzTGlzdC5jb250YWlucygnYXJjaGl2ZV9faXRlbS0tdmlzaWJsZScpKSB7XHJcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdhcmNoaXZlX19pdGVtLS12aXNpYmxlJyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHZpZXdwb3J0SGVpZ2h0IDw9IGFyY2hpdmVMaXN0SGVpZ2h0IC0gaXRlbS5vZmZzZXRIZWlnaHQpIHtcclxuICAgICAgICB2aWV3cG9ydEhlaWdodCArPSBpdGVtLm9mZnNldEhlaWdodDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAobG9hZE1vcmVCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhcmNoaXZlX19idXR0b24tLXZpc2libGUnKSkge1xyXG4gICAgICBsb2FkTW9yZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdhcmNoaXZlX19idXR0b24tLXZpc2libGUnKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoY3VycmVudEluZGV4ID09PSAxKSB7XHJcbiAgICAgIGFyY2hpdmVMaXN0LmZpcnN0RWxlbWVudENoaWxkLmNsYXNzTGlzdC5yZW1vdmUoJ2FyY2hpdmVfX2l0ZW0tLXZpc2libGUnKTtcclxuICAgIH0gXHJcblxyXG4gICAgaHlkcmFwcEFycmF5W2N1cnJlbnRJbmRleF0uaXRlbUhlaWdodCA9IGFyY2hpdmVMaXN0Lmxhc3RFbGVtZW50Q2hpbGQub2Zmc2V0SGVpZ2h0O1xyXG4gICAgaHlkcmFwcEFycmF5W2N1cnJlbnRJbmRleF0udG90YWxIZWlnaHQgPSBjdXJyZW50SW5kZXg7XHJcblxyXG4gICAgaWYgKGh5ZHJhcHBBcnJheVtjdXJyZW50SW5kZXhdLnRvdGFsSGVpZ2h0ID4gYXJjaGl2ZUxpc3QuY2xpZW50SGVpZ2h0IC0gaHlkcmFwcEFycmF5W2N1cnJlbnRJbmRleF0uaXRlbUhlaWdodCkge1xyXG4gICAgICBhcmNoaXZlTGlzdC5zdHlsZS5oZWlnaHQgPSB2aWV3cG9ydEhlaWdodDtcclxuICAgIH1cclxuXHJcbiAgICBhcmNoaXZlTGlzdC5zY3JvbGxUb3AgPSBoeWRyYXBwQXJyYXlbY3VycmVudEluZGV4XS50b3RhbEhlaWdodDtcclxuXHJcbiAgICBlZGl0QnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5lZGl0aW9uX19idXR0b24tLWpzLWVkaXQnKTtcclxuICAgIGNvbnN0IG5ld0VkaXRCdXR0b24gPSBlZGl0QnV0dG9uc1tjdXJyZW50SW5kZXhdO1xyXG4gICAgbmV3RWRpdEJ1dHRvbi5pbmRleCA9IGN1cnJlbnRJbmRleDtcclxuICAgIG5ld0VkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVJdGVtRWRpdCk7ICAgIFxyXG4gIH1cclxuICAvLyBGMiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFJFTU9WRSBMQVNUIElURU0gPDwgU0hPVyBBUkNISVZFIFxyXG5cclxuICBjb25zdCByZW1vdmVMYXN0SXRlbSA9ICgpID0+IHtcclxuXHJcbiAgICBjb25zdCBhcmNoaXZlTGlzdEhlaWdodCA9IGFyY2hpdmVMaXN0LmNsaWVudEhlaWdodDtcclxuXHJcbiAgICBpZiAoaHlkcmFwcEFycmF5Lmxlbmd0aCA+IDEpIHtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGxhc3RJdGVtS2V5ID0gaHlkcmFwcEFycmF5W2h5ZHJhcHBBcnJheS5sZW5ndGggLSAxXS5rZXk7XHJcbiAgICAgIGh5ZHJhcHBBcnJheS5wb3AoKTtcclxuICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0obGFzdEl0ZW1LZXkpO1xyXG4gICAgICBsYXN0RW50cnlEYXRlLnNldERhdGUobGFzdEVudHJ5RGF0ZS5nZXREYXRlKCkgKyAxKTtcclxuICAgICAgYXJjaGl2ZUxpc3QucmVtb3ZlQ2hpbGQoYXJjaGl2ZUxpc3QubGFzdEVsZW1lbnRDaGlsZCk7XHJcbiAgICAgIGNvbnN0IGl0ZW1zVG90YWxIZWlnaHQgPSBoeWRyYXBwQXJyYXlbaHlkcmFwcEFycmF5Lmxlbmd0aCAtIDFdLnRvdGFsSGVpZ2h0O1xyXG5cclxuICAgICAgaWYgKGl0ZW1zVG90YWxIZWlnaHQgPD0gYXJjaGl2ZUxpc3RIZWlnaHQgJiYgaXRlbXNUb3RhbEhlaWdodCA+IDApIHtcclxuICAgICAgICBsb2FkTW9yZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdhcmNoaXZlX19idXR0b24tLXZpc2libGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGh5ZHJhcHBBcnJheS5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICBhcmNoaXZlTGlzdC5maXJzdEVsZW1lbnRDaGlsZC5jbGFzc0xpc3QuYWRkKCdhcmNoaXZlX19pdGVtLS12aXNpYmxlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGhhbmRsZUFyY2hpdmVMYXN0SXRlbSgpO1xyXG4gICAgfVxyXG4gIH1cclxuICAvLyBGMiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIENMT1NFIEFSQ0hJVkUgPDwgU0hPVyBBUkNISVZFIFxyXG5cclxuICBjb25zdCBjbG9zZUFyY2hpdmUgPSAoKSA9PiB7XHJcbiAgICBhcmNoaXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2FyY2hpdmUtLXZpc2libGUnKTtcclxuICAgIGxvYWRNb3JlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2FyY2hpdmVfX2J1dHRvbi0taGlkZGVuJyk7XHJcblxyXG4gICAgY29uc3QgYXJjaGl2ZUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFyY2hpdmVfX2l0ZW0tLWpzJyk7XHJcbiAgICBmb3IgKGNvbnN0IGFyY2hpdmVJdGVtIG9mIGFyY2hpdmVJdGVtcykge1xyXG4gICAgICBhcmNoaXZlSXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdhcmNoaXZlX19pdGVtLS12aXNpYmxlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkTmV3QnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYWRkTmV3SXRlbSk7XHJcbiAgICBsb2FkTW9yZUJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGxvYWRNb3JlSXRlbXMpO1xyXG4gICAgYXJjaGl2ZUJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlQXJjaGl2ZSk7XHJcblxyXG4gICAgZm9yIChjb25zdCBlZGl0QnV0dG9uIG9mIGVkaXRCdXR0b25zKSB7XHJcbiAgICAgIGVkaXRCdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVJdGVtRWRpdCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXJjaGl2ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dBcmNoaXZlKTtcclxuICB9XHJcbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gVkFSSUFCTEVTIDw8IFNIT1cgQVJDSElWRSBcclxuXHJcbiAgbGV0IGVkaXRCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVkaXRpb25fX2J1dHRvbi0tanMtZWRpdCcpO1xyXG4gIGxldCByZW1vdmVJdGVtQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlbW92ZS1idXR0b24tLWpzJyk7XHJcblxyXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBGVU5DVElPTiBDQUxMUyA8PCBTSE9XIEFSQ0hJVkUgXHJcblxyXG4gIGFyY2hpdmUuY2xhc3NMaXN0LmFkZCgnYXJjaGl2ZS0tdmlzaWJsZScpO1xyXG4gIGxvYWRNb3JlSXRlbXMoKTtcclxuXHJcbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRVZFTlQgTElTVEVORVJTIDw8IFNIT1cgQVJDSElWRSBcclxuXHJcbiAgYXJjaGl2ZUJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dBcmNoaXZlKTtcclxuICBhcmNoaXZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VBcmNoaXZlKTtcclxuICBsb2FkTW9yZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxvYWRNb3JlSXRlbXMpO1xyXG4gIGFkZE5ld0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFkZE5ld0l0ZW0pO1xyXG5cclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGVkaXRCdXR0b25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBjb25zdCBlZGl0QnV0dG9uID0gZWRpdEJ1dHRvbnNbaV07XHJcbiAgICBlZGl0QnV0dG9uLmluZGV4ID0gaTtcclxuICAgIGVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVJdGVtRWRpdCk7XHJcbiAgfVxyXG59XHJcbi8vIEYxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRU5EIE9GIFNIT1cgQVJDSElWRSBcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFZBUklBQkxFUyBcclxuXHJcbmNvbnN0IGFwcENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHBfX2NvbnRhaW5lci0tanMnKTtcclxuY29uc3QgYWRkR2xhc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwX19idXR0b24tLWpzLWFkZCcpO1xyXG5jb25zdCByZW1vdmVHbGFzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHBfX2J1dHRvbi0tanMtcmVtb3ZlJyk7XHJcbmNvbnN0IGNvdW50ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2xhc3NfX2NvdW50ZXItLWpzJyk7XHJcbmNvbnN0IGNvdW50ZXJNYXhWYWx1ZSA9IDk5O1xyXG5cclxuY29uc3QgYXJjaGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcmNoaXZlLS1qcycpO1xyXG5jb25zdCBwYWdlT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcmNoaXZlX19vdmVybGF5LS1qcycpO1xyXG5jb25zdCBhcmNoaXZlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcmNoaXZlX19saXN0LS1qcycpO1xyXG5jb25zdCBhcmNoaXZlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdmlnYXRpb25fX2J1dHRvbi0tanMtYXJjaGl2ZScpO1xyXG5jb25zdCBsb2FkTW9yZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcmNoaXZlX19idXR0b24tLWpzLWxvYWQtbW9yZScpO1xyXG5jb25zdCBhZGROZXdCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJjaGl2ZV9fYnV0dG9uLS1hZGQtbmV3Jyk7XHJcblxyXG5jb25zdCBzdGF0c0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZpZ2F0aW9uX19idXR0b24tLWpzLXN0YXRzJyk7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRlVOQ1RJT04gQ0FMTFMgXHJcblxyXG5zZXRMb2NhbFN0b3JhZ2UoKTtcclxuc2V0QXJjaGl2ZSgpO1xyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gRVZFTlQgTElTVEVORVJTIFxyXG5cclxuYXBwQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdXBkYXRlQ291bnRlcik7XHJcbmFyY2hpdmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzaG93QXJjaGl2ZSk7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n")}]);