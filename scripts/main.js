"use strict";function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,a=!1,s=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,s=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw s}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("serviceworker.js").then(function(e){},function(e){})});var loopedRange=function(e,t,n){return"increase"===n&&(e<=t?t=0:t++),"decrease"===n&&(t<=0?t=e:t--),t},limitedRange=function(e,t,n){return"increase"===n&&(!(e<=t)&&t++),"decrease"===n&&(!(t<=0)&&t--),t},getRangeOfDates=function(e,t){if(""===e||""===t)return"Too soon for that ...";var n=_slicedToArray(e.split("."),3),r=n[0],a=n[1],s=n[2],i=_slicedToArray(t.split("."),3),o=i[0],l=i[1],c=i[2];return s=s.slice(2,4),c=c.slice(2,4),"".concat(s===c?a===l?r===o?"":"".concat(r," - "):"".concat(r,".").concat(a," - "):"".concat(r,".").concat(a,".").concat(s," - ")).concat(o,".").concat(l,".").concat(c)},findFirstParentOfClass=function(e,t){for(;!e.parentNode.classList.contains(t)&&"HTML"!==e.parentNode.tagName;)e=e.parentNode;return e.parentNode},handleWindowResize=function(){var e=loggedUser.entries[0].value;handleWaterLevel(e),handleWaterWaves(waterObj),handleWaterMeasure()},handleContainerHeight=function(e,t){var n=_toConsumableArray(t.children).reduce(function(e,t){return e+t.clientHeight},0);e.style.height="".concat(n,"px")},handleContainerHeightThroughTime=function(e,t,n){var r=setInterval(function(){handleContainerHeight(e,t)},10),a=setTimeout(function(){clearInterval(r),clearTimeout(a)},n)},getSingularOrPlural=function(e,t){return"waterMax"===e||"waterMin"===e||"waterAvg"===e?"".concat(t," ").concat(1<t||0===t?"glasses":"glass"):"points"===e?"".concat(t," ").concat(1<t||0===t?"pts":"pt"):t},setNodes=function(e,t){e.front.water=t.querySelector(".water--js-front"),e.front.waves=t.querySelector(".waves--js-front"),e.center.water=t.querySelector(".water--js-center"),e.center.waves=t.querySelector(".waves--js-center"),e.back.water=t.querySelector(".water--js-back"),e.back.waves=t.querySelector(".waves--js-back")},getRandomFromRange=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},getAverageOfArrayValues=function(e){var t=e.map(function(e){return e.value}).reduce(function(e,t){return e+t})/e.length;return Math.round(100*t)/100},toggleChildrenFocusability=function(e){var t=e.querySelectorAll("BUTTON"),n=["edition__button--js-decrease","edition__button--js-increase","edition__button--js-cancel","edition__button--js-save"];_toConsumableArray(t).forEach(function(e){var t;t=e,0<n.filter(function(e){return t.classList.contains(e)}).length||("-1"===e.getAttribute("tabIndex")?e.setAttribute("tabIndex","0"):e.setAttribute("tabIndex","-1"))})},getSortedUsersIds=function(){return Object.values(hydrapp.users).sort(function(e,t){return t.points-e.points}).map(function(e){return e.id})},getOffsetedDate=function(e){var t=6e4*(new Date).getTimezoneOffset();return new Date(e-t)},getDateId=function(e){var t=6e4*(new Date).getTimezoneOffset(),n=e||new Date;return(n=new Date(n-t)).toISOString().slice(0,10).split("-").reverse().join("")},filterUserInput=function(e){if(13===e.keyCode||27===e.keyCode)return!1;var t=e.target,n=t.value.match(/\d/g),r=n?n.join(""):"";t.value=r},handleInputAlert=function(e,t,n){var r=e.firstElementChild,a="";if(t){if("name"===t&&"empty"===n)a="Please enter your name";else if("name"===t&&"existing"===n)a="This user name is already taken";else if("login"===t&&"empty"===n)a="Please enter your login";else if("login"===t&&"noMatch"===n)a="There is no user of that name...";else{var s=userHelper[t],i=s.min,o=s.max,l=loggedUser.entries[0].value;i=l<i?i:l;var c="waterMax"===t?s.alertLabel:s.label;a="".concat(c," should be between ").concat(i," and ").concat(o)}r.textContent=a,e.style.height="".concat(r.clientHeight,"px")}else e.style.height="",r.textContent=""},isInputValid=function(e,t,n){var r=e.value;if("name"===t){var a=Object.values(hydrapp.users).find(function(e){return e.name===r});return""===r?(handleInputAlert(n,t,"empty"),!1):a?(handleInputAlert(n,t,"existing"),!1):(handleInputAlert(n),!0)}var s=userHelper[t],i=s.min,o=s.max,l=loggedUser.entries[0].value;return r<(i=l<i?i:l)||o<r?(handleInputAlert(n,t),e.focus(),!1):(handleInputAlert(n),!0)},getUserStreaks=function(e,t){for(var n=0,r=0,a=0,s=0,i="",o="",l="",c="",d=function(){r<=n&&(r=n,i=l,o=c)},u=e.length-1;0<=u;u--){var g=e[u],v=g.value,h=g.date;t<=v?(0===n?l=h:c=h,n++,0===u&&d()):(d(),n=0),s+=n}var _=getRangeOfDates(i,o),f=!0,m=!1,y=void 0;try{for(var p,b=e[Symbol.iterator]();!(f=(p=b.next()).done);f=!0){if(!(p.value.value>=t))break;a++}}catch(e){m=!0,y=e}finally{try{f||null==b.return||b.return()}finally{if(m)throw y}}return{currentStreak:a,longestStreak:r,lastLongestStreakDates:_,points:s}},fetchJSON=function(){return JSON.parse(localStorage.getItem(localStorageKeyName))},exportJSON=function(){localStorage.setItem(localStorageKeyName,JSON.stringify(hydrapp))},updateUsersEntries=function(){Object.values(hydrapp.users).forEach(function(e){for(var t=new Date,n=getDateId(t),r=[],a=e.entries[0].id;n!==a;){var s=new Entry(0,t);r=[].concat(_toConsumableArray(r),[s]),n=getDateId(t.setDate(t.getDate()-1))}e.entries=[].concat(_toConsumableArray(r),_toConsumableArray(e.entries))}),startWaterValue=loggedUser.entries[0].value},updateUsersStats=function(){Object.values(hydrapp.users).forEach(function(e){var t=e.entries,n=e.waterMin,r=getAverageOfArrayValues(t),a=getUserStreaks(t,n),s=a.currentStreak,i=a.longestStreak,o=a.lastLongestStreakDates,l=a.points;e.waterAvg=r,e.currentStreak=s,e.longestStreak=i,e.lastLongestStreakDates=o,e.points=l});var a=getSortedUsersIds();a.forEach(function(e,t){var n=hydrapp.users[e],r=0<t&&hydrapp.users[a[t-1]];r?r.points===n.points?n.rank=r.rank:n.rank=r.rank+1:n.rank=1})},getHtmlOfNewUser=function(e,t){return'\n    <div\n      class="newUser newUser--js '.concat("login"===e?"newUser--visible":"",'"\n    >\n      <label\n        for="').concat(e,'Question"\n        class="newUser__label newUser__label--js"\n      >\n      </label>\n      <input\n        id="').concat(e,'Question"\n        class="newUser__input newUser__input--js"\n        type="text"\n        maxlength="').concat(t,'"\n      >\n      <div class="newUser__alert newUser__alert--js">\n        <p class="newUser__alertText"></p>\n      </div>\n      <button class="newUser__button newUser__button--prev newUser__button--js-prev">\n        <svg class="newUser__svg" viewBox="0 0 512 512">\n          <use href="assets/svg/icons.svg#left-arrow"></use>\n        </svg>\n      </button>\n      <button class="newUser__button newUser__button--next newUser__button--js-next">\n        <svg class="newUser__svg" viewBox="0 0 512 512">\n          <use href="assets/svg/icons.svg#right-arrow"></use>\n        </svg>\n      </button>\n    </div>\n  ')},getHtmlOfEmoji=function(e){for(var t='<div class="emoji__container emoji__container--'.concat(e," emoji__container--js-").concat(e,'">'),n=0;n<emojiAmount;n++)t+='\n      <svg\n        class="emoji__svg emoji__svg--emo-'.concat(n," emoji__svg--js-").concat(e,'"\n        viewBox="0 0 512 512"\n      >\n        <use href="assets/svg/emoji.svg#emo-').concat(n,'"></use>\n      </svg>\n    ');return t+="</div>"},getHtmlOfWaterContainer=function(r,a){var s=function(e,t,n){for(var r="",a=1;a<=e;a++)r+='\n        <div class="wave__period">\n          <svg class="wave__svg wave__svg--solid" viewBox="0 0 100 10">\n            <use href="assets/svg/wave.svg#wave"></use>\n          </svg>\n          '.concat(n||"front"!==t?"":'\n              <svg class="wave__svg wave__svg--line" viewBox="0 0 100 10">\n                <use href="assets/svg/wave.svg#waveLine"></use>\n              </svg>\n            ',"\n        </div>\n      ");return r},e=Object.keys(r),i="";return e.forEach(function(e){var t=a?"intro":"",n=r[e].wavePeriodsTotal;i+='\n      <div\n        class="water water--'.concat(t," water--").concat(e," water--js-").concat(e,'"\n      >\n        <div class="waves waves--').concat(t," waves--").concat(e," waves--js-").concat(e,'">\n          <div class="wave wave--before wave--').concat(t," wave--").concat(e,' wave--js">\n            ').concat(s(n,e,a),'\n          </div>\n          <div class="wave wave--').concat(t," wave--").concat(e,' wave--js">\n            ').concat(s(n,e,a),'\n          </div>\n          <div class="wave wave--after wave--').concat(t," wave--").concat(e,' wave--js">\n            ').concat(s(n,e,a),"\n          </div>\n        </div>\n      </div>\n    "),i+="center"===e&&a?'\n    <div class="intro__logo">\n      <svg class="intro__svg" viewBox="0 0 512 135">\n        <use href="assets/svg/icons.svg#logo-white"></use>\n      </svg>\n      <svg class="intro__svg intro__svg--color" viewBox="0 0 512 135">\n        <use href="assets/svg/icons.svg#logo-color"></use>\n      </svg>\n    </div>\n  ':""}),i+=a?'\n    <button class="intro__start intro__start--js">Start</button>\n  ':""},getHtmlOfCard=function(e,t,n){return'\n    <section\n      class="card card--'.concat(e," card--js-").concat(e," ").concat(n?"card--js-".concat(n):"",'"\n    >\n      <div class="card__container">\n        <header class="card__header card__header--').concat(e," card__header---js-").concat(e,'">\n          ').concat("settings"!==e?'\n          <button\n            class="card__button card__button--prev card__button--js-prev"\n            tabIndex="-1"\n          >\n            <svg class="card__svg" viewBox="0 0 512 512">\n              <use href="assets/svg/icons.svg#left-arrow"></use>\n            </svg>\n          </button>\n          ':"",'\n          <h4 class="card__heading card__heading--js-').concat(e,'">\n            ').concat("settings"===e?"Profile:":""," ").concat(t,"\n          </h4>\n          ").concat("settings"!==e?'\n          <button\n            class="card__button card__button--next card__button--js-next"\n            tabIndex="-1"\n          >\n            <svg class="card__svg" viewBox="0 0 512 512">\n              <use href="assets/svg/icons.svg#right-arrow"></use>\n            </svg>\n          </button>\n          ':"",'\n        </header>\n        <ul class="card__list card__list--').concat(e," card__list--js-").concat(e,'"></ul>\n      </div>\n    </section>\n  ')},getHtmlOfEdition=function(e,t){return'\n    <div class="edition edition--'.concat(e,' edition--js">\n      <button\n        class="edition__button edition__button--visible edition__button--edit edition__button--js-edit"\n        ').concat(t?'id="'.concat(t,'EditButton"'):"",'\n        tabIndex="-1"\n      >\n        <svg class="edition__svg edition__svg--edit">\n          <use href="assets/svg/icons.svg#edit-mode"></use>\n        </svg>\n      </button>\n      ').concat("archive"===e?'\n      <button\n        class="edition__button edition__button--decrease edition__button--js-decrease"\n        tabIndex="-1"\n      >\n        <svg class="edition__svg edition__svg--decrease">\n          <use href="assets/svg/icons.svg#down-arrow"></use>\n        </svg>\n      </button>\n      <button\n        class="edition__button edition__button--increase edition__button--js-increase"\n        tabIndex="-1"\n      >\n        <svg class="edition__svg edition__svg--increase">\n          <use href="assets/svg/icons.svg#up-arrow"></use>\n        </svg>\n      </button>\n      ':"",'      \n      <button\n        class="edition__button edition__button--cancel edition__button--js-cancel"\n        tabIndex="-1"\n      >\n        <svg class="edition__svg edition__svg--cancel">\n          <use href="assets/svg/icons.svg#back-arrow"></use>\n        </svg>\n      </button>\n      <button\n        class="edition__button edition__button--save edition__button--js-save"\n        tabIndex="-1"\n      >\n        <svg class="edition__svg edition__svg--save">\n          <use href="assets/svg/icons.svg#save-icon"></use>\n        </svg>\n      </button>\n    </div>\n  ')},getHtmlOfArchiveEntry=function(e){var t=loggedUser.entries[e],n=t.date,r=t.day,a=t.id,s=t.value;return'\n    <li class="entry entry--js dateId-'.concat(a,'">\n      <header class="entry__header entry__header--js">\n        <p class="entry__heading entry__heading--day">').concat(r,'</p>\n        <p class="entry__heading entry__heading--date entry__heading--js-date">').concat(n,'</p>\n      </header>\n      <span class="entry__value entry__value--js">').concat(s,"</span>\n      ").concat(e<=4?getHtmlOfEdition("archive"):"","\n      ").concat(getHtmlOfEmoji(a),"\n    </li>\n  ")},getHtmlOfUserStats=function(r){var e=userHelper.statsProps,a="";return e.forEach(function(e){var t=r[e],n=userHelper[e].label;a+='\n      <li class="userProp userProp--stats">\n        <span class="userProp__label">\n          '.concat(n,'\n        </span>\n        <span class="userProp__value userProp__value--').concat(e," userProp__value--js-").concat(e,'">\n            ').concat(getSingularOrPlural(e,t),"\n        </span>\n      </li>\n    ")}),a},getHtmlOfUserRank=function(e){var t=e.name,n=e.id,r=e.points,a=e.rank;return'\n    <li class="userProp userProp--rank userProp--js-'.concat(n,'">\n      <span class="userProp__rank userProp__rank--js">\n        ').concat(a,'\n      </span>\n      <span class="userProp__label userProp__label--rank userProp__label--js">\n        ').concat(t,'\n        </span>\n      <span class="userProp__value userProp__value--rank userProp__value--js">\n        ').concat(getSingularOrPlural("points",r),"\n      </span>\n    </li>\n  ")},getHtmlOfUserSettings=function(){var e=userHelper.settingsProps,s="";return e.forEach(function(e){var t=loggedUser[e],n=userHelper[e],r=n.label,a=n.maxLength;s+='\n      <li class="userProp userProps--settings">\n        <label for="'.concat(e,'Settings" class="userProp__label userProp__label--js">\n          ').concat(r,'\n        </label>\n        <div class="userProp__value">\n          <span class="userProp__output userProp__output--').concat(e," userProp__output--js userProp__output--js-").concat(e,'">\n            ').concat(getSingularOrPlural(e,t),'\n          </span>\n          <input\n            id="').concat(e,'Settings"\n            class="userProp__input userProp__input--js"\n            type="text"\n            maxlength="').concat(a,'"\n          >\n        </div>\n        ').concat(getHtmlOfEdition("stats",e),'\n        <div class="userProp__alert userProp__alert--js">\n          <p class="userProp__alertText"></p>\n        </div>\n      </li>\n    ')}),s},getHtmlOfProfileButtons=function(){return'\n      <div class="profile">\n        <button\n          class="profile__button profile__button--logOut profile__button--js-logOut"\n          tabIndex="-1"\n        >\n          Log Out\n        </button>\n        <button\n          class="profile__button profile__button--remove profile__button--js-remove"\n          tabIndex="-1"\n        >\n          Remove User\n        </button>\n      </div>\n    ','\n      <div class="profile">\n        <button\n          class="profile__button profile__button--logOut profile__button--js-logOut"\n          tabIndex="-1"\n        >\n          Log Out\n        </button>\n        <button\n          class="profile__button profile__button--remove profile__button--js-remove"\n          tabIndex="-1"\n        >\n          Remove User\n        </button>\n      </div>\n    '},initialUsers=[{name:"Anna",age:29,weight:58,height:176,dateCreated:"January 7, 2020 23:30:05"},{name:"Agnieszka",age:28,weight:65,height:165,dateCreated:"February 21, 2020 15:32:56"},{name:"Aleksander",age:28,weight:70,height:174,dateCreated:"February 14, 2020 12:07:23"},{name:"Jakub",age:32,weight:67,height:181,dateCreated:"January 3, 2020 14:45:13"},{name:"John",age:24,weight:82,height:185,dateCreated:"March 3, 2020 13:29:54"},{name:"Jane",age:18,weight:62,height:162,dateCreated:"March 2, 2020 11:59:01"},{name:"Adam_26",age:26,weight:93,height:178,dateCreated:"February 1, 2020 18:13:15"},{name:"Steven",age:35,weight:81,height:183,dateCreated:"January 23, 2020 13:02:16"},{name:"Mary Ann",age:26,weight:63,height:155,dateCreated:"February 18, 2020 07:30:21"},{name:"Maciej C",age:34,weight:98,height:192,dateCreated:"January 18, 2020 08:30:01"},{name:"Ala",age:20,weight:75,height:170,dateCreated:"March 6, 2020 03:11:05"},{name:"Jack",age:25,weight:69,height:180,dateCreated:"February 2, 2020 09:41:32"},{name:"Angelica",age:33,weight:59,height:157,dateCreated:"February 27, 2020 17:21:57"},{name:"Jeff Adams",age:36,weight:105,height:186,dateCreated:"February 8, 2020 06:18:21"},{name:"Brian",age:33,weight:88,height:178,dateCreated:"January 30, 2020 22:45:46"},{name:"Angie24",age:24,weight:55,height:165,dateCreated:"February 3, 2020 10:32:54"},{name:"Tom",age:21,weight:87,height:174,dateCreated:"March 1, 2020 21:38:41"},{name:"Filip",age:19,weight:65,height:178,dateCreated:"February 26, 2020 11:12:11"},{name:"Marcin P",age:31,weight:76,height:184,dateCreated:"March 3, 2020 22:45:31"},{name:"Ola",age:26,weight:61,height:167,dateCreated:"February 17, 2020 12:11:34"},{name:"Andrew",age:23,weight:89,height:181,dateCreated:"January 8, 2020 13:08:54"},{name:"Stacy",age:39,weight:86,height:176,dateCreated:"February 9, 2020 14:21:56"},{name:"Gregory",age:42,weight:95,height:173,dateCreated:"March 06, 2020 16:07:51"},{name:"Peter J",age:38,weight:81,height:176,dateCreated:"February 22, 2020 20:24:56"},{name:"Paulina",age:29,weight:65,height:174,dateCreated:"January 13, 2020 18:21:34"},{name:"Tara",age:34,weight:72,height:169,dateCreated:"January 17, 2020 09:34:25"},{name:"Molly",age:44,weight:82,height:165,dateCreated:"March 7, 2020 23:21:38"},{name:"Amanda",age:30,weight:56,height:158,dateCreated:"February 15, 2020 19:23:54"}],addInitialUsers=function(){hydrapp={loggedUserId:1578059113e3,users:[]},initialUsers.forEach(function(e){var t=e.name,n=e.age,r=e.weight,a=e.height,s=e.dateCreated,i=new Date,o=getDateId(i),l=new Date(s),c=getDateId(l),d=new User(l);d.name=t,d.age=n,d.weight=r,d.height=a;var u=d.waterMax,g=d.id,v=new Entry(getRandomFromRange(0,u),l);for(d.entries=[v];c!==o;){l=new Date(l.setDate(l.getDate()+1)),c=getDateId(l);var h=new Entry(getRandomFromRange(0,u),l),_=d.entries;d.entries=[h].concat(_toConsumableArray(_))}var f=hydrapp.users;hydrapp.users=_objectSpread({},f,_defineProperty({},g,d))}),exportJSON()},setIntroWaves=function(){intro.innerHTML=getHtmlOfWaterContainer(introObj,!0),intro.querySelector(".intro__start--js").addEventListener("click",quitIntro),setNodes(introObj,intro),Object.values(introObj).forEach(function(e){return e.water.classList.add("water--fadeIn")}),intro.classList.add("intro--visible"),handleWaterWaves(introObj);var e=setTimeout(function(){intro.querySelector(".intro__start--js").classList.add("intro__start--visible"),clearTimeout(e)},3e3);window.addEventListener("resize",function(){return handleWaterWaves(introObj)})},quitIntro=function(){_toConsumableArray(Object.keys(introObj)).forEach(function(e){var t=introObj[e].water;t.classList.remove("water--fadeIn"),t.classList.add("water--fadeOut")}),intro.classList.remove("intro--visible"),showLoginBox(),intro.querySelector(".intro__start--js").classList.remove("intro__start--visible");var e=setTimeout(function(){intro.innerHTML="",clearTimeout(e)},2e3)},showLoginBox=function(){var e=hydrapp.loggedUserId;loginInput.value=e?hydrapp.users[e].name:"",loginBox.classList.add("loginBox--visible"),appNewUser.classList.remove("app__newUser--visible"),loginInput.focus()},getUser=function(t){return Object.values(hydrapp.users).find(function(e){return e.name===t})},handleLoginBox=function(e){if(!e.key||"Enter"===e.key){var t=loginInput.value,n=getUser(t);""===t?handleInputAlert(loginAlert,"login","empty"):n?(handleInputAlert(loginAlert),hydrapp.loggedUserId=n.id,loggedUser=n,loadApp(),loginBox.classList.remove("loginBox--visible")):handleInputAlert(loginAlert,"login","noMatch")}},createNewUser=function(){var e=new Date;loggedUser=new User(e);var t=new Entry(0,e);loggedUser.entries=[t],setNewUserDOM(),handleInputAlert(loginAlert),loginBox.classList.remove("loginBox--visible"),appNewUser.classList.add("app__newUser--visible"),handleNewUserQuestion(0);var n=appNewUser.querySelectorAll(".newUser__input--js");_toConsumableArray(n).forEach(function(e){return e.value=""}),n[0].focus()},setNewUserDOM=function(){if(!isNewUserDOM){userHelper.questionsProps.forEach(function(e){var t=userHelper[e].maxLength;appNewUser.innerHTML+=getHtmlOfNewUser(e,t)}),isNewUserDOM=!0;var e=appNewUser.querySelectorAll("[class*=newUser__button--js]"),t=appNewUser.querySelectorAll(".newUser__input--js");_toConsumableArray(e).forEach(function(e){return e.addEventListener("click",handleNewUser)}),_toConsumableArray(t).filter(function(e,t){return 0!==t}).forEach(function(e){return e.addEventListener("keyup",filterUserInput)}),appNewUser.addEventListener("keyup",handleNewUser),window.addEventListener("keypress",function(e){return 13===e.keyCode&&e.preventDefault()})}var n=appNewUser.querySelectorAll(".newUser--js");n[0].style="transform: translateX(0px);",n[0].classList.add("newUser--visible")},handleNewUserQuestion=function(e,t){appNewUser.querySelectorAll(".newUser__label--js")[e].textContent=0===e?"What's your name, dear guest?":1===e?"Hello ".concat(t,", what's your age?"):2===e?"What's your weight, ".concat(t,"?"):3===e&&"Last question ".concat(t,", what's your height?")},handleNewUser=function(e){var t,n,r;e.preventDefault();var a=appNewUser.querySelectorAll(".newUser--js");if(e.key){if("Enter"!==e.key&&"Escape"!==e.key)return!1;n="Escape"===e.key?"prev":"next",r=_toConsumableArray(a).find(function(e){return/visible/.test(e.className)})}else if(e.target){if("BUTTON"!==(t=e.target).tagName)return!1;n=/prev/.test(t.className)?"prev":"next",r=findFirstParentOfClass(t,"newUser")}var s=r.parentNode,i=s.clientWidth,o=_toConsumableArray(a).indexOf(r),l=a.length-1,c=s.querySelectorAll(".newUser__input--js"),d=new Promise(function(e,t){e()}),u=function(e){return parseInt(c[e].value)};if(null===slideTimeoutId){var g=limitedRange(l,o,"prev"===n?"decrease":"increase"),v=a[g],h=c[g],_="prev"===n?-1*i:i,f="next"===n?-1*i:i,m="prev"===n||"Escape"===t,y=m&&o<=0,p="next"===n||"Enter"===t,b=p&&l<=o,w=r.querySelector(".newUser__input--js"),C=r.querySelector(".newUser__alert--js"),j=userHelper.questionsProps[o],S=p&&isInputValid(w,j,C)||m;if(y)appNewUser.classList.remove("app__newUser--visible"),loginBox.classList.add("loginBox--visible");else if(p)if(b)isInputValid(w,j,C)&&(loggedUser.age=u(1),loggedUser.weight=u(2),loggedUser.height=u(3),hydrapp.users=_objectSpread({},hydrapp.users,_defineProperty({},loggedUser.id,loggedUser)),exportJSON(),loadApp(),appNewUser.classList.remove("app__newUser--visible"));else if(isInputValid(w,j,C)){var L=w.value;0===o&&(loggedUser.name=L),handleNewUserQuestion(o+1,L)}m&&handleInputAlert(C),y||b||(v.style="\n        left: ".concat(_,"px;\n      ")),y||S&&d.then(function(){return e=g,t=v,n=f,void(slideTimeoutId=setTimeout(function(){t.style="\n        left: 0;\n        transition: opacity ".concat(500,"ms, left ").concat(500,"ms;\n      "),t.classList.add("newUser--visible"),r.style="\n        opacity: 0;\n        left: ".concat(n,"px;\n        transition: opacity ").concat(500,"ms, left ").concat(500,"ms;\n      "),handleNewUserQuestion(e,loggedUser.name)},100));var e,t,n}).then(function(){return e=h,void(t=setTimeout(function(){e.focus(),r.classList.remove("newUser--visible"),clearTimeout(slideTimeoutId),clearTimeout(t),slideTimeoutId=null},500));var e,t})}},setEmojiDOM=function(){isFirstAppLoad&&(emoji.innerHTML=getHtmlOfEmoji("controls"),emojiNewEntry.innerHTML=getHtmlOfEmoji("newEntry"))},handleEmoji=function(e,t){var n=getFeedbackValue(t);7<n&&(n=7),_toConsumableArray(document.querySelectorAll(".emoji__svg--js-".concat(e))).forEach(function(e,t){t===n?e.classList.add("emoji__svg--visible"):e.classList.remove("emoji__svg--visible")})},setWaterWaves=function(){""===appWater.innerHTML&&(appWater.innerHTML=getHtmlOfWaterContainer(waterObj,!1)),setNodes(waterObj,appWater),handleWaterWaves(waterObj)},handleWaterWaves=function(s){Object.keys(s).forEach(function(e){var t=s[e],n=t.waves,r=t.wavePeriodsTotal,a=window.innerWidth/r/10;n.style.height="".concat(a,"px"),n.style.top="".concat(-1*(a-1),"px")})},setWaterMeasureDOM=function(){var e=loggedUser.waterMax;measure.innerHTML="";for(var t=0;t<=e;t++){var n=e-t;measure.innerHTML+='\n      <li class="measurePart measurePart--js">\n        <span class="measurePart__mark"></span>\n        <span class="measurePart__digit">'.concat(n,"</span>\n      </li>\n    ")}},handleWaterMeasure=function(){var s=loggedUser.waterMax,i=appHeader.clientHeight,o=appLanding.clientHeight/s;_toConsumableArray(document.querySelectorAll(".measurePart--js")).forEach(function(e,t){var n=function(e){t%e==0?(r.classList.add("measurePart__mark--large"),a.classList.add("measurePart__digit--visible")):(r.classList.remove("measurePart__mark--large"),a.classList.remove("measurePart__digit--visible"))},r=e.firstElementChild,a=e.lastElementChild;e.offsetTop<i+10||t===s?e.classList.remove("measurePart--visible"):e.classList.add("measurePart--visible"),n(o<=20?5:o<=30?4:o<=40?3:2)})},handleWaterChange=function(e){var t=e.target;if("BUTTON"!==t.tagName)return!1;var n=loggedUser.waterMax,r=loggedUser.entries[0],a=r.value,s=r.id,i=document.querySelector(".entry__value--js");switch(t){case addBtn:if(n<=a)return;handleCounter(landingCounter,a,++a);break;case removeBtn:if(a<=0)return;handleCounter(landingCounter,a,--a)}loggedUser.entries[0].value=a,i.textContent=a,updateUsersStats(),exportJSON(),updateStats(),updateRanking(),handleWaterLevel(a),handleWaterShake(),handleCounterMessage(a),handleWaterMin(a),handleWaterAverage(),handleEmoji("controls",a),handleEmoji(s,a)},handleWatersArray=function(n){Object.keys(waterObj).forEach(function(e){var t=waterObj[e].water;n(t,e)})},handleWaterLevel=function(e){var t=loggedUser,n=t.waterMax,r=t.waterMin,a=t.waterAvg,s=window.innerHeight,i=s/n*(n-e),o=i/s,l={front:i,center:i-200/1.5*o,back:i-200*o};handleWatersArray(function(e,t){return e.style.top="".concat(l[t],"px")});var c=s/n*a,d=s/n*r;levelAvg.style.bottom="".concat(c,"px"),levelMin.style.bottom="".concat(d,"px")},handleWaterShake=function(){handleWatersArray(function(t,n){var e=waterObj[n],r=e.isShakeTimeoutActive,a=e.shakeTimeoutDelay;if(!r)var s=setTimeout(function(){waterObj[n].isShakeTimeoutActive=!0,t.classList.add("water--shake"),t.style.animationDuration="".concat(1500,"ms"),clearTimeout(s);var e=setTimeout(function(){t.classList.remove("water--shake"),clearTimeout(e),waterObj[n].isShakeTimeoutActive=!1},1500)},a)})},handleWaterMin=function(e){loggedUser.waterMin<=e?levelMin.classList.remove("graph__level--negative"):levelMin.classList.add("graph__level--negative")},handleWaterAverage=function(){var e=loggedUser,t=e.entries,n=e.waterMin,r=e.waterMax,a=appLanding.clientHeight/r,s=getAverageOfArrayValues(t);n<=s?levelAvg.classList.remove("graph__level--negative"):levelAvg.classList.add("graph__level--negative"),levelAvg.style.bottom="".concat(s*a,"px")},handleCounter=function(e,t,n){var r=function(e){return Math.floor(e/10)},a=function(e){return e%10},s="assets/svg/digits.svg#digit-",i=r(t),o=a(t),l=s+i,c=s+o,d=e.prevTenths,u=e.prevOnes,g=e.nextTenths,v=e.nextOnes;if(void 0===n)return d.firstElementChild.setAttribute("href",l),u.firstElementChild.setAttribute("href",c),g.firstElementChild.setAttribute("href",l),void v.firstElementChild.setAttribute("href",c);if(n!==t){var h=r(n),_=a(n),f=s+h,m=s+_,y=function(e){"tenths"===e?(g.classList.remove("digit__svg--animateIn"),g.classList.remove("digit__svg--animateOut"),d.classList.remove("digit__svg--animateOut")):"ones"===e&&(v.classList.remove("digit__svg--animateIn"),v.classList.remove("digit__svg--animateOut"),u.classList.remove("digit__svg--animateOut"))};if(t<n&&h!==i){g.firstElementChild.setAttribute("href",f),d.firstElementChild.setAttribute("href",l),g.classList.add("digit__svg--rotatedNext"),d.classList.remove("digit__svg--rotatedPrev"),y("tenths");var p=setTimeout(function(){g.classList.remove("digit__svg--rotatedNext"),g.classList.add("digit__svg--animateIn"),d.classList.add("digit__svg--rotatedPrev"),d.classList.add("digit__svg--animateOut"),clearTimeout(p)},200)}else if(n<t&&h!==i){g.firstElementChild.setAttribute("href",l),d.firstElementChild.setAttribute("href",f),g.classList.remove("digit__svg--rotatedNext"),d.classList.add("digit__svg--rotatedPrev"),y("tenths");var b=setTimeout(function(){g.classList.add("digit__svg--rotatedNext"),g.classList.add("digit__svg--animateOut"),d.classList.remove("digit__svg--rotatedPrev"),d.classList.add("digit__svg--animateOut"),clearTimeout(b)},200)}if(t<n&&_!==o){v.firstElementChild.setAttribute("href",m),u.firstElementChild.setAttribute("href",c),v.classList.add("digit__svg--rotatedNext"),u.classList.remove("digit__svg--rotatedPrev"),y("ones");var w=setTimeout(function(){v.classList.remove("digit__svg--rotatedNext"),v.classList.add("digit__svg--animateIn"),u.classList.add("digit__svg--rotatedPrev"),u.classList.add("digit__svg--animateOut"),clearTimeout(w)},50)}else if(n<t&&_!==o){v.firstElementChild.setAttribute("href",c),u.firstElementChild.setAttribute("href",m),v.classList.remove("digit__svg--rotatedNext"),u.classList.add("digit__svg--rotatedPrev"),y("ones");var C=setTimeout(function(){v.classList.add("digit__svg--rotatedNext"),v.classList.add("digit__svg--animateOut"),u.classList.remove("digit__svg--rotatedPrev"),u.classList.add("digit__svg--animateOut"),clearTimeout(C)},50)}}},getFeedbackValue=function(e){var t=loggedUser,n=t.waterMin,r=t.waterMax,a=r-n;return r<=e?8:e>=Math.floor(n+3*a/4)?7:e>=Math.floor(n+1*a/4)?6:e>=Math.floor(n)?5:e>=Math.floor(4*n/5)?4:e>=Math.floor(3*n/5)?3:e>=Math.floor(2*n/5)?2:e>=Math.floor(1*n/5)?1:0},handleCounterMessage=function(e){var t=getFeedbackValue(e);counterMessage.innerHTML=8===t?"It's enough for today!":7===t?"You almost reached the top!":6===t?"Woow.. You're on ... fire!":5===t?"Good job! You reached your minimum water consumption":4===t?"Keep going.. Yo're doing well":3===t?"Much better, but still you can do more!":2===t?"Still too little..":1===t?"Uff.. Keep it going!":"Drink or you will dehydrate!"},handleLandingCounterDate=function(){var e=loggedUser.entries[0],t=e.day,n=e.date;landingDay.innerHTML=t,landingDate.innerHTML=n.slice().split(" ").join(".")},toggleSidebar=function(e){var t=e.target||e;t===burgerBtn&&(isSidebarActive=!isSidebarActive,t.classList.toggle("button--active"),appSidebar.classList.toggle("app__sidebar--visible"),appLanding.classList.toggle("app__landing--onSide"))},toggleSidebarTabs=function(e){var t=e.target||e;if(t===archiveTabButton||t===statsTabButton||t===rankingTabButton||t===settingTabButton){var n=findFirstParentOfClass(t,"tab"),r=n.querySelector(".tab__svg--js"),a=n.querySelector(".tab__container"),s=r.classList.contains("tab__svg--active"),i=_toConsumableArray(archiveContainer.children).find(function(e){return e.classList.contains("card--visible")}),o=_toConsumableArray(rankingContainer.children).find(function(e){return e.classList.contains("card--visible")});s?a.style.height=0:t===archiveTabButton?handleContainerHeight(archiveContainer,i):t===rankingTabButton?handleContainerHeight(rankingContainer,o):handleContainerHeight(a,a.firstElementChild),r.classList.toggle("tab__svg--active")}},slideCard=function(e){var t=e.target||e,n=/prev/.test(t.className)?"prev":"next",r=findFirstParentOfClass(t,"card"),a=r.parentNode,s=a.clientWidth,i=a.children,o=a.querySelectorAll("[class*=card__list--js]"),l=a.querySelectorAll("[class*=card__header---js]"),c=a.querySelectorAll("[class*=card__heading--js]"),d=_toConsumableArray(i).indexOf(r),u=o[d],g=l[d],v=c[d],h=i.length-1,_=50,f=500;if(null===slideTimeoutId&&!(0===d&&"prev"===n||d===h&&"next"===n)){var m=limitedRange(h,d,"prev"===n?"decrease":"increase"),y=i[m],p=o[m],b=l[m],w=c[m],C="prev"===n?-1*s:s,j="next"===n?-1*s:s;p.style="transform: translateX(".concat(C,"px);"),b.style="\n      visibility: visible;\n      transition: visibility 0ms ".concat(f/2,"ms;\n    "),new Promise(function(e,t){e()}).then(function(){return e=y,t=p,n=w,r=j,void(slideTimeoutId=setTimeout(function(){t.style="\n        transform: translateX(0);\n        transition: transform ".concat(f,"ms;\n      "),u.style="\n        transform: translateX(".concat(r,"px);\n        transition: transform ").concat(f,"ms;\n      "),g.style="\n        visibility: hidden;\n        transition: visibility 0ms ".concat(f/2,"ms;\n      "),n.style="\n        opacity: 1;\n        transition: opacity ".concat(f/2,"ms ").concat(f/2,"ms;\n      "),v.style="\n        opacity: 0;\n        transition: opacity ".concat(f/2,"ms;\n      "),e.classList.add("card--visible")},_));var e,t,n,r}).then(function(){var e=setTimeout(function(){r.classList.remove("card--visible"),clearTimeout(slideTimeoutId),clearTimeout(e),slideTimeoutId=null},f)}),handleContainerHeight(a,y),handleCardButtons(a,m)}},handleCardButtons=function(e,t){var n=e.querySelectorAll(".card"),r=e.querySelectorAll("[class*=card__button--js-prev]"),a=e.querySelectorAll("[class*=card__button--js-next]");if(n.length===r.length&&n.length===a.length){var s=n.length-1,i=r[t],o=a[t];0===s?(i.classList.remove("card__button--visible"),o.classList.remove("card__button--visible")):0===t?(i.classList.remove("card__button--visible"),o.classList.add("card__button--visible")):t===s?(i.classList.add("card__button--visible"),o.classList.remove("card__button--visible")):(i.classList.add("card__button--visible"),o.classList.add("card__button--visible"))}},closeTabContainers=function(){_toConsumableArray(appSidebar.querySelectorAll("[class*=tab--js]")).forEach(function(e){var t=e.querySelector(".tab__svg--js"),n=e.querySelector("[class*=tab__button--js]");t.classList.contains("tab__svg--active")&&toggleSidebarTabs(n)})},setArchiveDOM=function(){archiveContainer.innerHTML="";for(var e=0;e<loggedUser.entries.length;e++)addArchiveEntry(e);document.querySelectorAll(".card--js-week")[0].classList.add("card--visible"),handleCardButtons(archiveContainer,0),handleArchiveLastEntry()},addArchiveEntry=function(e){var t=loggedUser.entries[e],n=t.value,r=t.id,a=t.day,s=getHtmlOfCard("week"),i=getHtmlOfArchiveEntry(e),o=archiveContainer.querySelectorAll(".card__list--js-week");"sunday"!==a&&0!==e||function(){archiveContainer.insertAdjacentHTML("beforeend",s);var e=archiveContainer.lastElementChild,t=e.querySelector(".card__button--js-prev"),n=e.querySelector(".card__button--js-next");t.addEventListener("click",slideCard),n.addEventListener("click",slideCard),o=archiveContainer.querySelectorAll(".card__list--js-week")}();var l=o[o.length-1];l.insertAdjacentHTML("beforeend",i);var c=l.lastElementChild.querySelector(".edition__button--js-edit");(c&&(c.index=e,c.addEventListener("click",handleEntryEdit)),handleEmoji(r,n),e===loggedUser.entries.length-1)&&o[o.length-1].appendChild(addEntryButton);handleWeekHeading()},handleWeekHeading=function(){for(var e=archiveContainer.querySelectorAll(".card__list--js-week"),t=archiveContainer.querySelectorAll(".card__heading--js-week"),n=function(e){var t=e.className.split(" ").filter(function(e){return/dateId-/.test(e)}).toString().replace("dateId-","");return loggedUser.entries.find(function(e){return e.id===t}).date},r=0;r<e.length;r++){var a=e[r].querySelectorAll(".entry--js"),s=t[r];if(0===a.length)s.textContent="New Week";else{var i=a[a.length-1],o=a[0],l=n(i),c=n(o);s.textContent=l===c?l:"".concat(l.slice(0,5)," - ").concat(c)}}},createRemoveEntryButton=function(){var e=document.createElement("button");return e.className="entry__remove",e.innerHTML='\n    <svg class="entry__svg" viewBox="0 0 512 512">\n      <use href="assets/svg/icons.svg#remove-icon"></use>\n    </svg>\n  ',e.addEventListener("click",removeLastEntry),e},createAddEntryButton=function(){var e=document.createElement("li");e.className="entry entry__add",e.innerHTML='\n    <button class="entry__button entry__button--add entry__button--js-add">\n      Add previous day..\n    </button>\n  ';var t=e.firstElementChild;return t.addEventListener("click",enterNewEntryValue),t},enterNewEntryValue=function(e){var t=e.target,n=loggedUser,r=n.entries,a=n.waterMax,s=r[r.length-1].dateKey,i=new Date(s);i.setDate(i.getDate()-1);var o=new Entry(0,i),l=o.day,c=o.date;if(t===addEntryButton){newEntryMode.classList.add("newEntry--visible"),burgerBtn.classList.add("button--hidden"),newEntryDay.textContent=l,newEntryDate.textContent=c,handleCounter(newEntryCounter,0),handleEmoji("newEntry",0);var d=function(){newEntryMode.classList.remove("newEntry--visible"),burgerBtn.classList.remove("button--hidden"),newEntryMode.removeEventListener("click",u),window.removeEventListener("keydown",u)},u=function(e){var t=e.keyCode||e.target,n=o.value;switch(t){case 40:case newEntryDecrease:0<n&&(o.value--,handleCounter(newEntryCounter,n,o.value),handleEmoji("newEntry",o.value));break;case 38:case newEntryIncrease:n<a&&(o.value++,handleCounter(newEntryCounter,n,o.value),handleEmoji("newEntry",o.value));break;case 27:case newEntryCancel:d();break;case 13:case newEntrySave:e.preventDefault(),addNewEntry(o),d()}};newEntryMode.addEventListener("click",u),window.addEventListener("keydown",u)}},addNewEntry=function(e){var t=loggedUser.entries.length-1,n=document.querySelectorAll(".entry--js")[t],r=archiveContainer.lastElementChild,a=loggedUser.entries[t].day;n.classList.remove("entry--last");var s=r.querySelector(".card__button--js-next"),i=loggedUser.entries;loggedUser.entries=[].concat(_toConsumableArray(i),[e]),t=loggedUser.entries.length-1,addArchiveEntry(t),"monday"===a&&slideCard(s),r=archiveContainer.lastElementChild;var o=archiveContainer.children.length-1;handleContainerHeight(archiveContainer,r),handleArchiveLastEntry(),handleWeekHeading(),handleCardButtons(archiveContainer,o),handleWaterAverage(),updateUsersStats(),updateStats(),updateRanking(),exportJSON()},handleArchiveLastEntry=function(){var e=document.querySelectorAll(".entry--js"),t=e[e.length-1],n=t.querySelector(".entry__value--js");1<e.length&&(t.insertBefore(removeEntryButton,n),t.classList.add("entry--last"))},removeLastEntry=function(e){var t=e.target,n=loggedUser.entries,r=n.length-1,a=n[r].day,s=document.querySelectorAll(".entry--js")[r],i=archiveContainer.lastElementChild;if(t===removeEntryButton&&1<n.length&&!slideTimeoutId){if(loggedUser.entries=_toConsumableArray(n).filter(function(e,t){return t!==r}),s.parentNode.removeChild(s),exportJSON(),"sunday"===a){var o=archiveContainer.lastElementChild,l=o.querySelector(".card__button--js-prev");slideCard(l),archiveContainer.removeChild(o);var c=document.querySelectorAll(".card__list--js-week");c[c.length-1].appendChild(addEntryButton)}i=archiveContainer.lastElementChild;var d=archiveContainer.children.length-1;handleArchiveLastEntry(),handleWeekHeading(),handleCardButtons(archiveContainer,d),handleContainerHeight(archiveContainer,i),updateUsersStats(),updateStats(),updateRanking(),handleWaterAverage()}},handleEntryEdit=function(e){var o=e.target.index,s=document.querySelectorAll(".entry--js")[o],i=document.querySelectorAll(".entry__header--js")[o],l=document.querySelectorAll(".entry__value--js")[o],c=document.querySelectorAll(".edition--js")[o],d=document.querySelectorAll(".edition__button--js-decrease")[o],u=document.querySelectorAll(".edition__button--js-increase")[o],g=document.querySelectorAll(".edition__button--js-cancel")[o],v=document.querySelectorAll(".edition__button--js-save")[o],r=function(){var e=!0,t=!1,n=void 0;try{for(var r,a=c.children[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.classList.toggle("edition__button--visible")}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}c.classList.toggle("edition--visible"),s.classList.toggle("entry--edit-mode"),i.classList.toggle("entry__header--edit-mode"),l.classList.toggle("entry__value--edit-mode"),o===loggedUser.entries.length-1&&removeEntryButton.classList.toggle("entry__remove--hidden")},h=function(){var e=loggedUser.entries[o],t=e.value,n=e.id;r(),l.textContent=t,handleEmoji(n,t),window.removeEventListener("click",a),window.removeEventListener("keydown",a)},a=function(e){var t=e.keyCode||e.target,n=parseInt(l.textContent),r=loggedUser.waterMax,a=loggedUser.entries[o],s=a.id,i=a.value;switch(t){case 40:case d:0<n&&n--,l.textContent=n,handleEmoji(s,n);break;case 38:case u:n<r&&n++,l.textContent=n,handleEmoji(s,n);break;case 27:case g:h();break;case 13:case v:0===o&&(handleCounter(landingCounter,i,n),handleWaterLevel(n),handleWaterShake(),handleCounterMessage(n),handleEmoji("controls",n)),loggedUser.entries[o].value=n,updateUsersStats(),exportJSON(),updateStats(),updateRanking(),handleWaterAverage(),h()}};r(),window.addEventListener("click",a),window.addEventListener("keydown",a)},handleStatsDOM=function(e){var t=e.name,n=e.id,r=getHtmlOfCard("stats",t,n),a=getHtmlOfUserStats(e);statsContainer.insertAdjacentHTML("beforeend",r),statsContainer.querySelector(".card--js-".concat(n)).querySelector(".card__list--js-stats").insertAdjacentHTML("beforeend",a);var s=Object.keys(hydrapp.users).length,i=statsContainer.querySelectorAll("[class*=card__button--js");1<s&&_toConsumableArray(i).forEach(function(e){e.addEventListener("click",slideCard)})},handleStats=function(){statsContainer.innerHTML="",getSortedUsersIds().forEach(function(e){return handleStatsDOM(hydrapp.users[e])});var e=statsContainer.querySelector(".card--js-".concat(loggedUser.id)),t=_toConsumableArray(e.parentNode.children).indexOf(e);e.classList.add("card--visible"),handleCardButtons(statsContainer,t)},updateStats=function(){var e=Object.values(hydrapp.users),t=userHelper.statsProps;e.forEach(function(r){var a=statsContainer.querySelector(".card--js-".concat(r.id));t.forEach(function(e){var t=a.querySelector(".userProp__value--js-".concat(e)),n=getSingularOrPlural(e,r[e]);t.textContent=n})})},handleRankingDOM=function(){var i=userHelper.rankingMaxUsersPerCard;rankingContainer.lastElementChild;rankingContainer.innerHTML="",getSortedUsersIds().forEach(function(e,t){var n=hydrapp.users[e];if(t%i==0){var r=getHtmlOfCard("ranking");rankingContainer.insertAdjacentHTML("beforeend",r)}var a=rankingContainer.lastElementChild.querySelector(".card__list--js-ranking"),s=getHtmlOfUserRank(n);a.insertAdjacentHTML("beforeend",s),n.position=getPositionInCard(t)});var e=rankingContainer.children.length,t=rankingContainer.querySelectorAll("[class*=card__button--js");1<e&&_toConsumableArray(t).forEach(function(e){return e.addEventListener("click",slideCard)})},handleRankingHeadings=function(){var e=rankingContainer.children,l=userHelper.rankingMaxUsersPerCard;_toConsumableArray(e).forEach(function(e,t){var n=e.querySelector(".card__heading--js-ranking"),r=e.querySelector(".card__list--js-ranking").children.length,a=t*l,s=a+1,i=a+r,o=r<=1?"Place ".concat(s):"Places ".concat(s," - ").concat(i);n.textContent=o})},getPositionInCard=function(e){var t=userHelper.rankingMaxUsersPerCard;return[Math.floor(e/t),e%t+1]},handleRanking=function(){handleRankingDOM(),rankingContainer.firstElementChild.classList.add("card--visible"),handleRankingHeadings(),handleCardButtons(rankingContainer,0)},updateRanking=function(){var e=Object.values(hydrapp.users),S=rankingContainer.querySelectorAll("[class*=userProp--js]");e.sort(function(e,t){return e.rank-t.rank}).forEach(function(e,t){var n=e.id,r=e.rank,a=e.name,s=e.points,i=rankingContainer.children,o=rankingContainer.querySelector(".card--visible"),l=_toConsumableArray(i).indexOf(o),c=S[t],d=c.querySelector(".userProp__rank--js"),u=c.querySelector(".userProp__label--js"),g=c.querySelector(".userProp__value--js");c.className="userProp userProp--rank userProp--js-".concat(n),d.textContent=r,u.textContent=a,g.textContent=getSingularOrPlural("points",s);var v=c.clientHeight,h=getPositionInCard(t),_=_slicedToArray(e.position,2),f=_[0],m=_[1],y=_slicedToArray(h,2),p=y[0],b=y[1];if(f!==p){if(p===l){c.style="transform: translateX(100%);",c.classList.add("userProp--updated");var w=setTimeout(function(){c.style="\n            transform: translateX(0);\n            transition:\n              background-color ".concat(300,"ms ").concat(300,"ms,\n              transform ").concat(300,"ms;\n          "),c.classList.remove("userProp--updated"),clearTimeout(w)},30)}}else if(m!==b){var C=-1*(b-m);c.style="transform: translateY(".concat(C*v,"px);"),c.classList.add("userProp--updated");var j=setTimeout(function(){c.style="\n          transform: translateY(0);\n          transition:\n            background-color ".concat(300,"ms ").concat(300,"ms,\n            transform ").concat(300,"ms;\n        "),c.classList.remove("userProp--updated"),clearTimeout(j)},30)}e.position=h})},setSettingsDOM=function(){var e=loggedUser.name,t=getHtmlOfCard("settings",e),n=getHtmlOfUserSettings(),r=getHtmlOfProfileButtons();settingsContainer.innerHTML=t;var a=settingsContainer.querySelector(".card--js-settings"),s=a.firstElementChild;a.classList.add("card--visible"),settingsContainer.querySelector(".card__list--js-settings").innerHTML=n,s.insertAdjacentHTML("beforeend",r);var i=document.querySelector(".profile__button--js-logOut"),o=document.querySelector(".profile__button--js-remove");_toConsumableArray(settingsContainer.querySelectorAll(".edition__button--js-edit")).forEach(function(e){e.addEventListener("click",handleSettingsEdition)}),i.addEventListener("click",handleUserLogOut),o.addEventListener("click",toggleUserRemoveConfirmation)},handleSettingsEdition=function(e){var t=e.target,s=t.id.replace("EditButton",""),i=loggedUser[s],o=findFirstParentOfClass(t,"userProp"),l=o.querySelector(".userProp__label--js"),c=o.querySelector(".userProp__output--js"),d=o.querySelector(".userProp__input--js"),r=o.querySelector(".edition__button--js-cancel"),a=o.querySelector(".edition__button--js-save"),u=o.querySelector(".edition--js"),g=o.querySelector(".userProp__alert--js"),v=settingsContainer.querySelector(".card--js-settings").querySelector(".card__heading--js-settings"),n=function(){var e=!0,t=!1,n=void 0;try{for(var r,a=u.children[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.classList.toggle("edition__button--visible")}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}u.classList.toggle("edition--visible"),o.classList.toggle("userProp--editMode"),l.classList.toggle("userProp__label--editMode"),c.classList.toggle("userProp__output--hidden"),d.classList.toggle("userProp__input--visible"),d.focus(),d.value="",d.placeholder="weight"===s?"".concat(i," kg"):"height"===s?"".concat(i," cm"):"waterMax"===s?"".concat(getSingularOrPlural("waterMax",i)):i},h=function(){n(),handleInputAlert(g),handleContainerHeightThroughTime(settingsContainer,settingsContainer.firstElementChild,1e3),u.removeEventListener("click",_),window.removeEventListener("keydown",_),"name"!==s&&d.removeEventListener("keyup",filterUserInput)},_=function(e){switch(e.keyCode||e.target){case 27:case r:h();break;case 13:case a:var t="number"==typeof i?parseInt(d.value):d.value;if(i===t||isInputValid(d,s,g)){if(t!==i&&(loggedUser[s]=t,"name"===s&&(v.textContent=t),"waterMax"===s)){var n=loggedUser.entries[0].value;setWaterMeasureDOM(),handleWaterMeasure(),handleWaterLevel(n),handleCounterMessage(n)}c.textContent=getSingularOrPlural(s,t),exportJSON(),h()}else handleContainerHeightThroughTime(settingsContainer,settingsContainer.firstElementChild,1e3)}};n(),u.addEventListener("click",_),window.addEventListener("keydown",_),"number"==typeof i&&d.addEventListener("keyup",filterUserInput)},quitLanding=function(){handleWaterLevel(0),levelAvg.style.bottom="0",levelMin.style.bottom=0,showLoginBox(),closeTabContainers(),appUser.classList.add("app__user--visible")},handleUserLogOut=function(){hydrapp.loggedUserId="",exportJSON(),quitLanding()},toggleUserRemoveConfirmation=function e(t){var n=t.target,r=appSidebar.querySelector(".userRemove--js"),a=r.querySelector(".userRemove__alert--js"),s=appSidebar.querySelector(".profile__button--js-remove"),i=r.querySelector(".userRemove__confirm--js"),o=r.classList.contains("userRemove--visible");n!==s||o?n!==i&&n!==s&&(r.classList.remove("userRemove--visible"),i.removeEventListener("click",handleUserRemove),window.removeEventListener("click",e)):(a.textContent='Are you sure to remove "'.concat(loggedUser.name,'" profile?'),r.classList.add("userRemove--visible"),i.addEventListener("click",handleUserRemove),window.addEventListener("click",e))},handleUserRemove=function(){var e=loggedUser.id;delete hydrapp.users[e],hydrapp.loggedUserId="",exportJSON(),quitLanding()},Counter=function e(t){_classCallCheck(this,e),this.container=t,this.prevTenths=t.querySelector(".digit__svg--js-prevTenths"),this.nextTenths=t.querySelector(".digit__svg--js-nextTenths"),this.prevOnes=t.querySelector(".digit__svg--js-prevOnes"),this.nextOnes=t.querySelector(".digit__svg--js-nextOnes")},User=function(){function t(e){_classCallCheck(this,t),this.name="",this.age=0,this.weight=0,this.height=0,this.waterMax=20,this.waterMin=8,this.waterAvg=0,this.rank=0,this._dateCreated=e,this._id=e,this.entries=[]}return _createClass(t,[{key:"_dateCreated",get:function(){return this.dateCreated},set:function(e){var t=getOffsetedDate(e).toISOString().slice(0,10).split("-").reverse().join("."),n=getOffsetedDate(e).toISOString().slice(11,16);this.dateCreated="".concat(t,", ").concat(n)}},{key:"_id",get:function(){return this.id},set:function(e){this.id=e.getTime()}}]),t}(),Entry=function(){function n(e,t){_classCallCheck(this,n),this.value=e,this._dateKey=t,this._date=t,this._day=t,this._id=this.date}return _createClass(n,[{key:"_dateKey",get:function(){return this.dateKey},set:function(e){this.dateKey=getOffsetedDate(e).toISOString().slice(0,10)}},{key:"_date",get:function(){return this.date},set:function(e){this.date=getOffsetedDate(e).toISOString().slice(0,10).split("-").reverse().join(".")}},{key:"_id",get:function(){return this.id},set:function(e){this.id=e.replace(/[.]/g,"")}},{key:"_day",get:function(){return this.day},set:function(e){this.day=userHelper.weekDays[e.getDay()]}}]),n}(),intro=document.querySelector(".intro--js"),introObj={front:{wavePeriodsTotal:2},center:{wavePeriodsTotal:3},back:{wavePeriodsTotal:4}},loginBox=document.querySelector(".loginBox--js"),loginInput=document.querySelector(".loginBox__input--js"),loginAlert=document.querySelector(".loginBox__alert--js"),loginButton=loginBox.querySelector(".loginBox__button--js-logIn"),signUpButton=loginBox.querySelector(".loginBox__button--js-signUp");loginButton.addEventListener("click",handleLoginBox),signUpButton.addEventListener("click",createNewUser),loginInput.addEventListener("keydown",handleLoginBox);var hydrapp,loggedUser,isFirstAppLoad=!0,isNewUserDOM=!1,isSidebarActive=!1,localStorageKeyName="hydrapp",mediaMd=768,mediaLg=1200,slideTimeoutId=null,startWaterValue=0,rankOffset=10,userHelper={name:{label:"Name",maxLength:20},age:{label:"Age",maxLength:3,min:10,max:120},weight:{label:"Weight",maxLength:3,min:8,max:200},height:{label:"Height",maxLength:3,min:70,max:250},waterMax:{label:"Maximum per day",alertLabel:"Maximum amount of glasses per day",maxLength:2,min:10,max:40},waterMin:{label:"Minimum per day"},waterAvg:{label:"Average per day"},currentStreak:{label:"Current streak"},longestStreak:{label:"Longest streak ever"},lastLongestStreakDates:{label:"Last longest streak dates"},points:{label:"User Points"},rank:{label:"Ranking position"},rankingMaxUsersPerCard:10,questionsProps:["name","age","weight","height"],settingsProps:["name","age","weight","height","waterMax"],statsProps:["waterMin","waterAvg","currentStreak","longestStreak","lastLongestStreakDates","points","rank"],weekDays:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]},appHeader=document.querySelector(".app__header--js"),appUser=document.querySelector(".app__user--js"),appNewUser=document.querySelector(".app__newUser--js"),appLanding=document.querySelector(".app__landing--js"),appWater=document.querySelector(".app__water--js"),appSidebar=document.querySelector(".app__sidebar--js"),landingCounterContainer=document.querySelector(".counter--js-landing"),landingCounter=new Counter(landingCounterContainer),landingDay=landingCounterContainer.querySelector(".counter__day--js-landing"),landingDate=landingCounterContainer.querySelector(".counter__date--js-landing"),counterMessage=document.querySelector(".counter__message--js"),landingControls=document.querySelector(".controls--js-landing"),addBtn=document.querySelector(".button--js-add"),removeBtn=document.querySelector(".button--js-remove"),emoji=document.querySelector(".emoji--js-controls"),emojiAmount=8,burgerBtn=document.querySelector(".button--js-burger"),waterObj={front:{wavePeriodsTotal:2,shakeTimeoutDelay:0,isShakeTimeoutActive:!1},center:{wavePeriodsTotal:3,shakeTimeoutDelay:100,isShakeTimeoutActive:!1},back:{wavePeriodsTotal:4,shakeTimeoutDelay:200,isShakeTimeoutActive:!1}},wavesIntervalId=null,wavesTimeoutId=null,measure=document.querySelector(".graph__measure--js"),levelAvg=document.querySelector(".graph__level--js-avg"),levelMin=document.querySelector(".graph__level--js-min"),archiveTabButton=document.querySelector(".tab__button--js-archive"),statsTabButton=document.querySelector(".tab__button--js-stats"),rankingTabButton=document.querySelector(".tab__button--js-ranking"),settingTabButton=document.querySelector(".tab__button--js-settings"),archiveContainer=document.querySelector(".tab__container--js-archive"),statsContainer=document.querySelector(".tab__container--js-stats"),rankingContainer=document.querySelector(".tab__container--js-ranking"),settingsContainer=document.querySelector(".tab__container--js-settings"),addEntryButton=createAddEntryButton(),removeEntryButton=createRemoveEntryButton(),newEntryMode=document.querySelector(".newEntry--js"),newEntryCounterContainer=document.querySelector(".counter--js-newEntry"),newEntryCounter=new Counter(newEntryCounterContainer),newEntryDay=newEntryCounterContainer.querySelector(".counter__day--js-newEntry"),newEntryDate=newEntryCounterContainer.querySelector(".counter__date--js-newEntry"),newEntryDecrease=newEntryMode.querySelector(".button--js-decrease"),newEntryIncrease=newEntryMode.querySelector(".button--js-increase"),newEntryCancel=newEntryMode.querySelector(".button--js-cancel"),newEntrySave=newEntryMode.querySelector(".button--js-save"),emojiNewEntry=document.querySelector(".emoji--js-newEntry"),loadApp=function(){updateUsersEntries(),updateUsersStats(),setArchiveDOM(),handleStats(),handleRanking(),setSettingsDOM(),setWaterMeasureDOM(),setEmojiDOM(),handleCounter(landingCounter,startWaterValue),handleCounter(newEntryCounter,0),handleCounterMessage(startWaterValue),handleLandingCounterDate(),handleEmoji("controls",startWaterValue),handleEmoji("newEntry",0),setWaterWaves(),handleWaterLevel(startWaterValue),handleWaterMin(startWaterValue),handleWaterAverage(),handleWaterShake(),handleWaterMeasure(),handleWeekHeading(),exportJSON(),appLanding.classList.add("app__landing--visible"),appUser.classList.remove("app__user--visible"),isFirstAppLoad&&(landingControls.addEventListener("click",handleWaterChange),window.addEventListener("resize",handleWindowResize),burgerBtn.addEventListener("click",toggleSidebar),appSidebar.addEventListener("click",toggleSidebarTabs)),isFirstAppLoad=!1};(hydrapp=fetchJSON())||(addInitialUsers(),hydrapp=fetchJSON()),setIntroWaves();